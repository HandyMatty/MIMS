import{j as e,aj as ee,r as l,n as te,B as P,b5 as se,I as ae,R as le,h as L,ak as re,l as ne}from"./index-CD2515kj.js";import{g as oe}from"./addItemToInventory-C9oj-7GI.js";import{Q as ie}from"./QrCodeModal-A9xpYvTv.js";import{H as i}from"./HighlightText-joRODCOg.js";import{T as z}from"./index-8lnpP56V.js";import{d as de}from"./debounce-QjT_1IrO.js";import{u as ce,F as xe}from"./index-DMt-9uzF.js";import{D as ue}from"./index-vTVWtL-y.js";import{S as me}from"./index-smfr0Mjk.js";import{R as pe}from"./FilterOutlined-DMZgr-kR.js";import{P as fe}from"./Pagination-pig84kSF.js";import"./index-jmjkkxFY.js";import"./createForOfIteratorHelper-DMOhJlUs.js";import"./index-95JSFp8s.js";const he=(d,r="")=>{let n;switch(d){case"On Stock":n="green";break;case"For Repair":n="volcano";break;case"Deployed":n="blue";break;default:n="gray"}return e.jsx(z,{color:n,className:"text-wrap text-center",children:e.jsx(i,{text:d,searchTerm:r})})},be=(d,r="")=>{let n;switch(d){case"Brand New":n="gold";break;case"Good Condition":n="green";break;case"Defective":n="red";break;default:n="gray"}return e.jsx(z,{color:n,className:"text-wrap text-center",children:e.jsx(i,{text:d,searchTerm:r})})},ye=(d,r="",n={},m={})=>[{title:"QR Code",dataIndex:"qrCode",key:"qrCode",align:"center",width:"70px",className:"text-xs overflow-auto",render:(s,a)=>e.jsx(ee,{style:{fontSize:"24px",cursor:"pointer"},onClick:()=>d(a),title:"Generate QR Code"})},{title:"ID",dataIndex:"id",key:"id",align:"center",className:"text-xs overflow-auto",width:"120px",sorter:(s,a)=>Number(s.id)-Number(a.id),render:s=>e.jsx(i,{text:s,searchTerm:r})},{title:"Type",dataIndex:"type",key:"type",align:"center",className:"text-xs overflow-auto",responsive:["sm"],width:"120px",sorter:(s,a)=>s.type.localeCompare(a.type),render:s=>e.jsx(i,{text:s,searchTerm:r})},{title:"Brand",dataIndex:"brand",key:"brand",align:"center",className:"text-xs overflow-auto",width:"120px",responsive:["sm"],sorter:(s,a)=>s.brand.localeCompare(a.brand),render:s=>e.jsx(i,{text:s,searchTerm:r})},{title:"Qty",dataIndex:"quantity",key:"quantity",align:"center",className:"text-xs overflow-auto text-wrap",responsive:["sm"],width:"80px",sorter:(s,a)=>s.quantity-a.quantity,render:s=>e.jsx(i,{text:s,searchTerm:r})},{title:"Remarks",dataIndex:"remarks",key:"remarks",align:"center",className:"text-xs overflow-auto text-wrap",responsive:["sm"],width:"200px",render:s=>e.jsx(i,{text:s&&s.trim()!==""?s:"-",searchTerm:r})},{title:"Serial Number",dataIndex:"serialNumber",key:"serialNumber",align:"center",width:"170px",className:"text-xs overflow-auto text-wrap",responsive:["sm"],sorter:(s,a)=>s.serialNumber.localeCompare(a.serialNumber),render:s=>e.jsx(i,{text:s&&s.trim()!==""?s:"-",searchTerm:r})},{title:"Issued Date",dataIndex:"issuedDate",key:"issuedDate",align:"center",className:"text-xs overflow-auto",width:"110px",responsive:["sm"],sorter:(s,a)=>s.issuedDate.localeCompare(a.issuedDate),render:s=>!s||s==="0000-00-00"||s===""?e.jsx(i,{text:"NO DATE",searchTerm:r}):e.jsx(i,{text:s,searchTerm:r})},{title:"Purchased Date",dataIndex:"purchaseDate",key:"purchaseDate",align:"center",width:"110px",className:"text-xs overflow-auto",responsive:["sm"],sorter:(s,a)=>s.purchaseDate.localeCompare(a.purchaseDate),render:s=>!s||s==="0000-00-00"||s===""?e.jsx(i,{text:"NO DATE",searchTerm:r}):e.jsx(i,{text:s,searchTerm:r})},{title:"Condition",dataIndex:"condition",key:"condition",align:"center",width:"120px",className:"text-xs overflow-auto",responsive:["sm"],render:s=>be(s,r),filters:[{text:"Brand New",value:"Brand New"},{text:"Good Condition",value:"Good Condition"},{text:"Defective",value:"Defective"}],filteredValue:m.condition||null,onFilter:(s,a)=>a.condition===s},{title:"Detachment/Office",dataIndex:"location",key:"location",align:"center",width:"150px",className:"text-xs overflow-auto",responsive:["sm"],render:s=>e.jsx(i,{text:s,searchTerm:r})},{title:"Status",dataIndex:"status",key:"status",align:"center",width:"120px",className:"text-xs overflow-auto",responsive:["sm"],render:s=>he(s,r),filters:[{text:"On Stock",value:"On Stock"},{text:"For Repair",value:"For Repair"},{text:"Deployed",value:"Deployed"}],filteredValue:m.status||null,onFilter:(s,a)=>a.status===s}],{Option:E}=L,Qe=({onItemSelect:d})=>{var q,A;const[r,n]=l.useState(""),[m,s]=l.useState("Newest"),[a,h]=l.useState(1),[p,C]=l.useState(10),[b,V]=l.useState([]),[T,N]=l.useState(!1),[g,w]=l.useState(null),[$,D]=l.useState(!0),[x,S]=l.useState("all"),[I,R]=l.useState([]),[O,v]=l.useState(!1),[c,F]=l.useState({}),G=ce({maxWidth:639}),k=l.useCallback(async()=>{D(!0);try{const t=await oe();Array.isArray(t)?(V(t),t.length>0&&!g&&(d(t[0]),w(t[0]))):console.error("Received invalid data:",t)}catch(t){console.error("Failed to load inventory data:",t)}finally{D(!1)}},[d,g]);l.useEffect(()=>{k()},[k]);const y=l.useMemo(()=>[{key:"all",label:"All Columns"},{key:"id",label:"ID"},{key:"type",label:"Type"},{key:"brand",label:"Brand"},{key:"quantity",label:"Quantity"},{key:"remarks",label:"Remarks"},{key:"serialNumber",label:"Serial Number"},{key:"issuedDate",label:"Issued Date"},{key:"purchaseDate",label:"Purchase Date"},{key:"location",label:"Location"},{key:"status",label:"Status"},{key:"condition",label:"Condition"}],[]),M=l.useCallback(de(t=>{if(t===""){v(!1);return}v(!0);const o=b.filter(u=>{if(!u)return!1;if(x==="all"){for(const j in u){const B=u[j];if(B&&String(B).toLowerCase().includes(t.toLowerCase()))return!0}return!1}else{const j=u[x];return j&&String(j).toLowerCase().includes(t.toLowerCase())}});R(o)},300),[b,x]),H=l.useCallback(t=>{const o=t.target.value;n(o),M(o)},[M]),K=l.useCallback(t=>{S(t)},[]),W=()=>{n(""),s("Newest"),h(1),C(10),S("all"),v(!1),R([]),F({}),k()},_=t=>{s(t),h(1)},J=(t,o)=>{h(t),C(o)},U=(t,o,u)=>{F(o),h(1)},X=l.useCallback(t=>{w(t),N(!0)},[]),Y=l.useCallback(t=>{d(t),w(t)},[d]),Q=l.useMemo(()=>{let t=O?I:b;return c.condition&&c.condition.length>0&&(t=t.filter(o=>c.condition.includes(o.condition))),c.status&&c.status.length>0&&(t=t.filter(o=>c.status.includes(o.status))),t},[O,I,b,c]),f=l.useMemo(()=>{const t=[...Q].sort((o,u)=>Number(o.id)-Number(u.id));return m==="Newest"?t.reverse():t},[Q,m]),Z=l.useMemo(()=>y.map(t=>({key:t.key,label:t.label})),[y]);return e.jsxs(te,{title:e.jsx("span",{className:"text-lgi sm:text-sm md:text-base lg:text-lgi xl:text-xl font-bold flex justify-center",children:"ITEMS"}),className:"flex flex-col w-full mx-auto bg-[#A8E1C5] rounded-xl shadow border-none",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 mb-4 space-y-2 sm:space-y-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-2 sm:mb-0",children:[e.jsx(ue,{className:"theme-aware-dropdown-btn border border-black sm:block hidden",menu:{items:Z,onClick:({key:t})=>K(t),selectedKeys:[x]},trigger:["click"],children:e.jsx(P,{type:"text",icon:e.jsx(pe,{className:"text-xs"}),children:e.jsxs(me,{className:"text-xs w-auto align-middle",children:[((q=y.find(t=>t.key===x))==null?void 0:q.label)||"All Columns",e.jsx(se,{})]})})}),e.jsx(ae,{placeholder:`Search in ${x==="all"?"all columns":(A=y.find(t=>t.key===x))==null?void 0:A.label}`,prefix:e.jsx(le,{}),className:"border border-black w-auto ml-1 text-xs",value:r,onChange:H})]}),e.jsxs("div",{className:"flex gap-2 w-auto justify-center",children:[e.jsxs(L,{value:m,className:"w-auto text-xs transparent-select mt-1",size:"small",onChange:_,children:[e.jsx(E,{value:"Newest",children:e.jsx("span",{className:"text-xs",children:"Newest"})}),e.jsx(E,{value:"Oldest",children:e.jsx("span",{className:"text-xs",children:"Oldest"})})]}),e.jsx(P,{onClick:W,className:"custom-button mt-1 text-xs",type:"default",size:"small",icon:e.jsx(re,{}),children:e.jsx("span",{className:"text-xs",children:"Refresh"})})]})]}),e.jsx(xe,{rowKey:"id",columns:ye(X,r,void 0,c),dataSource:f.slice((a-1)*p,a*p),pagination:!1,bordered:!0,sortDirections:["descend","ascend"],onChange:U,onRow:t=>({onClick:()=>Y(t)}),scroll:{x:"max-content",y:600},loading:$,responsive:["sm","md","lg","xl","xxl"],expandable:G?{expandedRowRender:t=>e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:[e.jsx("b",{children:"ID:"})," ",t.id]}),e.jsxs("div",{children:[e.jsx("b",{children:"Type:"})," ",t.type]}),e.jsxs("div",{children:[e.jsx("b",{children:"Brand:"})," ",t.brand]}),e.jsxs("div",{children:[e.jsx("b",{children:"Quantity:"})," ",t.quantity]}),e.jsxs("div",{children:[e.jsx("b",{children:"Remarks:"})," ",t.remarks]}),e.jsxs("div",{children:[e.jsx("b",{children:"Serial Number:"})," ",t.serialNumber]}),e.jsxs("div",{children:[e.jsx("b",{children:"Issued Date:"})," ",t.issuedDate]}),e.jsxs("div",{children:[e.jsx("b",{children:"Purchased Date:"})," ",t.purchaseDate]}),e.jsxs("div",{children:[e.jsx("b",{children:"Condition:"})," ",t.condition]}),e.jsxs("div",{children:[e.jsx("b",{children:"Location:"})," ",t.location]}),e.jsxs("div",{children:[e.jsx("b",{children:"Status:"})," ",t.status]})]}),rowExpandable:()=>!0}:void 0}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mt-5 space-y-2 sm:space-y-0",children:[e.jsxs(ne.Text,{style:{color:"#072C1C"},className:"w-full text-xs text-wrap text-center sm:text-left",children:["Showing data of ",f.length>0?(a-1)*p+1:0," to"," ",Math.min(a*p,f.length)," of ",f.length," entries"]}),e.jsx("div",{className:"w-full flex justify-center sm:justify-end",children:e.jsx(fe,{current:a,pageSize:p,total:f.length,showSizeChanger:!0,pageSizeOptions:["10","20","30","50","100","200","500","1000","2000"],onChange:J,className:"text-xs",responsive:!0})})]}),e.jsx(ie,{isVisible:T,onClose:()=>N(!1),qrDetails:g})]})};export{Qe as default};
