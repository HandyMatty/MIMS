import{r as s,j as t,q as U,B as T,bb as $,I as V,R as B,al as K,m as q}from"./index-D_DjqwU6.js";import{H as d}from"./HighlightText-BHuCeSLK.js";import{l as O}from"./lodash-acZijzff.js";import{u as Q,F as W}from"./index-GL6TR608.js";import{D as G,S as J}from"./index-CYk8aGXX.js";import{R as X}from"./FilterOutlined-B9-Kq489.js";import{P as Y}from"./Pagination-B3MLnmFW.js";import"./index-DG92omOn.js";import"./useBubbleLock-BNMpLRc-.js";import"./index-CRHxdFZf.js";const{Text:Z}=q,de=({activitiesData:x=[],loading:A=!1,error:_=null,onRefresh:f,lastSyncTime:y})=>{var I,L;const[r,b]=s.useState(""),[n,g]=s.useState(1),[o,j]=s.useState(5),[l,C]=s.useState("all"),[v,k]=s.useState([]),[S,p]=s.useState(!1),N=Q({maxWidth:639}),w=s.useMemo(()=>[{key:"all",label:"All Columns"},{key:"id",label:"ID"},{key:"username",label:"Username"},{key:"activity",label:"Activity"},{key:"details",label:"Details"},{key:"date",label:"Date"}],[]),D=s.useMemo(()=>O.debounce(e=>{if(e===""){p(!1);return}p(!0);const a=x.filter(m=>{if(!m)return!1;if(l==="all"){for(const c in m){let h=m[c];if(c==="date"&&h&&new Date(h).toLocaleString("en-PH",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}).toLowerCase().includes(e.toLowerCase())||h&&String(h).toLowerCase().includes(e.toLowerCase()))return!0}return!1}else{if(l==="date")return new Date(m.date).toLocaleString("en-PH",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}).toLowerCase().includes(e.toLowerCase());{const c=m[l];return c&&String(c).toLowerCase().includes(e.toLowerCase())}}});k(a)},300),[x,l]),M=s.useCallback(e=>{const a=e.target.value;b(a),D(a)},[D]),P=s.useCallback(e=>{C(e)},[]),R=s.useCallback(()=>{b(""),g(1),j(5),C("all"),p(!1),k([]),f&&f()},[f]),i=s.useMemo(()=>S?v:x,[S,v,x]),E=s.useMemo(()=>i.slice((n-1)*o,n*o),[i,n,o]),u=s.useCallback(e=>new Date(e).toLocaleString("en-PH",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}),[]),z=s.useMemo(()=>[{title:"ID",dataIndex:"id",key:"id",width:"120px",className:"text-xs overflow-auto",sorter:(e,a)=>String(e.id).localeCompare(String(a.id)),render:e=>t.jsx(d,{text:e||"N/A",searchTerm:r})},{title:"Username",dataIndex:"username",key:"username",width:"150px",className:"text-xs overflow-auto",sorter:(e,a)=>e.username.localeCompare(a.username),render:e=>t.jsx(d,{text:e,searchTerm:r})},{title:"Activity",dataIndex:"activity",key:"activity",width:"150px",className:"text-xs overflow-auto",responsive:["sm"],render:e=>t.jsx(d,{text:e,searchTerm:r})},{title:"Details",dataIndex:"details",key:"details",width:"200px",className:"text-xs whitespace-normal break-words",responsive:["sm"],render:e=>t.jsx(d,{text:e,searchTerm:r})},{title:"Date",dataIndex:"date",key:"date",width:"200px",className:"text-xs overflow-auto",responsive:["sm"],sorter:(e,a)=>new Date(e.date)-new Date(a.date),render:e=>{const a=u(e);return t.jsx(d,{text:a,searchTerm:r})}}],[r,u]),F=s.useMemo(()=>N?{expandedRowRender:e=>t.jsxs("div",{className:"text-xs space-y-1 text-wrap",children:[t.jsxs("div",{children:[t.jsx("b",{children:"ID:"})," ",e.id]}),t.jsxs("div",{children:[t.jsx("b",{children:"Username:"})," ",e.username]}),t.jsxs("div",{children:[t.jsx("b",{children:"Activity:"})," ",e.activity]}),t.jsxs("div",{children:[t.jsx("b",{children:"Details:"})," ",e.details]}),t.jsxs("div",{children:[t.jsx("b",{children:"Date:"})," ",u(e.date)]})]}),rowExpandable:()=>!0}:void 0,[N,u]),H=s.useCallback((e,a)=>{g(e),j(a)},[]);return t.jsxs(U,{title:t.jsx("span",{className:"text-lgi sm:text-sm md:text-md lg:text-lgi xl:text-xl font-bold flex justify-center",children:"ACTIVITIES"}),className:"flex flex-col w-full mx-auto bg-[#A8E1C5] rounded-xl shadow border-none",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 mb-4 space-y-2 sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-2 sm:mb-0",children:[t.jsx(G,{className:"w-auto hidden sm:block border-black theme-aware-dropdown-btn text-xs",menu:{items:w.map(e=>({key:e.key,label:e.label})),onClick:({key:e})=>P(e),selectedKeys:[l]},trigger:["click"],children:t.jsxs(T,{type:"text",className:"flex items-center",children:[t.jsx(X,{className:"text-xs"}),t.jsx(J,{children:((I=w.find(e=>e.key===l))==null?void 0:I.label)||"All Columns"}),t.jsx($,{className:"align-middle ml-1"})]})}),t.jsx(V,{placeholder:`Search in ${l==="all"?"all columns":(L=w.find(e=>e.key===l))==null?void 0:L.label}`,prefix:t.jsx(B,{}),value:r,onChange:M,allowClear:!0,className:"w-auto text-xs border-black ml-2"})]}),t.jsx("div",{className:"flex gap-2 w-auto justify-center",children:t.jsx(T,{onClick:R,className:"custom-button w-auto text-xs",type:"default",size:"small",icon:t.jsx(K,{}),children:"Refresh"})})]}),t.jsx("div",{className:"w-auto overflow-x-auto",children:t.jsx(W,{columns:z,dataSource:E,pagination:!1,bordered:!0,rowKey:"id",loading:A,scroll:{x:"max-content",y:280},className:"w-auto text-xs overflow-auto",responsive:["xs","sm","md","lg","xl"],expandable:F})}),t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mt-5 space-y-2 sm:space-y-0",children:[t.jsxs("div",{className:"w-full flex flex-col items-center sm:items-start",children:[t.jsxs(Z,{style:{color:"#072C1C"},className:"w-full text-xs text-wrap text-center sm:text-left",children:["Showing ",Math.min((n-1)*o+1,i.length)," to"," ",Math.min(n*o,i.length)," of ",i.length," entries"]}),y&&t.jsxs("div",{className:"text-xs text-gray-500 mt-1 text-center sm:text-left",children:["Last synced: ",new Date(y).toLocaleTimeString()]})]}),t.jsx("div",{className:"w-full flex justify-center sm:justify-end",children:t.jsx(Y,{current:n,pageSize:o,total:i.length,showSizeChanger:!0,className:"text-xs",responsive:!0,pageSizeOptions:["5","10","15"],onChange:H})})]})]})};export{de as default};
