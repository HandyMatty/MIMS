const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index-Cq9w5H2m.js","css/index-Dqee62uv.css"])))=>i.map(i=>d[i]);
import{r as s,G as Xe,H as et,A as We,d as Se,e as Ce,v as Ke,t as Je,i as Pe,g as Ee,b8 as fa,b9 as ya,a9 as te,ba,bb as At,bc as qt,bd as Pt,F as v,u as Qt,j as e,be as lt,bf as Wt,a as Ze,C as Be,k as A,n as Ye,B as J,bg as wt,o as Kt,D as ja,M as ve,I as _,bh as ge,bi as Ue,h as at,R as Nt,aI as Jt,aK as Le,w as Fe,P as Zt,x as He,T as Xt,s as rt,f as ea,bj as ga,aH as Te,c as St,bk as Da,_ as va,bl as wa,bm as Na,b as Sa,J as Et,bn as Ca,a7 as Oa,aJ as ka}from"./index-Cq9w5H2m.js";import{u as ta}from"./index-CVya9Qnf.js";import{h as Yt,B as Ta}from"./BatchPrintItemModal-BiVbELE3.js";import{E as Ia}from"./ExportModal-RI1Jwy6y.js";import{R as Ma}from"./FilterOutlined-CqFZr8Fa.js";import{R as Ra}from"./PrinterOutlined-D6fI5T9P.js";var Ba={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656zM340 683v77c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-77c-10.1 3.3-20.8 5-32 5s-21.9-1.8-32-5zm64-198V264c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v221c10.1-3.3 20.8-5 32-5s21.9 1.8 32 5zm-64 198c10.1 3.3 20.8 5 32 5s21.9-1.8 32-5c41.8-13.5 72-52.7 72-99s-30.2-85.5-72-99c-10.1-3.3-20.8-5-32-5s-21.9 1.8-32 5c-41.8 13.5-72 52.7-72 99s30.2 85.5 72 99zm.1-115.7c.3-.6.7-1.2 1-1.8v-.1l1.2-1.8c.1-.2.2-.3.3-.5.3-.5.7-.9 1-1.4.1-.1.2-.3.3-.4.5-.6.9-1.1 1.4-1.6l.3-.3 1.2-1.2.4-.4c.5-.5 1-.9 1.6-1.4.6-.5 1.1-.9 1.7-1.3.2-.1.3-.2.5-.3.5-.3.9-.7 1.4-1 .1-.1.3-.2.4-.3.6-.4 1.2-.7 1.9-1.1.1-.1.3-.1.4-.2.5-.3 1-.5 1.6-.8l.6-.3c.7-.3 1.3-.6 2-.8.7-.3 1.4-.5 2.1-.7.2-.1.4-.1.6-.2.6-.2 1.1-.3 1.7-.4.2 0 .3-.1.5-.1.7-.2 1.5-.3 2.2-.4.2 0 .3 0 .5-.1.6-.1 1.2-.1 1.8-.2h.6c.8 0 1.5-.1 2.3-.1s1.5 0 2.3.1h.6c.6 0 1.2.1 1.8.2.2 0 .3 0 .5.1.7.1 1.5.2 2.2.4.2 0 .3.1.5.1.6.1 1.2.3 1.7.4.2.1.4.1.6.2.7.2 1.4.4 2.1.7.7.2 1.3.5 2 .8l.6.3c.5.2 1.1.5 1.6.8.1.1.3.1.4.2.6.3 1.3.7 1.9 1.1.1.1.3.2.4.3.5.3 1 .6 1.4 1 .2.1.3.2.5.3.6.4 1.2.9 1.7 1.3s1.1.9 1.6 1.4l.4.4 1.2 1.2.3.3c.5.5 1 1.1 1.4 1.6.1.1.2.3.3.4.4.4.7.9 1 1.4.1.2.2.3.3.5l1.2 1.8s0 .1.1.1a36.18 36.18 0 015.1 18.5c0 6-1.5 11.7-4.1 16.7-.3.6-.7 1.2-1 1.8 0 0 0 .1-.1.1l-1.2 1.8c-.1.2-.2.3-.3.5-.3.5-.7.9-1 1.4-.1.1-.2.3-.3.4-.5.6-.9 1.1-1.4 1.6l-.3.3-1.2 1.2-.4.4c-.5.5-1 .9-1.6 1.4-.6.5-1.1.9-1.7 1.3-.2.1-.3.2-.5.3-.5.3-.9.7-1.4 1-.1.1-.3.2-.4.3-.6.4-1.2.7-1.9 1.1-.1.1-.3.1-.4.2-.5.3-1 .5-1.6.8l-.6.3c-.7.3-1.3.6-2 .8-.7.3-1.4.5-2.1.7-.2.1-.4.1-.6.2-.6.2-1.1.3-1.7.4-.2 0-.3.1-.5.1-.7.2-1.5.3-2.2.4-.2 0-.3 0-.5.1-.6.1-1.2.1-1.8.2h-.6c-.8 0-1.5.1-2.3.1s-1.5 0-2.3-.1h-.6c-.6 0-1.2-.1-1.8-.2-.2 0-.3 0-.5-.1-.7-.1-1.5-.2-2.2-.4-.2 0-.3-.1-.5-.1-.6-.1-1.2-.3-1.7-.4-.2-.1-.4-.1-.6-.2-.7-.2-1.4-.4-2.1-.7-.7-.2-1.3-.5-2-.8l-.6-.3c-.5-.2-1.1-.5-1.6-.8-.1-.1-.3-.1-.4-.2-.6-.3-1.3-.7-1.9-1.1-.1-.1-.3-.2-.4-.3-.5-.3-1-.6-1.4-1-.2-.1-.3-.2-.5-.3-.6-.4-1.2-.9-1.7-1.3s-1.1-.9-1.6-1.4l-.4-.4-1.2-1.2-.3-.3c-.5-.5-1-1.1-1.4-1.6-.1-.1-.2-.3-.3-.4-.4-.4-.7-.9-1-1.4-.1-.2-.2-.3-.3-.5l-1.2-1.8v-.1c-.4-.6-.7-1.2-1-1.8-2.6-5-4.1-10.7-4.1-16.7s1.5-11.7 4.1-16.7zM620 539v221c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V539c-10.1 3.3-20.8 5-32 5s-21.9-1.8-32-5zm64-198v-77c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v77c10.1-3.3 20.8-5 32-5s21.9 1.8 32 5zm-64 198c10.1 3.3 20.8 5 32 5s21.9-1.8 32-5c41.8-13.5 72-52.7 72-99s-30.2-85.5-72-99c-10.1-3.3-20.8-5-32-5s-21.9 1.8-32 5c-41.8 13.5-72 52.7-72 99s30.2 85.5 72 99zm.1-115.7c.3-.6.7-1.2 1-1.8v-.1l1.2-1.8c.1-.2.2-.3.3-.5.3-.5.7-.9 1-1.4.1-.1.2-.3.3-.4.5-.6.9-1.1 1.4-1.6l.3-.3 1.2-1.2.4-.4c.5-.5 1-.9 1.6-1.4.6-.5 1.1-.9 1.7-1.3.2-.1.3-.2.5-.3.5-.3.9-.7 1.4-1 .1-.1.3-.2.4-.3.6-.4 1.2-.7 1.9-1.1.1-.1.3-.1.4-.2.5-.3 1-.5 1.6-.8l.6-.3c.7-.3 1.3-.6 2-.8.7-.3 1.4-.5 2.1-.7.2-.1.4-.1.6-.2.6-.2 1.1-.3 1.7-.4.2 0 .3-.1.5-.1.7-.2 1.5-.3 2.2-.4.2 0 .3 0 .5-.1.6-.1 1.2-.1 1.8-.2h.6c.8 0 1.5-.1 2.3-.1s1.5 0 2.3.1h.6c.6 0 1.2.1 1.8.2.2 0 .3 0 .5.1.7.1 1.5.2 2.2.4.2 0 .3.1.5.1.6.1 1.2.3 1.7.4.2.1.4.1.6.2.7.2 1.4.4 2.1.7.7.2 1.3.5 2 .8l.6.3c.5.2 1.1.5 1.6.8.1.1.3.1.4.2.6.3 1.3.7 1.9 1.1.1.1.3.2.4.3.5.3 1 .6 1.4 1 .2.1.3.2.5.3.6.4 1.2.9 1.7 1.3s1.1.9 1.6 1.4l.4.4 1.2 1.2.3.3c.5.5 1 1.1 1.4 1.6.1.1.2.3.3.4.4.4.7.9 1 1.4.1.2.2.3.3.5l1.2 1.8v.1a36.18 36.18 0 015.1 18.5c0 6-1.5 11.7-4.1 16.7-.3.6-.7 1.2-1 1.8v.1l-1.2 1.8c-.1.2-.2.3-.3.5-.3.5-.7.9-1 1.4-.1.1-.2.3-.3.4-.5.6-.9 1.1-1.4 1.6l-.3.3-1.2 1.2-.4.4c-.5.5-1 .9-1.6 1.4-.6.5-1.1.9-1.7 1.3-.2.1-.3.2-.5.3-.5.3-.9.7-1.4 1-.1.1-.3.2-.4.3-.6.4-1.2.7-1.9 1.1-.1.1-.3.1-.4.2-.5.3-1 .5-1.6.8l-.6.3c-.7.3-1.3.6-2 .8-.7.3-1.4.5-2.1.7-.2.1-.4.1-.6.2-.6.2-1.1.3-1.7.4-.2 0-.3.1-.5.1-.7.2-1.5.3-2.2.4-.2 0-.3 0-.5.1-.6.1-1.2.1-1.8.2h-.6c-.8 0-1.5.1-2.3.1s-1.5 0-2.3-.1h-.6c-.6 0-1.2-.1-1.8-.2-.2 0-.3 0-.5-.1-.7-.1-1.5-.2-2.2-.4-.2 0-.3-.1-.5-.1-.6-.1-1.2-.3-1.7-.4-.2-.1-.4-.1-.6-.2-.7-.2-1.4-.4-2.1-.7-.7-.2-1.3-.5-2-.8l-.6-.3c-.5-.2-1.1-.5-1.6-.8-.1-.1-.3-.1-.4-.2-.6-.3-1.3-.7-1.9-1.1-.1-.1-.3-.2-.4-.3-.5-.3-1-.6-1.4-1-.2-.1-.3-.2-.5-.3-.6-.4-1.2-.9-1.7-1.3s-1.1-.9-1.6-1.4l-.4-.4-1.2-1.2-.3-.3c-.5-.5-1-1.1-1.4-1.6-.1-.1-.2-.3-.3-.4-.4-.4-.7-.9-1-1.4-.1-.2-.2-.3-.3-.5l-1.2-1.8v-.1c-.4-.6-.7-1.2-1-1.8-2.6-5-4.1-10.7-4.1-16.7s1.5-11.7 4.1-16.7z"}}]},name:"control",theme:"outlined"},Aa=function(p,r){return s.createElement(Xe,et({},p,{ref:r,icon:Ba}))},qa=s.forwardRef(Aa),Pa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM382 896h-.2L232 746.2v-.2h150v150z"}}]},name:"copy",theme:"filled"},Ea=function(p,r){return s.createElement(Xe,et({},p,{ref:r,icon:Pa}))},ct=s.forwardRef(Ea),Ya={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32zm-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9z"}}]},name:"edit",theme:"filled"},za=function(p,r){return s.createElement(Xe,et({},p,{ref:r,icon:Ya}))},aa=s.forwardRef(za),Ha={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},Fa=function(p,r){return s.createElement(Xe,et({},p,{ref:r,icon:Ha}))},sa=s.forwardRef(Fa),$a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},Va=function(p,r){return s.createElement(Xe,et({},p,{ref:r,icon:$a}))},Ua=s.forwardRef(Va),La={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M723 620.5C666.8 571.6 593.4 542 513 542s-153.8 29.6-210.1 78.6a8.1 8.1 0 00-.8 11.2l36 42.9c2.9 3.4 8 3.8 11.4.9C393.1 637.2 450.3 614 513 614s119.9 23.2 163.5 61.5c3.4 2.9 8.5 2.5 11.4-.9l36-42.9c2.8-3.3 2.4-8.3-.9-11.2zm117.4-140.1C751.7 406.5 637.6 362 513 362s-238.7 44.5-327.5 118.4a8.05 8.05 0 00-1 11.3l36 42.9c2.8 3.4 7.9 3.8 11.2 1C308 472.2 406.1 434 513 434s205 38.2 281.2 101.6c3.4 2.8 8.4 2.4 11.2-1l36-42.9c2.8-3.4 2.4-8.5-1-11.3zm116.7-139C835.7 241.8 680.3 182 511 182c-168.2 0-322.6 59-443.7 157.4a8 8 0 00-1.1 11.4l36 42.9c2.8 3.3 7.8 3.8 11.1 1.1C222 306.7 360.3 254 511 254c151.8 0 291 53.5 400 142.7 3.4 2.8 8.4 2.3 11.2-1.1l36-42.9c2.9-3.4 2.4-8.5-1.1-11.3zM448 778a64 64 0 10128 0 64 64 0 10-128 0z"}}]},name:"wifi",theme:"outlined"},Ga=function(p,r){return s.createElement(Xe,et({},p,{ref:r,icon:La}))},_a=s.forwardRef(Ga);const oe={data:null,lastUpdated:null,version:0,isStale:!1},zt=5*60*1e3,Qa=(u,p,r="all")=>{if(!p||p.trim()==="")return u;const h=p.toLowerCase().trim().split(/\s+/).filter(l=>l.length>0);return u.filter(l=>{if(!l)return!1;if(r==="all"){const n=Object.values(l).filter(f=>f!=null&&f!==void 0).map(f=>String(f).toLowerCase()).join(" ");return h.every(f=>n.includes(f))}else{const n=l[r];if(!n)return!1;const f=String(n).toLowerCase();return h.every(k=>f.includes(k))}})},ke=typeof window<"u"&&window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1"&&window.location.hostname!==""&&!window.location.hostname.startsWith("192.168.")&&!0,Wa=(u=[],p=!1,r,o)=>{const{message:h}=We.useApp(),[l,n]=s.useState(""),[f,k]=s.useState("Newest"),[m,S]=s.useState({field:"id",order:"descend"}),[q,B]=s.useState(1),[R,z]=s.useState(10),[N,w]=s.useState([]),[d,b]=s.useState(!1),[j,U]=s.useState(!1),[G,H]=s.useState(!1),[M,C]=s.useState(null),[Q,x]=s.useState(null),[y,E]=s.useState("default"),[ue,P]=s.useState(!1),[ce,me]=s.useState(()=>Array.isArray(u)&&u.length>0?Date.now():null),{logUserActivity:de}=Se(),{logUserNotification:he}=Ce(),{userData:Ne}=Ke(),{userData:fe}=Je(),xe=s.useRef(null),i=(Ne==null?void 0:Ne.username)||(fe==null?void 0:fe.username)||"Unknown User",D=!!Ne,t=D?"admin":!!fe?"user":"guest",c=s.useMemo(()=>u||[],[u]),{totalEntries:g,paginatedData:I}=s.useMemo(()=>{const O=Qa(c,l),Z=[...O].sort((re,W)=>{if(m.field&&m.order){const{field:ae,order:le}=m;if(le==="ascend")return re[ae]>W[ae]?1:-1;if(le==="descend")return re[ae]<W[ae]?1:-1}return 0}),X=Z.length,ne=Z.slice((q-1)*R,q*R);return{filteredData:O,sortedData:Z,totalEntries:X,paginatedData:ne}},[c,l,m,q,R]),K=s.useCallback(async(O=!1)=>{var Z;try{if(ke&&await Pe()){h.warning("Cannot refresh data while offline");return}P(!0);const X=Date.now(),ne=X-(oe.lastUpdated||0);if(!O&&oe.data&&ne<zt&&!oe.isStale){const le=r||o;typeof le=="function"&&le(oe.data),me(oe.lastUpdated);return}const W=await Ee();oe.data=W,oe.lastUpdated=X,oe.version++,oe.isStale=!1;const ae=r||o;typeof ae=="function"&&ae(W),me(X)}catch(X){ke&&(X.isOffline||(Z=X.message)!=null&&Z.includes("Offline"))?h.warning("Cannot refresh data while offline"):h.error("Failed to load inventory data.")}finally{P(!1)}},[h,r,o]),Y=s.useCallback(()=>{xe.current&&clearInterval(xe.current),xe.current=setInterval(async()=>{try{if(ke&&await Pe())return;const O=await Ee();oe.data=O,oe.lastUpdated=Date.now(),oe.version++;const Z=r||o;typeof Z=="function"&&Z(O),me(Date.now())}catch(O){console.warn("Background sync failed:",O),oe.isStale=!0}},zt)},[r,o]),je=s.useCallback(()=>{xe.current&&(clearInterval(xe.current),xe.current=null)},[]);s.useEffect(()=>(Y(),()=>je()),[Y,je]);const Ie=s.useCallback(()=>{oe.isStale=!0},[]),$e=s.useCallback((O,Z)=>{B(O),z(Z)},[]),ut=s.useCallback(O=>{const Z=O==="Oldest"?"Oldest":"Newest";k(Z),S({field:"id",order:Z==="Newest"?"descend":"ascend"}),B(1)},[]),st=s.useCallback(O=>{O.field&&S({field:O.field,order:O.order})},[]),ht=s.useCallback(async O=>{var Z;try{if(ke&&await Pe()){h.warning("Cannot add item while offline");return}const X=await fa(O);if(X&&X.id){const ne=r||o;if(typeof ne=="function"){const re={...O,id:X.id,issuedDate:O.issuedDate||null,purchaseDate:O.purchaseDate||null};ne(W=>[...W,re]),oe.data&&(oe.data=[...oe.data,re],oe.lastUpdated=Date.now(),oe.version++)}h.success(`Item added successfully! ID: ${X.id}`),await de(i,"Inventory",`Added item with ID: ${X.id}`),await he("Inventory Update",`You added an item with ID: ${X.id}`),typeof ne!="function"&&K()}else h.error("Failed to retrieve item ID.")}catch(X){ke&&(X.isOffline||(Z=X.message)!=null&&Z.includes("Offline"))?h.warning("Cannot add item while offline"):(console.error("Error adding item:",X),h.error("Failed to add item."))}},[h,de,he,i,K,r,o]),mt=s.useCallback(O=>{x(O),U(!0)},[]),xt=s.useCallback(O=>{C(O),H(!0)},[]),pt=s.useCallback(async O=>{var Z,X,ne;try{if(ke&&await Pe()){h.warning("Cannot redistribute item while offline");return}const re=await ya(O),W=r||o;if(typeof W=="function"&&(W(ae=>ae.map(le=>le.id===O.id?{...le,quantity:le.quantity-O.newQuantity}:le)),re.new_item_id)){const ae=c.find(le=>le.id===O.id);if(ae){const le={id:re.new_item_id,type:ae.type,brand:ae.brand,quantity:O.newQuantity,serialNumber:ae.serialNumber,issuedDate:O.issuedDate,purchaseDate:ae.purchaseDate,condition:O.condition,location:O.newLocation,status:O.status,remarks:O.remarks};W(Ae=>[...Ae,le])}}h.success(`Item redistributed successfully! New Item ID: ${re.new_item_id}`),H(!1),C(null),await de(i,"Inventory",`Redistributed item with ID: ${O.id} to new item ID: ${re.new_item_id}`),await he("Inventory Update",`You redistributed an item with ID: ${O.id} to new item ID: ${re.new_item_id}`),typeof W!="function"&&K()}catch(re){if(ke&&(re.isOffline||(Z=re.message)!=null&&Z.includes("Offline")))h.warning("Cannot redistribute item while offline");else{const W=((ne=(X=re==null?void 0:re.response)==null?void 0:X.data)==null?void 0:ne.message)||re.message||"";W.toLowerCase().includes("quantity")&&W.includes("1")?h.error("You can't redistribute an item with quantity of 1."):h.error("Failed to redistribute item."),console.error(re)}}},[h,de,he,i,K,r,o,c]),ft=s.useCallback(async(O,Z=null)=>{var re;const X=Z||Q;if(!Object.keys(O).some(W=>{const ae=O[W],le=X[W];if(W==="issuedDate"||W==="purchaseDate"){const Ae=le?te(le).format("YYYY-MM-DD"):null;return ae!==Ae}if(W==="quantity"){const Ae=Number(ae),nt=Number(le);return Ae!==nt}return typeof ae=="string"?ae.trim()!==(le||"").trim():ae!==le})){h.error("No changes detected.");return}try{if(ke&&await Pe()){h.warning("Cannot edit item while offline");return}const W=await ba({...O,id:(O==null?void 0:O.id)||(Q==null?void 0:Q.id)});if(W.message==="Item updated successfully"){const ae=r||o;typeof ae=="function"&&(ae(le=>le.map(Ae=>Ae.id===O.id?{...Ae,...O}:Ae)),oe.data&&(oe.data=oe.data.map(le=>le.id===O.id?{...le,...O}:le),oe.lastUpdated=Date.now(),oe.version++)),h.success(`Item with ID ${O.id} updated successfully!`),await de(i,"Inventory",`Updated item with ID: ${O.id}`),await he("Inventory Update",`You edited an item with ID: ${O.id}`),U(!1),typeof ae!="function"&&K()}else h.error(W.message||"Failed to update item.")}catch(W){ke&&(W.isOffline||(re=W.message)!=null&&re.includes("Offline"))?h.warning("Cannot edit item while offline"):(console.error("Error updating item:",W),W.response&&W.response.data&&W.response.data.message?h.error(`Failed to update item: ${W.response.data.message}`):h.error("Failed to update item. Please try again."))}},[Q,h,de,he,i,K,r,o]),yt=s.useCallback(async()=>{var O;if(!D){h.error("You do not have permission to delete items.");return}if(N.length===0){h.warning("Please select items to delete.");return}try{if(ke&&await Pe()){h.warning("Cannot delete items while offline");return}(await At(N)).message==="Items deleted successfully"?(await Ee(),K(),w([]),h.success("Items deleted successfully!"),await de(i,"Inventory",`Deleted item(s) with ID(s): ${N.join(", ")}`),await he("Inventory Update",`You deleted item(s) with ID(s): ${N.join(", ")}`)):h.error("Error deleting items.")}catch(Z){ke&&(Z.isOffline||(O=Z.message)!=null&&O.includes("Offline"))?h.warning("Cannot delete items while offline"):(console.error("Error deleting items:",Z),h.error("Failed to delete items. Please try again."))}},[D,N,h,K,de,he,i]),bt=s.useCallback(O=>{E(O)},[]),jt=s.useMemo(()=>({selectedRowKeys:N,onChange:O=>w(O),preserveSelectedRowKeys:!0}),[N]),Ge=s.useCallback(async()=>{var O,Z,X;if(!D){h.error("You do not have permission to delete items.");return}if(N.length===0){h.warning("Please select items to delete.");return}try{if(ke&&await Pe()){h.warning("Cannot delete items while offline");return}console.log("Deleting IDs:",N);const ne=await At(N);if(console.log("Delete response:",ne),ne.message==="Items deleted successfully"){const re=r||o;typeof re=="function"&&(re(W=>W.filter(ae=>!N.includes(ae.id))),oe.data&&(oe.data=oe.data.filter(W=>!N.includes(W.id)),oe.lastUpdated=Date.now(),oe.version++)),w([]),h.success("Items deleted successfully!"),await de(i,"Inventory",`Deleted item(s) with ID(s): ${N.join(", ")}`),await he("Inventory Update",`You deleted item(s) with ID(s): ${N.join(", ")}`)}else h.error(ne.message||"Error deleting items.")}catch(ne){ke&&(ne.isOffline||(O=ne.message)!=null&&O.includes("Offline"))?h.warning("Cannot delete items while offline"):((X=(Z=ne==null?void 0:ne.response)==null?void 0:Z.data)!=null&&X.message?h.error(`Failed to delete items: ${ne.response.data.message}`):ne!=null&&ne.message?h.error(`Failed to delete items: ${ne.message}`):h.error("Failed to delete items. Please try again."),console.error("Error deleting items:",ne))}},[D,N,h,de,he,i,r,o]);return{searchText:l,setSearchText:n,sortOrder:f,currentPage:q,pageSize:R,isModalVisible:d,setIsModalVisible:b,isEditModalVisible:j,setIsEditModalVisible:U,redistributeItemData:M,setRedistributeItemData:C,isRedistributeModalVisible:G,setIsRedistributeModalVisible:H,editingItem:Q,isLoading:p,isRefreshing:ue,lastSyncTime:ce,activeTab:y,isAdmin:D,userRole:t,paginatedData:I,totalEntries:g,handleRedistribute:xt,handleRedistributeItem:pt,handlePageChange:$e,handleSortOrderChange:ut,handleTableChange:st,handleAddItem:ht,handleEdit:mt,handleEditItem:ft,handleBatchDelete:yt,handleDeleteItems:Ge,handleTabChange:bt,rowSelection:jt,dataSource:c,selectedRowKeys:N,setSelectedRowKeys:w,handleRefresh:K,markCacheStale:Ie}},dt=()=>{const u=Ke.getState(),p=Je.getState();if(u.token&&u.userData)return qt("data",Pt.admin);if(p.token&&p.userData)return qt("data",Pt.user);throw new Error("No valid authentication found")},Ka=async u=>{try{return(await dt().post("/save_template.php",u)).data}catch(p){throw p}},Ja=async()=>{try{return(await dt().get("/get_templates.php")).data}catch(u){throw u}},Za=async(u,p)=>{try{return(await dt().put(`/update_template.php?id=${u}`,p)).data}catch(r){throw r}},Xa=async u=>{try{return(await dt().delete(`/delete_template.php?id=${u}`)).data}catch(p){throw p}},es=u=>{const[p,r]=s.useState(null),[o,h]=s.useState(null),[l,n]=s.useState([]),[f,k]=s.useState(!1),[m,S]=s.useState(null),[q]=v.useForm(),{message:B}=We.useApp(),[R,z]=s.useState(0),{logUserActivity:N}=Se(),{logUserNotification:w}=Ce(),d=Ke(),b=Je();s.useEffect(()=>{j()},[R]);const j=async()=>{try{const x=await Ja();x.success&&(n(x.templates),p==="User Templates"&&(r(null),h(null),u(null)))}catch(x){console.error("Error loading templates:",x),B.error("Error loading templates")}};return{selectedCategory:p,selectedType:o,userTemplates:l,isEditModalVisible:f,editingTemplate:m,form:q,refreshTrigger:R,setRefreshTrigger:z,handleCategoryChange:x=>{if(x==="No Template"||!x){r(null),h(null),u(null);return}r(x),h(null)},handleTypeChange:x=>{if(!x||x==="No Template")return r(null),h(null),u(null),{isUserTemplate:!1};if(h(x),p==="User Templates"){const y=l.find(E=>E.template_name===x);if(y){const E={...y,locationType:y.location.includes("Head Office")?"Head Office":"Other",department:y.location.includes("Head Office")?y.location.split(" - ")[1]:null,location:(y.location.includes("Head Office"),y.location)};return u(E),{isUserTemplate:!0}}}else if(p&&ot[p][x])return u(ot[p][x]),{isUserTemplate:!1}},handleEdit:x=>{S(x),q.setFieldsValue({...x,locationType:x.location.includes("Head Office")?"Head Office":"Other",department:x.location.includes("Head Office")?x.location.split(" - ")[1]:null,location:x.location.includes("Head Office")?null:x.location,purchaseDate:x.purchaseDate?te(x.purchaseDate):void 0,issuedDate:x.issuedDate?te(x.issuedDate):void 0}),k(!0)},handleDelete:async x=>{try{const y=await Xa(x.id);y.success?(B.success("Template deleted successfully"),n(E=>E.filter(ue=>ue.id!==x.id)),o===x.template_name&&(r(null),h(null),u(null)),z(E=>E+1),await N(d.userData.username,"Template Deleted",`Template "${x.template_name}" has been deleted.`),await w("Template Deleted",`Template "${x.template_name}" has been deleted.`)):B.error(y.message||"Failed to delete template")}catch(y){console.error("Error deleting template:",y),B.error("Error deleting template")}},handleEditSubmit:async x=>{try{const y={...x,location:x.locationType==="Head Office"?`Head Office - ${x.department}`:x.location,purchaseDate:x.purchaseDate?x.purchaseDate.format("YYYY-MM-DD"):null,issuedDate:x.issuedDate?x.issuedDate.format("YYYY-MM-DD"):null};delete y.locationType,delete y.department;const E=await Za(m.id,y);if(E.success){if(B.success("Template updated successfully"),k(!1),n(ue=>ue.map(P=>P.id===m.id?{...P,...y}:P)),o===m.template_name){const ue={...m,...y,locationType:y.location.includes("Head Office")?"Head Office":"Other",department:y.location.includes("Head Office")?y.location.split(" - ")[1]:null};u(ue)}z(ue=>ue+1),await N(d.userData.username,"Template Updated",`Template "${x.template_name}" has been updated.`),await w("Template Updated",`Template "${x.template_name}" has been updated.`)}else B.error(E.message||"Failed to update template")}catch(y){console.error("Error updating template:",y),B.error("Error updating template")}},setIsEditModalVisible:k,getCurrentUser:()=>d.token&&d.userData?d.userData:b.token&&b.userData?b.userData:null}},{Option:L}=A,ts={SOD:"SOD",CID:"CID",GAD:"GAD",HRD:"HRD",AFD:"AFD",EOD:"EOD",BDO:"BDO"},ot={"IT Equipment":{"System Unit":{type:"System Unit",brand:"Dell",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"IT Department",remarks:"Standard office computer",serialNumber:"",purchaseDate:"",issuedDate:""},Laptop:{type:"Laptop",brand:"Lenovo",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"IT Department",remarks:"Business laptop",serialNumber:"",purchaseDate:"",issuedDate:""},Monitor:{type:"Monitor",brand:"Dell",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"IT Department",remarks:"Office monitor",serialNumber:"",purchaseDate:"",issuedDate:""},Printer:{type:"Printer",brand:"HP",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"IT Department",remarks:"Office printer",serialNumber:"",purchaseDate:"",issuedDate:""}},"Network Equipment":{Router:{type:"Router",brand:"Cisco",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"Network Department",remarks:"Network router",serialNumber:"",purchaseDate:"",issuedDate:""},Switch:{type:"Switch",brand:"Cisco",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"Network Department",remarks:"Network switch",serialNumber:"",purchaseDate:"",issuedDate:""},Modem:{type:"Modem",brand:"TP-Link",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"Network Department",remarks:"Internet modem",serialNumber:"",purchaseDate:"",issuedDate:""},"WIFI-Mesh":{type:"WIFI-Mesh",brand:"Ubiquiti",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"Network Department",remarks:"Wireless mesh system",serialNumber:"",purchaseDate:"",issuedDate:""}},"Security Equipment":{CCTV:{type:"CCTV",brand:"Hikvision",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"SOD",location:"Security Department",remarks:"Security camera",serialNumber:"",purchaseDate:"",issuedDate:""},Biometrics:{type:"Biometrics",brand:"ZKTeco",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"SOD",location:"Security Department",remarks:"Biometric scanner",serialNumber:"",purchaseDate:"",issuedDate:""},"Metal Detector":{type:"Metal Detector",brand:"Garrett",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"SOD",location:"Security Department",remarks:"Security metal detector",serialNumber:"",purchaseDate:"",issuedDate:""},"Guard Tour System":{type:"Guard Tour System",brand:"Detex",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"SOD",location:"Security Department",remarks:"Guard tour monitoring system",serialNumber:"",purchaseDate:"",issuedDate:""}},"Communication Equipment":{Radio:{type:"Radio",brand:"Motorola",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"SOD",location:"Communication Department",remarks:"Two-way radio",serialNumber:"",purchaseDate:"",issuedDate:""},Smartphone:{type:"Smartphone",brand:"Samsung",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"SOD",location:"Communication Department",remarks:"Office mobile phone",serialNumber:"",purchaseDate:"",issuedDate:""},Headset:{type:"Headset",brand:"Jabra",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"SOD",location:"Communication Department",remarks:"Office headset",serialNumber:"",purchaseDate:"",issuedDate:""},Megaphone:{type:"Megaphone",brand:"Pyle",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"SOD",location:"Communication Department",remarks:"Public address system",serialNumber:"",purchaseDate:"",issuedDate:""}},"Power Equipment":{UPS:{type:"UPS",brand:"APC",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"IT Department",remarks:"Uninterruptible power supply",serialNumber:"",purchaseDate:"",issuedDate:""},AVR:{type:"AVR",brand:"Stavol",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"IT Department",remarks:"Automatic voltage regulator",serialNumber:"",purchaseDate:"",issuedDate:""},Battery:{type:"Battery",brand:"Yuasa",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"IT Department",remarks:"Backup battery",serialNumber:"",purchaseDate:"",issuedDate:""},Charger:{type:"Charger",brand:"Anker",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"IT Department",remarks:"Device charger",serialNumber:"",purchaseDate:"",issuedDate:""}},Accessories:{Keyboard:{type:"Keyboard",brand:"Logitech",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"IT Department",remarks:"Computer keyboard",serialNumber:"",purchaseDate:"",issuedDate:""},Mouse:{type:"Mouse",brand:"Logitech",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"IT Department",remarks:"Computer mouse",serialNumber:"",purchaseDate:"",issuedDate:""},Speaker:{type:"Speaker",brand:"JBL",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"IT Department",remarks:"Audio speaker",serialNumber:"",purchaseDate:"",issuedDate:""},Microphone:{type:"Microphone",brand:"Shure",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"IT Department",remarks:"Audio microphone",serialNumber:"",purchaseDate:"",issuedDate:""}},Others:{Pedestal:{type:"Pedestal",brand:"Generic",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"General",remarks:"Equipment pedestal",serialNumber:"",purchaseDate:"",issuedDate:""},Podium:{type:"Podium",brand:"Generic",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"GAD",location:"General",remarks:"Presentation podium",serialNumber:"",purchaseDate:"",issuedDate:""},"Search Stick":{type:"Search Stick",brand:"Generic",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"SOD",location:"Security Department",remarks:"Security search tool",serialNumber:"",purchaseDate:"",issuedDate:""},Searchlight:{type:"Searchlight",brand:"Generic",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"SOD",location:"Security Department",remarks:"Security search light",serialNumber:"",purchaseDate:"",issuedDate:""},"Guard Tour Chips":{type:"Guard Tour Chips",brand:"Detex",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"SOD",location:"Security Department",remarks:"Guard tour system chips",serialNumber:"",purchaseDate:"",issuedDate:""},"Under Chassis":{type:"Under Chassis",brand:"Generic",condition:"Brand New",status:"On Stock",quantity:1,locationType:"Head Office",department:"SOD",location:"Security Department",remarks:"Vehicle under chassis scanner",serialNumber:"",purchaseDate:"",issuedDate:""}}},as=s.forwardRef(({onTemplateSelect:u},p)=>{const{selectedCategory:r,selectedType:o,userTemplates:h,isEditModalVisible:l,form:n,setRefreshTrigger:f,handleCategoryChange:k,handleTypeChange:m,handleEdit:S,handleDelete:q,handleEditSubmit:B,setIsEditModalVisible:R}=es(u),z=Ke(),N=Je(),{theme:w,currentTheme:d}=Qt(),j=d==="default"?{textColor:"#072C1C",borderColor:"#f0f0f0",buttonBg:"transparent",buttonText:"#072C1C"}:{textColor:w.text,borderColor:w.text,buttonBg:"transparent",buttonText:w.text},U=()=>{const M=z.token&&z.userData,C=N.token&&N.userData;if(M)return z.userData;if(C)return N.userData;const Q=Ue.get("username"),x=Ue.get("user_id");return Q&&x?{username:Q,id:x}:null},G=M=>{const C=U();return C&&C.username===M.created_by};s.useImperativeHandle(p,()=>({setRefreshTrigger:f,handleTypeChange:m}));const H=Object.keys(ot).sort();return e.jsxs(lt,{direction:"vertical",style:{width:"100%",marginBottom:"16px"},children:[e.jsx(Wt,{message:"Quick Templates",description:"Select a category and type to quickly fill item details, or choose No Template to use your own values",type:"info",showIcon:!0,className:"theme-aware-alert text-xs"}),e.jsxs(Ze,{gutter:16,children:[e.jsx(Be,{span:12,children:e.jsxs(A,{placeholder:"Select Category",style:{width:"100%"},onChange:k,value:r,allowClear:!0,children:[e.jsx(L,{value:"No Template",children:"No Template"}),H.map(M=>e.jsx(L,{value:M,children:M},M)),h.length>0&&e.jsx(L,{value:"User Templates",children:"User Templates"})]})}),e.jsx(Be,{span:12,children:e.jsx(A,{placeholder:"Select Type",style:{width:"100%"},onChange:m,disabled:!r,value:o,allowClear:!0,optionLabelProp:"label",children:r==="User Templates"?h.sort((M,C)=>M.template_name.localeCompare(C.template_name)).map(M=>e.jsx(L,{value:M.template_name,label:M.template_name,children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:M.template_name}),e.jsxs("div",{style:{fontSize:"12px",color:"#8c8c8c",marginTop:"2px"},children:["Created by: ",M.created_by||"System"]})]}),e.jsxs(lt,{children:[e.jsx(Ye,{title:G(M)?"Edit Template":"Only the creator can edit this template",children:e.jsx(J,{type:"text",style:{backgroundColor:"transparent",color:j.buttonText},icon:e.jsx(wt,{}),onClick:C=>{C.stopPropagation(),S(M)},disabled:!G(M)})}),e.jsx(Ye,{title:G(M)?"Delete Template":"Only the creator can delete this template",children:e.jsx(J,{type:"text",style:{backgroundColor:"transparent",color:j.buttonText},danger:!0,icon:e.jsx(Kt,{}),onClick:C=>{C.stopPropagation(),q(M)},disabled:!G(M)})})]})]})},M.template_name)):r&&Object.keys(ot[r]).sort().map(M=>e.jsx(L,{value:M,children:M},M))})})]}),e.jsx(ja,{style:{margin:"16px 0"}}),e.jsx(ve,{title:e.jsx("span",{style:{color:j.textColor},children:"Edit Template"}),open:l,onCancel:()=>R(!1),footer:null,width:900,styles:{header:{background:d==="default"?"#A8E1C5":w.CardHead||w.sider,borderBottom:`1px solid ${j.borderColor}`,borderRadius:"12px 12px 0 0"},content:{background:d==="default"?"#fff":w.componentBackground,borderRadius:"12px",overflow:"hidden"},body:{padding:"24px"}},children:e.jsx(v,{form:n,onFinish:B,layout:"vertical",children:e.jsxs(Ze,{gutter:16,children:[e.jsxs(Be,{span:12,children:[e.jsx(v.Item,{name:"template_name",label:"Template Name",rules:[{required:!0,message:"Please enter template name"}],children:e.jsx(_,{})}),e.jsx(v.Item,{name:"type",label:"Type",rules:[{required:!0,message:"Please select type"}],children:e.jsxs(A,{children:[e.jsx(L,{value:"AVR",children:"AVR"}),e.jsx(L,{value:"Battery",children:"Battery"}),e.jsx(L,{value:"Biometrics",children:"Biometrics"}),e.jsx(L,{value:"Camera",children:"Camera"}),e.jsx(L,{value:"CCTV",children:"CCTV"}),e.jsx(L,{value:"Charger",children:"Charger"}),e.jsx(L,{value:"Guard Tour Chips",children:"Guard Tour Chips"}),e.jsx(L,{value:"Guard Tour System",children:"Guard Tour System"}),e.jsx(L,{value:"Headset",children:"Headset"}),e.jsx(L,{value:"Keyboard",children:"Keyboard"}),e.jsx(L,{value:"Laptop",children:"Laptop"}),e.jsx(L,{value:"Megaphone",children:"Megaphone"}),e.jsx(L,{value:"WIFI-Mesh",children:"WIFI-Mesh"}),e.jsx(L,{value:"Metal Detector",children:"Metal Detector"}),e.jsx(L,{value:"Microphone",children:"Microphone"}),e.jsx(L,{value:"Modem",children:"Modem"}),e.jsx(L,{value:"Monitor",children:"Monitor"}),e.jsx(L,{value:"Mouse",children:"Mouse"}),e.jsx(L,{value:"Others",children:"Others"}),e.jsx(L,{value:"Pedestal",children:"Pedestal"}),e.jsx(L,{value:"Podium",children:"Podium"}),e.jsx(L,{value:"Printer",children:"Printer"}),e.jsx(L,{value:"Radio",children:"Radio"}),e.jsx(L,{value:"Router",children:"Router"}),e.jsx(L,{value:"Search Stick",children:"Search Stick"}),e.jsx(L,{value:"Searchlight",children:"Searchlight"}),e.jsx(L,{value:"Smartphone",children:"Smartphone"}),e.jsx(L,{value:"Speaker",children:"Speaker"}),e.jsx(L,{value:"Switch",children:"Switch"}),e.jsx(L,{value:"System Unit",children:"System Unit"}),e.jsx(L,{value:"Under Chassis",children:"Under Chassis"}),e.jsx(L,{value:"UPS",children:"UPS"})]})}),e.jsx(v.Item,{name:"brand",label:"Brand",rules:[{required:!0,message:"Please enter brand"}],children:e.jsx(_,{})}),e.jsx(v.Item,{name:"serialNumber",label:"Serial Number",children:e.jsx(_,{})}),e.jsx(v.Item,{name:"purchaseDate",label:"Purchase Date",rules:[{required:!0,message:"Please select purchase date"}],children:e.jsx(ge,{format:"YYYY-MM-DD",style:{width:"100%"}})}),e.jsx(v.Item,{name:"issuedDate",label:"Issued Date",tooltip:"Optional - Leave empty if not issued yet",children:e.jsx(ge,{format:"YYYY-MM-DD",style:{width:"100%"}})})]}),e.jsxs(Be,{span:12,children:[e.jsx(v.Item,{name:"condition",label:"Condition",rules:[{required:!0,message:"Please select condition"}],children:e.jsxs(A,{children:[e.jsx(L,{value:"Brand New",children:"Brand New"}),e.jsx(L,{value:"Good Condition",children:"Good Condition"}),e.jsx(L,{value:"Defective",children:"Defective"})]})}),e.jsx(v.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(A,{children:[e.jsx(L,{value:"On Stock",children:"On Stock"}),e.jsx(L,{value:"Deployed",children:"Deployed"}),e.jsx(L,{value:"For Repair",children:"For Repair"})]})}),e.jsx(v.Item,{name:"locationType",label:"Detachment/Office",rules:[{required:!0,message:"Please select a location type"}],children:e.jsxs(A,{onChange:M=>{const C=M==="Head Office";n.setFieldsValue({department:C?n.getFieldValue("department"):null,location:C?null:n.getFieldValue("location")})},children:[e.jsx(L,{value:"Head Office",children:"Head Office"}),e.jsx(L,{value:"Other",children:"Other (Specify Below)"})]})}),e.jsx(v.Item,{noStyle:!0,shouldUpdate:(M,C)=>M.locationType!==C.locationType,children:({getFieldValue:M})=>M("locationType")==="Head Office"?e.jsx(v.Item,{name:"department",label:"Department (Head Office)",rules:[{required:!0,message:"Please select a department"}],children:e.jsx(A,{children:Object.entries(ts).map(([Q,x])=>e.jsx(L,{value:Q,children:x},Q))})}):e.jsx(v.Item,{name:"location",label:"Specific Location",rules:[{required:!0,message:"Please input a location"}],children:e.jsx(_,{})})}),e.jsx(v.Item,{name:"remarks",label:"Remarks",children:e.jsx(_.TextArea,{})}),e.jsx(v.Item,{children:e.jsx(J,{size:"small",type:"primary",htmlType:"submit",className:"text-xs",children:"Save Changes"})})]})]})})})]})}),{Option:F}=A,ss=({form:u,onFinish:p,loading:r,templateRef:o,onTemplateSelect:h,isHeadOffice:l,setIsHeadOffice:n,hasSerialNumber:f,handleSerialChange:k,selectedStockItem:m})=>{const[S,q]=s.useState(!1),[B,R]=s.useState(!1),[z,N]=s.useState(""),[w,d]=s.useState(!1),{logUserActivity:b}=Se(),{logUserNotification:j}=Ce(),U=C=>{const Q=C.target.value;N(Q),k&&k(C),Q&&!B&&!w&&(q(!0),d(!0)),Q===""&&(R(!1),d(!1),u.setFieldsValue({quantity:1}))},G=()=>{R(!0),q(!1)},H=()=>{R(!1),q(!1),u.setFieldsValue({quantity:1})},M=C=>{p(C),b("Add Item",`Added item: ${C.type} (${C.brand}), Qty: ${C.quantity}`),j("Add Item",`Added item: ${C.type} (${C.brand}), Qty: ${C.quantity}`)};return e.jsxs(e.Fragment,{children:[e.jsx(ve,{open:S,onOk:G,onCancel:H,title:"Serial Number Quantity",okText:"Yes",cancelText:"No",centered:!0,children:"Does the item you want to add have only 1 serial number but has many quantities?"}),e.jsxs(v,{form:u,onFinish:M,layout:"vertical",initialValues:{quantity:1},children:[e.jsx(as,{ref:o,onTemplateSelect:h}),e.jsxs(Ze,{gutter:[32,24],children:[e.jsx(Be,{span:12,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Type"}),name:"type",rules:[{required:!0,message:"Please select the item type!"}],children:e.jsxs(A,{size:"medium",placeholder:"Select item type",children:[e.jsx(F,{value:"AVR",children:"AVR"}),e.jsx(F,{value:"Battery",children:"Battery"}),e.jsx(F,{value:"Biometrics",children:"Biometrics"}),e.jsx(F,{value:"Camera",children:"Camera"}),e.jsx(F,{value:"CCTV",children:"CCTV"}),e.jsx(F,{value:"Charger",children:"Charger"}),e.jsx(F,{value:"Guard Tour Chips",children:"Guard Tour Chips"}),e.jsx(F,{value:"Guard Tour System",children:"Guard Tour System"}),e.jsx(F,{value:"Headset",children:"Headset"}),e.jsx(F,{value:"Keyboard",children:"Keyboard"}),e.jsx(F,{value:"Laptop",children:"Laptop"}),e.jsx(F,{value:"Megaphone",children:"Megaphone"}),e.jsx(F,{value:"WIFI-Mesh",children:"WIFI-Mesh"}),e.jsx(F,{value:"Metal Detector",children:"Metal Detector"}),e.jsx(F,{value:"Microphone",children:"Microphone"}),e.jsx(F,{value:"Modem",children:"Modem"}),e.jsx(F,{value:"Monitor",children:"Monitor"}),e.jsx(F,{value:"Mouse",children:"Mouse"}),e.jsx(F,{value:"Others",children:"Others"}),e.jsx(F,{value:"Pedestal",children:"Pedestal"}),e.jsx(F,{value:"Podium",children:"Podium"}),e.jsx(F,{value:"Printer",children:"Printer"}),e.jsx(F,{value:"Radio",children:"Radio"}),e.jsx(F,{value:"Router",children:"Router"}),e.jsx(F,{value:"Search Stick",children:"Search Stick"}),e.jsx(F,{value:"Searchlight",children:"Searchlight"}),e.jsx(F,{value:"Smartphone",children:"Smartphone"}),e.jsx(F,{value:"Speaker",children:"Speaker"}),e.jsx(F,{value:"Switch",children:"Switch"}),e.jsx(F,{value:"System Unit",children:"System Unit"}),e.jsx(F,{value:"Under Chassis",children:"Under Chassis"}),e.jsx(F,{value:"UPS",children:"UPS"})]})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Brand"}),name:"brand",rules:[{required:!0,message:"Please input the brand!"}],children:e.jsx(_,{size:"medium",placeholder:"Enter brand name"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Remarks"}),name:"remarks",tooltip:"Optional - Leave empty if there no remarks",children:e.jsx(_.TextArea,{size:"medium",rows:3,placeholder:"Enter any additional remarks"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Serial Number"}),name:"serialNumber",tooltip:"Optional - Leave empty if item has no serial number",children:e.jsx(_,{size:"medium",onChange:U,placeholder:"Enter serial number (optional)"})}),(m==null?void 0:m.action)==="redistribute"&&e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Original Quantity"}),name:"originalQuantity",rules:[{required:!0,message:"Original quantity is required"}],children:e.jsx(_,{size:"medium",disabled:!0,min:1})}),(!z||B||(m==null?void 0:m.action)==="redistribute")&&e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:(m==null?void 0:m.action)==="redistribute"?"New Quantity to Redistribute":"Quantity"}),name:"quantity",rules:[{required:!0,message:"Please input the quantity!"},{validator:(C,Q)=>!Q||Q<1?Promise.reject("Quantity must be at least 1"):(m==null?void 0:m.action)==="redistribute"&&(m!=null&&m.quantity)&&Q>=m.quantity?Promise.reject(`Quantity must be less than ${m.quantity}`):Promise.resolve()}],children:e.jsx(_,{size:"medium",type:"number",min:1,max:(m==null?void 0:m.action)==="redistribute"&&(m!=null&&m.quantity)?m.quantity-1:void 0,placeholder:"Enter quantity"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Issued Date"}),name:"issuedDate",tooltip:"Optional - Leave empty if not issued yet",children:e.jsx(ge,{size:"medium",className:"w-full",format:"YYYY-MM-DD",placeholder:"Select issued date"})})]})}),e.jsx(Be,{span:12,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Purchased Date"}),name:"purchaseDate",rules:[{required:!0,message:"Please select the purchase date!"}],children:e.jsx(ge,{size:"medium",className:"w-full",format:"YYYY-MM-DD",placeholder:"Select purchase date"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Condition"}),name:"condition",rules:[{required:!0,message:"Please select the condition!"}],children:e.jsxs(A,{size:"medium",placeholder:"Select condition",children:[e.jsx(F,{value:"Brand New",children:"Brand New"}),e.jsx(F,{value:"Good Condition",children:"Good Condition"}),e.jsx(F,{value:"Defective",children:"Defective"})]})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Detachment/Office"}),name:"locationType",rules:[{required:!0,message:"Please select a location!"}],children:e.jsxs(A,{size:"medium",onChange:C=>n(C==="Head Office"),placeholder:"Select location type",children:[e.jsx(F,{value:"Head Office",children:"Head Office"}),e.jsx(F,{value:"Other",children:"Other (Specify Below)"})]})}),l&&e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Department (Head Office)"}),name:"department",rules:[{required:!0,message:"Please select a department!"}],children:e.jsxs(A,{size:"medium",placeholder:"Select department",children:[e.jsx(F,{value:"SOD",children:"SOD"}),e.jsx(F,{value:"CID",children:"CID"}),e.jsx(F,{value:"GAD",children:"GAD"}),e.jsx(F,{value:"HRD",children:"HRD"}),e.jsx(F,{value:"AFD",children:"AFD"}),e.jsx(F,{value:"EOD",children:"EOD"}),e.jsx(F,{value:"BDO",children:"BDO"})]})}),!l&&e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Specific Location"}),name:"location",rules:[{required:!0,message:"Please input a location!"}],children:e.jsx(_,{size:"medium",placeholder:"Enter specific location"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Status"}),name:"status",rules:[{required:!0,message:"Please select the status!"}],children:e.jsxs(A,{size:"medium",placeholder:"Select status",children:[e.jsx(F,{value:"On Stock",children:"On Stock"}),e.jsx(F,{value:"Deployed",children:"Deployed"}),e.jsx(F,{value:"For Repair",children:"For Repair"})]})}),e.jsx(v.Item,{className:"mb-0",children:e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(J,{type:"primary",htmlType:"submit",icon:e.jsx(sa,{}),loading:r,size:"small",style:{background:"var(--theme-card-head-bg, #5fe7a7)",border:"none",borderRadius:"6px",padding:"8px",height:"auto",fontSize:"12px",fontWeight:"600",color:"var(--theme-text, #072C1C)"},children:"Add Item"})})})]})})]})]})]})},{Text:ns}=Fe,is=({onStockItems:u,searchText:p,setSearchText:r,fetchOnStockItems:o,loading:h,handleStockItemSelect:l})=>{const n=ta({maxWidth:639}),[f,k]=s.useState(1),[m,S]=s.useState(5),{logUserActivity:q}=Se(),{logUserNotification:B}=Ce(),R=u.filter(d=>Object.values(d).some(b=>String(b).toLowerCase().includes(p.toLowerCase()))),z=R.slice((f-1)*m,f*m),N=d=>{l(d),q("Edit Item",`Edit Item: ${d.type} (${d.brand}), Qty: ${d.quantity}`),B("Edit Item",`Edit Item: ${d.type} (${d.brand}), Qty: ${d.quantity}`)},w=[{title:"ID",dataIndex:"id",key:"id",width:"15%",className:"text-xs",render:d=>e.jsx("span",{className:"font-medium text-xs",children:d})},{title:"Type",dataIndex:"type",key:"type",width:"20%",className:"text-xs",render:d=>e.jsx("span",{className:"font-medium text-xs",children:d})},{title:"Brand",dataIndex:"brand",key:"brand",width:"20%",className:"text-xs",render:d=>e.jsx("span",{className:"font-medium text-xs",children:d})},{title:"Remarks",dataIndex:"remarks",key:"remarks",width:"15%",className:"text-xs",render:d=>e.jsx("span",{className:"font-medium text-xs",children:d})},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:"15%",className:"text-xs",render:d=>e.jsx(He,{color:d>5?"green":d>1?"orange":"red",className:"text-xs",children:d})},{title:"Location",dataIndex:"location",key:"location",width:"20%",className:"text-xs",render:d=>e.jsx(Ye,{title:d,children:e.jsx("span",{className:"max-w-[200px] text-xs",children:d})})},{title:"Status",dataIndex:"status",key:"status",width:"20%",className:"text-xs",render:d=>e.jsx(He,{color:"green",children:e.jsx("span",{className:"font-medium text-xs",children:d})})},{title:"Action",key:"action",width:"10%",className:"text-xs",render:(d,b)=>e.jsxs(lt,{children:[e.jsx(Ye,{title:"Edit",children:e.jsx(J,{type:"primary",icon:e.jsx(aa,{}),onClick:()=>N(b),size:"small",style:{backgroundColor:"var(--theme-card-head-bg, #5fe7a7)",color:"black"},className:"text-xs"})}),b.quantity>1&&e.jsx(Ye,{title:"Redistribute",children:e.jsx(J,{type:"primary",icon:e.jsx(ct,{}),onClick:()=>l({...b,action:"redistribute"}),size:"small",style:{backgroundColor:"var(--theme-text-light-custom, #EAF4E2)",color:"black"},className:"text-xs"})})]})}];return e.jsxs(at,{className:"shadow-lg border-0 mb-2",children:[e.jsxs("div",{className:n?"flex flex-col gap-2 mb-4":"flex justify-between items-center mb-4",children:[e.jsx("div",{className:n?"w-full":"flex items-center gap-4",children:e.jsx(_,{placeholder:"Search items...",prefix:e.jsx(Nt,{}),value:p,onChange:d=>r(d.target.value),style:n?{width:"100%"}:{width:300},allowClear:!0,size:"small",className:"text-xs"})}),e.jsx(J,{type:"primary",icon:e.jsx(Jt,{}),onClick:o,size:"small",style:n?{width:"100%",marginTop:0,backgroundColor:"var(--theme-card-head-bg, #a7f3d0)",color:"black"}:{backgroundColor:"var(--theme-card-head-bg, #a7f3d0)",color:"black"},className:"text-xs custom-button",children:"Refresh"})]}),e.jsx(Le,{bordered:!0,dataSource:z,columns:w,rowKey:"id",size:"small",pagination:!1,scroll:n?{x:"max-content",y:400}:{y:400},loading:h,className:"text-xs",expandable:n?{expandedRowRender:d=>e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:[e.jsx("b",{children:"ID:"})," ",d.id]}),e.jsxs("div",{children:[e.jsx("b",{children:"Type:"})," ",d.type]}),e.jsxs("div",{children:[e.jsx("b",{children:"Brand:"})," ",d.brand]}),e.jsxs("div",{children:[e.jsx("b",{children:"Quantity:"})," ",d.quantity]}),e.jsxs("div",{children:[e.jsx("b",{children:"Location:"})," ",d.location]}),e.jsxs("div",{children:[e.jsx("b",{children:"Remarks:"})," ",d.remarks]}),e.jsxs("div",{children:[e.jsx("b",{children:"Serial Number:"})," ",d.serialNumber]}),e.jsxs("div",{children:[e.jsx("b",{children:"Issued Date:"})," ",d.issuedDate||"NO DATE"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Purchased Date:"})," ",d.purchaseDate||"NO DATE"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Condition:"})," ",d.condition]}),e.jsxs("div",{children:[e.jsx("b",{children:"Status:"})," ",d.status]})]}),rowExpandable:()=>!0}:void 0}),e.jsxs("div",{className:"flex flex-col items-center mt-4 space-y-2",children:[e.jsxs(ns,{className:"w-full text-xs text-center",style:{color:"#072C1C"},children:["Showing ",R.length>0?(f-1)*m+1:0," to ",Math.min(f*m,R.length)," of ",R.length," entries"]}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(Zt,{current:f,pageSize:m,total:R.length,showSizeChanger:!0,size:"small",responsive:!0,pageSizeOptions:["5","10","15","30","50"],onChange:(d,b)=>{k(d),S(b)},className:"text-xs"})})]})]})},{Option:$}=A,{Title:rs}=Fe,ls=({form:u,onFinish:p,loading:r,selectedStockItem:o,isHeadOffice:h,setIsHeadOffice:l,handleSerialChange:n})=>{const[f,k]=s.useState(!1),[m,S]=s.useState(!1),[q,B]=s.useState(""),[R,z]=s.useState(!1),{logUserActivity:N}=Se(),{logUserNotification:w}=Ce();if(!o)return null;const d=G=>{const H=G.target.value;B(H),n&&n(G),H&&!m&&!R&&(k(!0),z(!0)),H===""&&(S(!1),z(!1),u.setFieldsValue({quantity:1}))},b=()=>{S(!0),k(!1)},j=()=>{S(!1),k(!1),u.setFieldsValue({quantity:1})},U=G=>{p(G);const H=(o==null?void 0:o.action)==="redistribute"?"Redistribute Item":"Edit Item";N(H,`${H}: ${G.type} (${G.brand}), Qty: ${G.quantity}`),w(H,`${H}: ${G.type} (${G.brand}), Qty: ${G.quantity}`)};return e.jsxs(e.Fragment,{children:[e.jsx(ve,{open:f,onOk:b,onCancel:j,title:"Serial Number Quantity",okText:"Yes",cancelText:"No",centered:!0,children:"Does the item you want to add have only 1 serial number but has many quantities?"}),e.jsxs(at,{className:"shadow-lg custom-card",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(rs,{level:4,className:"mb-2",children:o.action==="redistribute"?"ðŸ”„ Redistribute Item":"âœï¸ Edit Item"}),e.jsx("p",{className:"text-gray-600 text-sm",children:o.action==="redistribute"?"Create a new item from existing stock":"Update item details and information"})]}),e.jsx(v,{form:u,onFinish:U,layout:"vertical",initialValues:{quantity:1},children:e.jsxs(Ze,{gutter:[32,24],children:[e.jsx(Be,{span:12,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Type"}),name:"type",rules:[{required:!0,message:"Please select the item type!"}],children:e.jsxs(A,{size:"medium",placeholder:"Select item type",children:[e.jsx($,{value:"AVR",children:"AVR"}),e.jsx($,{value:"Battery",children:"Battery"}),e.jsx($,{value:"Biometrics",children:"Biometrics"}),e.jsx($,{value:"Camera",children:"Camera"}),e.jsx($,{value:"CCTV",children:"CCTV"}),e.jsx($,{value:"Charger",children:"Charger"}),e.jsx($,{value:"Guard Tour Chips",children:"Guard Tour Chips"}),e.jsx($,{value:"Guard Tour System",children:"Guard Tour System"}),e.jsx($,{value:"Headset",children:"Headset"}),e.jsx($,{value:"Keyboard",children:"Keyboard"}),e.jsx($,{value:"Laptop",children:"Laptop"}),e.jsx($,{value:"Megaphone",children:"Megaphone"}),e.jsx($,{value:"WIFI-Mesh",children:"WIFI-Mesh"}),e.jsx($,{value:"Metal Detector",children:"Metal Detector"}),e.jsx($,{value:"Microphone",children:"Microphone"}),e.jsx($,{value:"Modem",children:"Modem"}),e.jsx($,{value:"Monitor",children:"Monitor"}),e.jsx($,{value:"Mouse",children:"Mouse"}),e.jsx($,{value:"Others",children:"Others"}),e.jsx($,{value:"Pedestal",children:"Pedestal"}),e.jsx($,{value:"Podium",children:"Podium"}),e.jsx($,{value:"Printer",children:"Printer"}),e.jsx($,{value:"Radio",children:"Radio"}),e.jsx($,{value:"Router",children:"Router"}),e.jsx($,{value:"Search Stick",children:"Search Stick"}),e.jsx($,{value:"Searchlight",children:"Searchlight"}),e.jsx($,{value:"Smartphone",children:"Smartphone"}),e.jsx($,{value:"Speaker",children:"Speaker"}),e.jsx($,{value:"Switch",children:"Switch"}),e.jsx($,{value:"System Unit",children:"System Unit"}),e.jsx($,{value:"Under Chassis",children:"Under Chassis"}),e.jsx($,{value:"UPS",children:"UPS"})]})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Brand"}),name:"brand",rules:[{required:!0,message:"Please input the brand!"}],children:e.jsx(_,{size:"medium",placeholder:"Enter brand name"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Remarks"}),name:"remarks",tooltip:"Optional - Leave empty if there no remarks",children:e.jsx(_.TextArea,{size:"medium",rows:3,placeholder:"Enter any additional remarks"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Serial Number"}),name:"serialNumber",tooltip:"Optional - Leave empty if item has no serial number",children:e.jsx(_,{size:"medium",onChange:d,placeholder:"Enter serial number (optional)"})}),(!q||m||(o==null?void 0:o.action)==="redistribute")&&e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:(o==null?void 0:o.action)==="redistribute"?"New Quantity to Redistribute":"Quantity"}),name:"quantity",rules:[{required:!0,message:"Please input the quantity!"},{validator:(G,H)=>!H||H<1?Promise.reject("Quantity must be at least 1"):(o==null?void 0:o.action)==="redistribute"&&(o!=null&&o.quantity)&&H>=o.quantity?Promise.reject(`Quantity must be less than ${o.quantity}`):Promise.resolve()}],children:e.jsx(_,{size:"medium",type:"number",min:1,max:(o==null?void 0:o.action)==="redistribute"&&(o!=null&&o.quantity)?o.quantity-1:void 0,placeholder:"Enter quantity"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Issued Date"}),name:"issuedDate",tooltip:"Optional - Leave empty if not issued yet",children:e.jsx(ge,{size:"medium",className:"w-full",format:"YYYY-MM-DD",placeholder:"Select issued date"})})]})}),e.jsx(Be,{span:12,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Purchased Date"}),name:"purchaseDate",rules:[{required:!0,message:"Please select the purchase date!"}],children:e.jsx(ge,{size:"medium",className:"w-full",format:"YYYY-MM-DD",placeholder:"Select purchase date"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Condition"}),name:"condition",rules:[{required:!0,message:"Please select the condition!"}],children:e.jsxs(A,{size:"medium",placeholder:"Select condition",children:[e.jsx($,{value:"Brand New",children:"Brand New"}),e.jsx($,{value:"Good Condition",children:"Good Condition"}),e.jsx($,{value:"Defective",children:"Defective"})]})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Detachment/Office"}),name:"locationType",rules:[{required:!0,message:"Please select a location!"}],children:e.jsxs(A,{size:"medium",onChange:G=>l(G==="Head Office"),placeholder:"Select location type",children:[e.jsx($,{value:"Head Office",children:"Head Office"}),e.jsx($,{value:"Other",children:"Other (Specify Below)"})]})}),h&&e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Department (Head Office)"}),name:"department",rules:[{required:!0,message:"Please select a department!"}],children:e.jsxs(A,{size:"medium",placeholder:"Select department",children:[e.jsx($,{value:"SOD",children:"SOD"}),e.jsx($,{value:"CID",children:"CID"}),e.jsx($,{value:"GAD",children:"GAD"}),e.jsx($,{value:"HRD",children:"HRD"}),e.jsx($,{value:"AFD",children:"AFD"}),e.jsx($,{value:"EOD",children:"EOD"}),e.jsx($,{value:"BDO",children:"BDO"})]})}),!h&&e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Specific Location"}),name:"location",rules:[{required:!0,message:"Please input a location!"}],children:e.jsx(_,{size:"medium",placeholder:"Enter specific location"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Status"}),name:"status",rules:[{required:!0,message:"Please select the status!"}],children:e.jsxs(A,{size:"medium",placeholder:"Select status",children:[e.jsx($,{value:"On Stock",children:"On Stock"}),e.jsx($,{value:"Deployed",children:"Deployed"}),e.jsx($,{value:"For Repair",children:"For Repair"})]})}),e.jsx(v.Item,{className:"mb-0",children:e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(J,{type:"primary",htmlType:"submit",icon:o.action==="redistribute"?e.jsx(ct,{}):e.jsx(wt,{}),loading:r,size:"small",style:{backgroundColor:"var(--theme-card-head-bg, #a7f3d0)",border:"none",borderRadius:"6px",padding:"8px",height:"auto",fontSize:"12px",fontWeight:"600",color:"black"},children:o.action==="redistribute"?"Redistribute":"Update Item"})})})]})})]})})]})]})},{Title:os}=Fe,cs=({visible:u,onCancel:p,onSave:r,templateName:o,setTemplateName:h})=>{const{theme:l,currentTheme:n}=Qt(),{logUserActivity:f}=Se(),{logUserNotification:k}=Ce(),S=n==="default"?{headerBg:"#A8E1C5",buttonBg:"#A8E1C5",buttonText:"#072C1C",textColor:"#072C1C",borderColor:"#f0f0f0"}:{headerBg:l.CardHead||l.sider,buttonBg:l.CardHead||l.sider,buttonText:l.text,textColor:l.text,borderColor:l.text},q=()=>{r(),f("Save Template",`Saved template: ${o}`),k("Save Template",`Saved template: ${o}`)};return e.jsx(ve,{title:e.jsxs("div",{className:"text-center",children:[e.jsx(os,{level:4,className:"mb-0 font-semibold",style:{color:S.textColor},children:"Save as Template"}),e.jsx("p",{className:"text-sm mt-1 opacity-75",style:{color:S.textColor},children:"Save this item configuration for future use"})]}),open:u,onCancel:p,footer:[e.jsx(J,{onClick:p,size:"small",style:{background:"transparent",border:`1px solid ${S.borderColor}`,color:S.textColor,borderRadius:"6px",padding:"6px",height:"auto",fontSize:"12px",fontWeight:"600"},children:"Cancel"},"cancel"),e.jsx(J,{type:"primary",onClick:q,icon:e.jsx(Ua,{}),size:"small",style:{background:S.buttonBg,border:"none",borderRadius:"6px",padding:"6px",height:"auto",fontSize:"12px",fontWeight:"600",color:S.buttonText},children:"Save Template"},"save")],className:"template-modal",styles:{header:{borderBottom:`1px solid ${S.borderColor}`,padding:"24px 24px 16px 24px",background:S.headerBg,borderRadius:"12px 12px 0 0"},content:{borderRadius:"12px",overflow:"hidden",background:n==="default"?"#fff":l.componentBackground},body:{padding:"24px"}},children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 mb-6",style:{color:S.textColor},children:"Would you like to save this item as a template for future use?"}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",style:{color:S.textColor},children:"Template Name"}),required:!0,tooltip:"Enter a unique name for this template",children:e.jsx(_,{size:"large",value:o,onChange:B=>h(B.target.value),placeholder:"Enter template name",style:{background:n==="default"?"#fff":l.componentBackground,borderColor:S.borderColor,color:S.textColor}})})]})})},{Title:ds}=Fe,us=({visible:u,onClose:p,onAdd:r,onRedistribute:o,handleEditItem:h,loading:l})=>{const[n]=v.useForm(),[f,k]=s.useState(!1),[m,S]=s.useState(!1),[q,B]=s.useState(!1),[R,z]=s.useState(""),[N,w]=s.useState(null),[d,b]=s.useState([]),[j,U]=s.useState(null),[G,H]=s.useState("new"),[M,C]=s.useState(""),Q=s.useRef(null),{message:x}=We.useApp(),{logUserActivity:y}=Se(),{logUserNotification:E}=Ce(),ue=Ke(),P=Je(),ce=()=>{const a=ue.token&&ue.userData,t=P.token&&P.userData;if(a)return ue.userData;if(t)return P.userData;const c=Ue.get("username"),g=Ue.get("user_id");return c&&g?{username:c,id:g}:null};s.useEffect(()=>{u&&me()},[u]);const me=async()=>{try{const t=(await Ee()).filter(c=>c.status==="On Stock");b(t)}catch(a){console.error("Error fetching on stock items:",a)}},de=a=>{G!=="stock"&&H("stock"),U(a),a.action==="redistribute"?n.setFieldsValue({type:a.type,brand:a.brand,originalQuantity:a.quantity,quantity:1,condition:a.condition,status:a.status,remarks:a.remarks,locationType:a.location.includes("Head Office")?"Head Office":"Other",department:a.location.includes("Head Office")?a.location.split(" - ")[1]:void 0,location:a.location.includes("Head Office")?void 0:a.location,issuedDate:a.issuedDate?te(a.issuedDate):void 0,purchaseDate:a.purchaseDate?te(a.purchaseDate):void 0,serialNumber:a.serialNumber}):n.setFieldsValue({type:a.type,brand:a.brand,quantity:a.quantity,condition:a.condition,status:a.status,remarks:a.remarks,locationType:a.location.includes("Head Office")?"Head Office":"Other",department:a.location.includes("Head Office")?a.location.split(" - ")[1]:void 0,location:a.location.includes("Head Office")?void 0:a.location,issuedDate:a.issuedDate?te(a.issuedDate):void 0,purchaseDate:a.purchaseDate?te(a.purchaseDate):void 0,serialNumber:a.serialNumber}),k(a.location.includes("Head Office")),S(!!a.serialNumber)},he=a=>{a?(n.setFieldsValue({...a,locationType:a.locationType||(a.location.includes("Head Office")?"Head Office":"Other"),department:a.department||(a.location.includes("Head Office")?a.location.split(" - ")[1]:null),location:a.location,purchaseDate:a.purchaseDate?te(a.purchaseDate):void 0,issuedDate:a.issuedDate?te(a.issuedDate):void 0}),k(a.locationType==="Head Office"||a.location.includes("Head Office"))):(n.resetFields(),k(!1))},Ne=async a=>{var t,c,g;try{if(a.purchaseDate&&a.purchaseDate.isAfter(te())){x.error("Purchase date cannot be in the future.");return}const I=await Ee();if(a.serialNumber&&(!j||a.serialNumber!==j.serialNumber)&&I.some(je=>je.serialNumber===a.serialNumber)){x.error("Serial number already exists. Please use a unique serial number.");return}const K=f?`Head Office - ${a.department}`:a.location;if(j)if(j.action==="redistribute"){const Y=I.find(Ie=>Ie.id===j.id);if(!Y){x.error("Item not found in inventory.");return}if(Y.quantity===1){x.warning("Cannot redistribute item with quantity of 1.");return}if(!a.quantity||a.quantity<=0||a.quantity>=Y.quantity){x.error("New quantity must be greater than 0 and less than existing quantity.");return}const je={id:Y.id,newQuantity:a.quantity,newLocation:K,issuedDate:a.issuedDate?a.issuedDate.format("YYYY-MM-DD"):null,condition:a.condition,status:a.status,remarks:((t=a.remarks)==null?void 0:t.trim())||null};await o(je),await me(),U(null),n.resetFields()}else{const Y={id:j.id,type:a.type,brand:a.brand,quantity:a.quantity,serialNumber:a.serialNumber||"",issuedDate:a.issuedDate?a.issuedDate.format("YYYY-MM-DD"):null,purchaseDate:a.purchaseDate?a.purchaseDate.format("YYYY-MM-DD"):null,condition:a.condition,location:K,status:a.status,remarks:a.remarks||""};await h(Y,j),await me(),U(null),n.resetFields()}else{const Y={type:a.type,brand:a.brand,quantity:a.quantity,serialNumber:a.serialNumber,issuedDate:a.issuedDate?a.issuedDate.format("YYYY-MM-DD"):null,purchaseDate:a.purchaseDate?a.purchaseDate.format("YYYY-MM-DD"):null,condition:a.condition,location:K,status:a.status,remarks:a.remarks||null};await r(Y),w(a);const je=(g=(c=Q.current)==null?void 0:c.handleTypeChange)==null?void 0:g.call(c,a.type);je&&!je.isUserTemplate&&B(!0),n.resetFields(),p()}}catch(I){console.error(I),x.error("Failed to save item")}},fe=async()=>{if(!R.trim()){x.error("Please enter a template name");return}const a=ce();if(!a){x.error("User not authenticated");return}const t=N,c={template_name:R,type:t.type,brand:t.brand,condition:t.condition,status:t.status,quantity:t.quantity||1,location:f?`Head Office - ${t.department}`:t.location,remarks:t.remarks||"",serialNumber:t.serialNumber||null,purchaseDate:t.purchaseDate?t.purchaseDate.format("YYYY-MM-DD"):null,issuedDate:t.issuedDate?t.issuedDate.format("YYYY-MM-DD"):null};try{const g=await Ka(c);g.success?(x.success("Template saved successfully!"),B(!1),z(""),Q.current&&Q.current.setRefreshTrigger(I=>I+1),await y(a.username,"Template Created",`Template "${R}" has been created successfully.`),await E("Template Created",`Template "${R}" has been created successfully.`)):x.error(g.message||"Failed to save template")}catch(g){console.error("Error saving template:",g),x.error("Error saving template")}},xe=()=>{n.resetFields(),S(!1),U(null),C(""),H("new"),p()},i=a=>{const t=a.target.value.trim();S(t!==""),t===""&&n.setFieldsValue({quantity:1})},D=a=>{H(a),a==="new"&&(n.resetFields(),U(null),S(!1),k(!1))};return e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"overflow-hidden",title:e.jsxs("div",{className:"text-center",children:[e.jsx(ds,{level:3,className:"mb-0 font-semibold",children:"Inventory Management"}),e.jsx("p",{className:"text-sm mt-1 opacity-75",children:"Add, edit, and manage your inventory items"})]}),open:u,onCancel:xe,footer:null,width:1400,styles:{body:{padding:0},header:{borderBottom:"1px solid #f0f0f0",padding:"24px 24px 16px 24px",background:"var(--theme-card-head-bg, #5fe7a7)",borderRadius:"12px 12px 0 0"},content:{borderRadius:"12px",overflow:"hidden"}},children:e.jsx(Xt,{className:"custom-tabs",activeKey:G,onChange:D,type:"card",tabBarGutter:1,items:[{key:"new",label:e.jsxs("div",{className:"flex items-center",children:[e.jsx(sa,{}),e.jsx("span",{className:"font-medium text-xs",children:"New Item"})]}),children:e.jsx(ss,{form:n,onFinish:Ne,loading:l,templateRef:Q,onTemplateSelect:he,isHeadOffice:f,setIsHeadOffice:k,hasSerialNumber:m,handleSerialChange:i,selectedStockItem:j})},{key:"stock",label:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Nt,{}),e.jsx("span",{className:"font-medium text-xs",children:"On Stock Items"})]}),children:e.jsxs(e.Fragment,{children:[e.jsx(is,{onStockItems:d,searchText:M,setSearchText:C,fetchOnStockItems:me,loading:l,handleStockItemSelect:de}),j&&e.jsx(ls,{form:n,onFinish:Ne,loading:l,selectedStockItem:j,isHeadOffice:f,setIsHeadOffice:k,hasSerialNumber:m,handleSerialChange:i})]})}]})}),e.jsx(cs,{visible:q,onCancel:()=>B(!1),onSave:fe,templateName:R,setTemplateName:z})]})},{Option:V}=A,{Title:hs}=Fe,ms=({visible:u,onClose:p,onEdit:r,item:o})=>{const[h]=v.useForm(),[l,n]=s.useState(!1),[f,k]=s.useState(!1),[m,S]=s.useState(!1),[q,B]=s.useState(!1),[R,z]=s.useState(""),[N,w]=s.useState(""),[d,b]=s.useState(!1),{message:j}=We.useApp(),{logUserActivity:U}=Se(),{logUserNotification:G}=Ce(),H=Ke(),M=Je(),C=()=>{const P=H.token&&H.userData,ce=M.token&&M.userData;if(P)return H.userData;if(ce)return M.userData;const me=Ue.get("username"),de=Ue.get("user_id");return me&&de?{username:me,id:de}:null};s.useEffect(()=>{if(u&&o){const P=o.location.includes("Head Office"),ce=P?o.location.split(" - ")[1]:null;h.setFieldsValue({...o,locationType:P?"Head Office":"Other",department:ce,location:P?null:o.location,purchaseDate:o.purchaseDate&&o.purchaseDate!=="0000-00-00"&&o.purchaseDate!==""?te(o.purchaseDate):void 0,issuedDate:o.issuedDate&&o.issuedDate!=="0000-00-00"&&o.issuedDate!==""?te(o.issuedDate):void 0}),n(P),k(!!o.serialNumber),z(o.serialNumber||""),o.serialNumber&&B(!0)}},[u,o,h]);const Q=async P=>{try{if(P.purchaseDate&&P.purchaseDate.isAfter(te())){j.error("Purchase date cannot be in the future.");return}const ce=await Ee();if(P.serialNumber&&P.serialNumber!==o.serialNumber&&ce.some(fe=>fe.serialNumber===P.serialNumber)){j.error("Serial number already exists. Please use a unique serial number.");return}const me=l?`Head Office - ${P.department}`:P.location,de={...o,type:P.type,brand:P.brand,quantity:Math.max(1,P.quantity||1),serialNumber:P.serialNumber,issuedDate:P.issuedDate?P.issuedDate.format("YYYY-MM-DD"):null,purchaseDate:P.purchaseDate?P.purchaseDate.format("YYYY-MM-DD"):null,condition:P.condition,location:me,status:P.status,remarks:P.remarks||null};r(de);const he=C();he&&(await U(he.username,"Item Updated",`Item "${de.type}" has been updated.`),await G("Item Updated",`Item "${de.type}" has been updated.`))}catch(ce){console.error(ce)}},x=()=>{h.resetFields(),k(!1),S(!1),B(!1),z(""),w(""),b(!1),p()},y=P=>{const ce=P.target.value;z(ce),k(ce!==""),ce&&!q&&!d&&(S(!0),w(ce),b(!0)),ce===""&&(B(!1),w(""),b(!1),h.setFieldsValue({quantity:1}))},E=()=>{B(!0),S(!1)},ue=()=>{B(!1),S(!1),h.setFieldsValue({quantity:1})};return e.jsxs(e.Fragment,{children:[e.jsx(ve,{open:m,onOk:E,onCancel:ue,title:"Serial Number Quantity",okText:"Yes",cancelText:"No",centered:!0,children:"Does the item you want to edit have only 1 serial number but has many quantities?"}),e.jsx(ve,{title:e.jsxs("div",{className:"text-center",children:[e.jsx(hs,{level:3,className:"mb-0 font-semibold",children:"Edit Item"}),e.jsx("p",{className:"text-sm mt-1 opacity-75",children:"Update item details and information"})]}),open:u,onCancel:x,footer:null,width:1e3,className:"custom-card",styles:{body:{padding:0},header:{borderBottom:"1px solid #f0f0f0",padding:"24px 24px 16px 24px",background:"var(--theme-card-head-bg, #5fe7a7)",borderRadius:"12px 12px 0 0"},content:{borderRadius:"12px",overflow:"hidden"}},children:e.jsx("div",{className:"p-8 bg-gray-50",children:e.jsx(at,{className:"shadow-lg border-0",children:e.jsx(v,{form:h,onFinish:Q,layout:"vertical",initialValues:{quantity:1},children:e.jsxs(Ze,{gutter:[32,24],children:[e.jsx(Be,{xs:24,md:12,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Type"}),name:"type",rules:[{required:!0,message:"Please select the item type!"}],children:e.jsxs(A,{size:"medium",placeholder:"Select item type",children:[e.jsx(V,{value:"AVR",children:"AVR"}),e.jsx(V,{value:"Battery",children:"Battery"}),e.jsx(V,{value:"Biometrics",children:"Biometrics"}),e.jsx(V,{value:"Camera",children:"Camera"}),e.jsx(V,{value:"CCTV",children:"CCTV"}),e.jsx(V,{value:"Charger",children:"Charger"}),e.jsx(V,{value:"Guard Tour Chips",children:"Guard Tour Chips"}),e.jsx(V,{value:"Guard Tour System",children:"Guard Tour System"}),e.jsx(V,{value:"Headset",children:"Headset"}),e.jsx(V,{value:"Keyboard",children:"Keyboard"}),e.jsx(V,{value:"Laptop",children:"Laptop"}),e.jsx(V,{value:"Megaphone",children:"Megaphone"}),e.jsx(V,{value:"WIFI-Mesh",children:"WIFI-Mesh"}),e.jsx(V,{value:"Metal Detector",children:"Metal Detector"}),e.jsx(V,{value:"Microphone",children:"Microphone"}),e.jsx(V,{value:"Modem",children:"Modem"}),e.jsx(V,{value:"Monitor",children:"Monitor"}),e.jsx(V,{value:"Mouse",children:"Mouse"}),e.jsx(V,{value:"Others",children:"Others"}),e.jsx(V,{value:"Pedestal",children:"Pedestal"}),e.jsx(V,{value:"Podium",children:"Podium"}),e.jsx(V,{value:"Printer",children:"Printer"}),e.jsx(V,{value:"Radio",children:"Radio"}),e.jsx(V,{value:"Router",children:"Router"}),e.jsx(V,{value:"Search Stick",children:"Search Stick"}),e.jsx(V,{value:"Searchlight",children:"Searchlight"}),e.jsx(V,{value:"Smartphone",children:"Smartphone"}),e.jsx(V,{value:"Speaker",children:"Speaker"}),e.jsx(V,{value:"Switch",children:"Switch"}),e.jsx(V,{value:"System Unit",children:"System Unit"}),e.jsx(V,{value:"Under Chassis",children:"Under Chassis"}),e.jsx(V,{value:"UPS",children:"UPS"})]})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Brand"}),name:"brand",rules:[{required:!0,message:"Please input the brand!"}],children:e.jsx(_,{size:"medium",placeholder:"Enter brand name"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Remarks"}),name:"remarks",tooltip:"Optional - Leave empty if there no remarks",children:e.jsx(_.TextArea,{size:"medium",rows:3,placeholder:"Enter any additional remarks"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Serial Number"}),name:"serialNumber",tooltip:"Optional - Leave empty if item has no serial number",children:e.jsx(_,{size:"medium",onChange:y,placeholder:"Enter serial number (optional)"})}),(!R||q)&&e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Quantity"}),name:"quantity",rules:[{required:!0,message:"Please input the quantity!"},{validator:(P,ce)=>!ce||ce<1?Promise.reject("Quantity must be at least 1"):Promise.resolve()}],children:e.jsx(_,{size:"medium",type:"number",min:1,placeholder:"Enter quantity"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Issued Date"}),name:"issuedDate",tooltip:"Optional - Leave empty if not issued yet",children:e.jsx(ge,{size:"medium",className:"w-full",format:"YYYY-MM-DD",placeholder:"Select issued date"})})]})}),e.jsx(Be,{xs:24,md:12,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Purchased Date"}),name:"purchaseDate",rules:[{required:!0,message:"Please select the purchase date!"}],children:e.jsx(ge,{size:"medium",className:"w-full",format:"YYYY-MM-DD",placeholder:"Select purchase date"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Condition"}),name:"condition",rules:[{required:!0,message:"Please select the condition!"}],children:e.jsxs(A,{size:"medium",placeholder:"Select condition",children:[e.jsx(V,{value:"Brand New",children:"Brand New"}),e.jsx(V,{value:"Good Condition",children:"Good Condition"}),e.jsx(V,{value:"Defective",children:"Defective"})]})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Detachment/Office"}),name:"locationType",rules:[{required:!0,message:"Please select a location!"}],children:e.jsxs(A,{size:"medium",onChange:P=>n(P==="Head Office"),placeholder:"Select location type",children:[e.jsx(V,{value:"Head Office",children:"Head Office"}),e.jsx(V,{value:"Other",children:"Other (Specify Below)"})]})}),l&&e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Department (Head Office)"}),name:"department",rules:[{required:!0,message:"Please select a department!"}],children:e.jsxs(A,{size:"medium",placeholder:"Select department",children:[e.jsx(V,{value:"SOD",children:"SOD"}),e.jsx(V,{value:"CID",children:"CID"}),e.jsx(V,{value:"GAD",children:"GAD"}),e.jsx(V,{value:"HRD",children:"HRD"}),e.jsx(V,{value:"AFD",children:"AFD"}),e.jsx(V,{value:"EOD",children:"EOD"}),e.jsx(V,{value:"BDO",children:"BDO"})]})}),!l&&e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Specific Location"}),name:"location",rules:[{required:!0,message:"Please input a location!"}],children:e.jsx(_,{size:"medium",placeholder:"Enter specific location"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Status"}),name:"status",rules:[{required:!0,message:"Please select the status!"}],children:e.jsxs(A,{size:"medium",placeholder:"Select status",children:[e.jsx(V,{value:"On Stock",children:"On Stock"}),e.jsx(V,{value:"Deployed",children:"Deployed"}),e.jsx(V,{value:"For Repair",children:"For Repair"})]})}),e.jsx(v.Item,{className:"mb-0",children:e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(J,{type:"primary",htmlType:"submit",icon:e.jsx(wt,{}),size:"small",style:{background:"var(--theme-card-head-bg, #5fe7a7)",border:"none",borderRadius:"6px",padding:"6px",height:"auto",fontSize:"12px",fontWeight:"600",color:"black"},children:"Update Item"})})})]})})]})})})})})]})},{Option:we}=A,{Title:xs}=Fe,ps=({visible:u,onClose:p,item:r,onEdit:o,isLoading:h})=>{const[l]=v.useForm(),[n,f]=s.useState(!1),{logUserActivity:k}=Se(),{logUserNotification:m}=Ce(),S=Ke(),q=Je(),B=()=>{const N=S.token&&S.userData,w=q.token&&q.userData;if(N)return S.userData;if(w)return q.userData;const d=Ue.get("username"),b=Ue.get("user_id");return d&&b?{username:d,id:b}:null};s.useEffect(()=>{var N;if(u&&r){const w=(N=r.location)==null?void 0:N.includes("Head Office");f(w);let d="Other",b,j;if(w){d="Head Office";const U=r.location.split(" - ");U.length>1&&(b=U[1])}else j=r.location;l.setFieldsValue({type:r.type,brand:r.brand,originalQuantity:r.quantity,quantity:1,condition:r.condition,status:r.status,remarks:r.remarks,locationType:d,department:b,location:j,issuedDate:r.issuedDate?te(r.issuedDate):void 0})}},[u,r,l]);const R=async N=>{var w;try{if(!r)return;const b=(await Ee()).find(M=>M.id===r.id);if(!b){rt.error("Item not found in inventory.");return}if(b.quantity===1){rt.warning("Cannot redistribute item with quantity of 1.");return}if(!N.quantity||N.quantity<=0||N.quantity>=b.quantity){rt.error("New quantity must be greater than 0 and less than existing quantity.");return}const j=N.locationType==="Head Office"?`Head Office - ${N.department}`:N.location,U=N.issuedDate?te(N.issuedDate).format("YYYY-MM-DD"):null,G={id:b.id,newQuantity:N.quantity,newLocation:j,issuedDate:U,condition:N.condition,status:N.status,remarks:((w=N.remarks)==null?void 0:w.trim())||null};await o(G);const H=B();H&&(await k(H.username,"Item Redistributed",`Item "${b.type}" has been redistributed to ${j} with quantity ${N.quantity}.`),await m("Item Redistributed",`Item "${b.type}" has been redistributed to ${j} with quantity ${N.quantity}.`)),l.resetFields(),p()}catch(d){console.error(d),rt.error("Failed to redistribute item.")}},z=()=>{l.resetFields(),f(!1),p()};return e.jsx(ve,{title:e.jsxs("div",{className:"text-center",children:[e.jsx(xs,{level:3,className:"mb-0 font-semibold",children:"Redistribute Item"}),e.jsx("p",{className:"text-sm mt-1 opacity-75",children:"Create a new item from existing stock"})]}),open:u,onCancel:z,footer:null,width:1e3,className:"custom-card",styles:{body:{padding:0},header:{borderBottom:"1px solid #f0f0f0",padding:"24px 24px 16px 24px",background:"var(--theme-card-head-bg, #5fe7a7)",borderRadius:"12px 12px 0 0"},content:{borderRadius:"12px",overflow:"hidden"}},children:e.jsx("div",{className:"p-8 bg-gray-50",children:e.jsx(at,{className:"shadow-lg border-0",children:e.jsx(v,{form:l,onFinish:R,layout:"vertical",children:e.jsxs(Ze,{gutter:[32,24],children:[e.jsx(Be,{xs:24,md:12,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Type"}),name:"type",rules:[{required:!0,message:"Type is required"}],children:e.jsx(_,{disabled:!0,size:"medium"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Brand"}),name:"brand",rules:[{required:!0,message:"Brand is required"}],children:e.jsx(_,{disabled:!0,size:"medium"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Original Quantity"}),name:"originalQuantity",rules:[{required:!0,message:"Original quantity is required"}],children:e.jsx(_,{disabled:!0,size:"medium"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"New Quantity to Redistribute"}),name:"quantity",rules:[{required:!0,message:"Please input the quantity to redistribute"},{validator:(N,w)=>!w||w<1?Promise.reject("Quantity must be at least 1"):w>=(r==null?void 0:r.quantity)?Promise.reject(`Quantity must be less than ${r==null?void 0:r.quantity}`):Promise.resolve()}],children:e.jsx(_,{size:"medium",type:"number",min:1,max:r!=null&&r.quantity?r.quantity-1:1,placeholder:"Enter quantity"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Remarks"}),name:"remarks",children:e.jsx(_.TextArea,{size:"medium",rows:3,placeholder:"Enter remarks (optional)"})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Issued Date"}),name:"issuedDate",children:e.jsx(ge,{size:"medium",format:"YYYY-MM-DD",className:"w-full",placeholder:"Select date"})})]})}),e.jsx(Be,{xs:24,md:12,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Condition"}),name:"condition",rules:[{required:!0,message:"Please select the condition"}],children:e.jsxs(A,{size:"medium",placeholder:"Select condition",children:[e.jsx(we,{value:"Brand New",children:"Brand New"}),e.jsx(we,{value:"Good Condition",children:"Good Condition"}),e.jsx(we,{value:"Defective",children:"Defective"})]})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Status"}),name:"status",rules:[{required:!0,message:"Please select the status"}],children:e.jsxs(A,{size:"medium",placeholder:"Select status",children:[e.jsx(we,{value:"On Stock",children:"On Stock"}),e.jsx(we,{value:"Deployed",children:"Deployed"}),e.jsx(we,{value:"For Repair",children:"For Repair"})]})}),e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Location Type"}),name:"locationType",rules:[{required:!0,message:"Please select a location type"}],children:e.jsxs(A,{size:"medium",placeholder:"Select location type",onChange:N=>f(N==="Head Office"),children:[e.jsx(we,{value:"Head Office",children:"Head Office"}),e.jsx(we,{value:"Other",children:"Other (Specify)"})]})}),n?e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Department (Head Office)"}),name:"department",rules:[{required:!0,message:"Please select a department"}],children:e.jsxs(A,{size:"medium",placeholder:"Select department",children:[e.jsx(we,{value:"SOD",children:"SOD"}),e.jsx(we,{value:"CID",children:"CID"}),e.jsx(we,{value:"GAD",children:"GAD"}),e.jsx(we,{value:"HRD",children:"HRD"}),e.jsx(we,{value:"AFD",children:"AFD"}),e.jsx(we,{value:"EOD",children:"EOD"}),e.jsx(we,{value:"BDO",children:"BDO"})]})}):e.jsx(v.Item,{label:e.jsx("span",{className:"font-semibold",children:"Specific Location"}),name:"location",rules:[{required:!0,message:"Please input a specific location"}],children:e.jsx(_,{size:"medium",placeholder:"Enter location"})}),e.jsx(v.Item,{className:"mb-0",children:e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(J,{type:"primary",htmlType:"submit",icon:e.jsx(ct,{}),loading:h,disabled:h,size:"small",style:{background:"var(--theme-card-head-bg, #5fe7a7)",border:"none",borderRadius:"6px",padding:"6px",height:"auto",fontSize:"12px",fontWeight:"600",color:"black"},children:"Redistribute"})})})]})})]})})})})})},{Option:Re}=A,Ht=["SOD","CID","GAD","HRD","AFD","EOD","BDO"],fs=()=>`row-${Date.now()}-${Math.random().toString(36).slice(2,11)}`,vt=()=>({uid:fs(),type:"",brand:"",quantity:1,remarks:"",serialNumber:"",issuedDate:"",purchaseDate:"",condition:"",locationType:"Head Office",department:"SOD",location:"",status:"",showQuantityWithSerial:!1}),Ft=["AVR","Battery","Biometrics","Camera","CCTV","Charger","Guard Tour Chips","Guard Tour System","Headset","Keyboard","Laptop","Megaphone","WIFI-Mesh","Metal Detector","Microphone","Modem","Monitor","Mouse","Others","Pedestal","Podium","Printer","Radio","Router","Search Stick","Searchlight","Smartphone","Speaker","Switch","System Unit","Under Chassis","UPS"],$t=["Brand New","Good Condition","Defective"],Vt=["On Stock","For Repair","Deployed"];function ys({visible:u,onClose:p,onBatchAdd:r,loading:o}){const{message:h}=We.useApp(),[l,n]=s.useState([vt()]),[f,k]=s.useState(1),[m,S]=s.useState(!1),[q,B]=s.useState([]),[R,z]=s.useState(null),[N,w]=s.useState(!1),[d,b]=s.useState([]),[j,U]=s.useState({type:"",condition:"",status:"",locationType:"Head Office",department:"SOD",location:"",purchaseDate:"",issuedDate:""}),{logUserActivity:G}=Se(),{logUserNotification:H}=Ce();s.useEffect(()=>{u&&M()},[u]);const M=async()=>{try{const t=await Ee();B(t.map(c=>c.serialNumber).filter(Boolean))}catch{B([])}},C=(t,c,g)=>{n(I=>I.map((K,Y)=>Y!==t?K:c==="serialNumber"?(g&&!K.showQuantityWithSerial&&K.serialNumber===""&&z(t),g===""?{...K,serialNumber:"",showQuantityWithSerial:!1,quantity:1}:{...K,serialNumber:g}):{...K,[c]:g}))},Q=()=>{R!==null&&(n(t=>t.map((c,g)=>g===R?{...c,showQuantityWithSerial:!0}:c)),z(null))},x=()=>{R!==null&&(n(t=>t.map((c,g)=>g===R?{...c,showQuantityWithSerial:!1,quantity:1}:c)),z(null))},y=(t,c,g)=>{n(I=>I.map((K,Y)=>Y===t?{...K,[c]:g?te(g).format("YYYY-MM-DD"):""}:K))},E=()=>{n(t=>[...t,...Array.from({length:Math.max(1,Math.min(f,100))},()=>vt())]),k(1)},ue=t=>n(c=>c.length>1?c.filter((g,I)=>I!==t):c),P=t=>!(!t.type||!t.brand||t.quantity<=0||!t.condition||!t.status||!t.locationType||!t.purchaseDate||t.locationType==="Head Office"&&!t.department||t.locationType==="Other"&&!t.location),ce=t=>t.locationType==="Head Office"?`Head Office - ${t.department}`:t.locationType==="Other"?t.location:"",me=()=>n([vt()]),de=async()=>{S(!0);let t=!0;const c=te().startOf("day");for(const Y of l){if(!P(Y)){t=!1;break}if(Y.purchaseDate&&te(Y.purchaseDate).isAfter(c,"day")){h.error("Purchase date cannot be in the future."),S(!1);return}}if(!t){h.error("Please fill all required fields for each item."),S(!1);return}const g=l.map(Y=>Y.serialNumber).filter(Boolean),I=new Set;for(const Y of g){if(I.has(Y)){h.error(`Duplicate serial number in batch: ${Y}`),S(!1);return}if(I.add(Y),q.includes(Y)){h.error(`Serial number already exists: ${Y}`),S(!1);return}}const K=l.map(Y=>{let je=Y.purchaseDate?te(Y.purchaseDate).format("YYYY-MM-DD"):"",Ie=Y.issuedDate?te(Y.issuedDate).format("YYYY-MM-DD"):"";return{type:Y.type,brand:Y.brand,quantity:Y.serialNumber&&!Y.showQuantityWithSerial?1:Math.max(1,Y.quantity||1),serialNumber:Y.serialNumber||"",issuedDate:Ie,purchaseDate:je,condition:Y.condition,location:ce(Y),status:Y.status,remarks:Y.remarks||""}});try{await r(K),h.success(`${K.length} item(s) added successfully!`),G("Batch Add",`Added ${K.length} item(s) to inventory.`),H("Batch Add",`Added ${K.length} item(s) to inventory.`),me(),S(!1),p()}catch{h.error("Failed to add items."),S(!1)}},he=()=>{me(),p()},Ne=()=>{if(d.length===0){h.warning("Please select at least one row to apply batch operations.");return}w(!0)},fe=()=>{const t=l.map(c=>{if(d.includes(c.uid)){const g={...c};return j.type&&(g.type=j.type),j.condition&&(g.condition=j.condition),j.status&&(g.status=j.status),j.locationType&&(g.locationType=j.locationType,j.locationType==="Head Office"&&j.department?g.department=j.department:j.locationType==="Other"&&j.location&&(g.location=j.location)),j.purchaseDate&&(g.purchaseDate=j.purchaseDate),j.issuedDate&&(g.issuedDate=j.issuedDate),g}return c});n(t),w(!1),b([]),h.success(`Applied batch values to ${d.length} item(s)`)},xe=()=>{d.length===l.length?b([]):b(l.map(t=>t.uid))},i=()=>{n(t=>t.length>1?t.filter(c=>!d.includes(c.uid)):t),b([])},D={selectedRowKeys:d,onChange:t=>b(t),getCheckboxProps:t=>({disabled:!1})},a=[{title:"Type",dataIndex:"type",className:"text-xs",render:(t,c,g)=>e.jsx(A,{value:t,onChange:I=>C(g,"type",I),style:{minWidth:170},size:"small",className:"text-xs",children:Ft.map(I=>e.jsx(Re,{value:I,children:e.jsx("span",{className:"text-xs",children:I})},I))})},{title:"Brand",dataIndex:"brand",className:"text-xs",render:(t,c,g)=>e.jsx(_,{className:"text-xs",value:t,onChange:I=>C(g,"brand",I.target.value),size:"small",placeholder:"Enter brand name"})},{title:"Serial Number",dataIndex:"serialNumber",className:"text-xs",render:(t,c,g)=>e.jsx(_,{className:"text-xs",value:t,onChange:I=>C(g,"serialNumber",I.target.value),size:"small",placeholder:"Enter serial number"})},{title:"Qty",dataIndex:"quantity",className:"text-xs",render:(t,c,g)=>e.jsx(_,{type:"number",min:1,value:c.quantity,onChange:I=>C(g,"quantity",Number(I.target.value)),size:"small",style:{width:60},disabled:c.serialNumber&&!c.showQuantityWithSerial,className:"text-xs"})},{title:"Remarks",dataIndex:"remarks",className:"text-xs",render:(t,c,g)=>e.jsx(_.TextArea,{value:t,onChange:I=>C(g,"remarks",I.target.value),size:"small",rows:3,placeholder:"Enter any additional remarks",className:"text-xs"})},{title:"Issued Date",dataIndex:"issuedDate",className:"text-xs",render:(t,c,g)=>e.jsx(ge,{value:t?te(t,"YYYY-MM-DD"):null,onChange:I=>y(g,"issuedDate",I),format:"YYYY-MM-DD",size:"small",style:{width:120},allowClear:!0,className:"text-xs"})},{title:"Purchased Date",dataIndex:"purchaseDate",className:"text-xs",render:(t,c,g)=>e.jsx(ge,{value:t?te(t,"YYYY-MM-DD"):null,onChange:I=>y(g,"purchaseDate",I),format:"YYYY-MM-DD",size:"small",style:{width:120},allowClear:!0,className:"text-xs"})},{title:"Condition",dataIndex:"condition",className:"text-xs",render:(t,c,g)=>e.jsx(A,{value:t,onChange:I=>C(g,"condition",I),style:{minWidth:150},size:"small",className:"text-xs",children:$t.map(I=>e.jsx(Re,{value:I,children:e.jsx("span",{className:"text-xs",children:I})},I))})},{title:"Detachment/Office",dataIndex:"locationType",className:"text-xs",render:(t,c,g)=>e.jsxs("div",{style:{minWidth:200},children:[e.jsxs(A,{value:t,onChange:I=>C(g,"locationType",I),size:"small",placeholder:"Select location type",style:{width:150,marginBottom:4},className:"text-xs",children:[e.jsxs(Re,{value:"Head Office",children:[" ",e.jsx("span",{className:"text-xs",children:"Head Office"})]}),e.jsx(Re,{value:"Other",children:e.jsx("span",{className:"text-xs",children:"Other (Specify Below)"})})]}),c.locationType==="Head Office"&&e.jsx(A,{value:c.department,onChange:I=>C(g,"department",I),size:"small",placeholder:"Select department",style:{width:150,marginTop:4},className:"text-xs",children:Ht.map(I=>e.jsx(Re,{value:I,children:e.jsx("span",{className:"text-xs",children:I})},I))}),c.locationType==="Other"&&e.jsx(_,{value:c.location,onChange:I=>C(g,"location",I.target.value),size:"small",placeholder:"Enter specific location",style:{width:140,marginTop:4},className:"text-xs"})]})},{title:"Status",dataIndex:"status",className:"text-xs",render:(t,c,g)=>e.jsx(A,{value:t,onChange:I=>C(g,"status",I),style:{minWidth:100},size:"small",className:"text-xs",children:Vt.map(I=>e.jsx(Re,{value:I,children:e.jsx("span",{className:"text-xs",children:I})},I))})},{title:"Action",dataIndex:"action",className:"text-xs",render:(t,c,g)=>e.jsx(J,{danger:!0,className:"text-xs",size:"small",onClick:()=>ue(g),disabled:l.length===1,children:"Remove"})}];return e.jsxs(e.Fragment,{children:[e.jsx(ve,{open:R!==null,onOk:Q,onCancel:x,title:"Serial Number Quantity",okText:"Yes",cancelText:"No",centered:!0,children:"Does the item you want to add have only 1 serial number but has many quantities?"}),e.jsx(ve,{open:N,title:"Batch Apply Values",onCancel:()=>w(!1),onOk:fe,okText:"Apply to Selected",width:600,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:" text-gray-600 mb-4",children:["Apply the following values to ",d.length," selected item(s):"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-1",children:"Type"}),e.jsx(A,{value:j.type,onChange:t=>U(c=>({...c,type:t})),placeholder:"Select type",allowClear:!0,style:{width:"100%"},children:Ft.map(t=>e.jsx(Re,{value:t,children:t},t))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block  font-medium mb-1",children:"Condition"}),e.jsx(A,{value:j.condition,onChange:t=>U(c=>({...c,condition:t})),placeholder:"Select condition",allowClear:!0,style:{width:"100%"},children:$t.map(t=>e.jsx(Re,{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block  font-medium mb-1",children:"Status"}),e.jsx(A,{value:j.status,onChange:t=>U(c=>({...c,status:t})),placeholder:"Select status",allowClear:!0,style:{width:"100%"},children:Vt.map(t=>e.jsx(Re,{value:t,children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-1",children:"Location Type"}),e.jsxs(A,{value:j.locationType,onChange:t=>U(c=>({...c,locationType:t})),placeholder:"Select location type",style:{width:"100%"},children:[e.jsx(Re,{value:"Head Office",children:"Head Office"}),e.jsx(Re,{value:"Other",children:"Other (Specify Below)"})]})]}),j.locationType==="Head Office"&&e.jsxs("div",{children:[e.jsx("label",{className:"block  font-medium mb-1",children:"Department"}),e.jsx(A,{value:j.department,onChange:t=>U(c=>({...c,department:t})),placeholder:"Select department",style:{width:"100%"},children:Ht.map(t=>e.jsx(Re,{value:t,children:t},t))})]}),j.locationType==="Other"&&e.jsxs("div",{children:[e.jsx("label",{className:"block  font-medium mb-1",children:"Location"}),e.jsx(_,{value:j.location,onChange:t=>U(c=>({...c,location:t.target.value})),placeholder:"Enter specific location"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block  font-medium mb-1",children:"Purchase Date"}),e.jsx(ge,{value:j.purchaseDate?te(j.purchaseDate):null,onChange:t=>U(c=>({...c,purchaseDate:t?te(t).format("YYYY-MM-DD"):""})),format:"YYYY-MM-DD",style:{width:"100%"},allowClear:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block  font-medium mb-1",children:"Issued Date"}),e.jsx(ge,{value:j.issuedDate?te(j.issuedDate):null,onChange:t=>U(c=>({...c,issuedDate:t?te(t).format("YYYY-MM-DD"):""})),format:"YYYY-MM-DD",style:{width:"100%"},allowClear:!0})]})]})]})}),e.jsxs(ve,{open:u,title:"Batch Add Items",onCancel:he,onOk:de,okText:"Submit All",confirmLoading:m||o,width:1500,footer:[e.jsxs("span",{className:"flex flex-col justify-end sm:flex-row gap-2",children:[e.jsx(ga,{min:1,max:100,value:f,onChange:k,size:"small",style:{width:60},disabled:m||o}),e.jsxs(J,{size:"small",onClick:E,className:"custom-button text-xs",disabled:m||o,children:["Add Row",f>1?`s (${f})`:""]}),e.jsxs(J,{size:"small",danger:!0,onClick:i,className:"text-xs",disabled:m||o||d.length===0,children:["Remove Selected (",d.length,")"]},"remove-selected"),e.jsxs(J,{size:"small",onClick:Ne,className:"custom-button text-xs",disabled:m||o||d.length===0,children:["Batch Apply (",d.length,")"]},"batch"),e.jsx(J,{size:"small",onClick:he,className:"custom-button-cancel text-xs",disabled:m||o,children:"Cancel"},"cancel"),e.jsx(J,{size:"small",type:"primary",className:"custom-button text-xs",onClick:de,loading:m||o,children:"Submit All"},"submit")]},"add-row-group")],children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:" text-blue-800",children:[e.jsx("strong",{children:"Smart Batch Operations:"}),' Select rows and use "Batch Apply" to set common values for multiple items at once.']}),e.jsxs(ea,{checked:d.length===l.length&&l.length>0,indeterminate:d.length>0&&d.length<l.length,onChange:xe,className:"text-xs",children:["Select All (",d.length,"/",l.length,")"]})]})}),e.jsx(Le,{bordered:!0,dataSource:l,columns:a,rowKey:t=>t.uid,pagination:!1,size:"small",scroll:{x:"max-content",y:600},responsive:["sm","md","lg","xl","xxl"],rowSelection:D,rowClassName:t=>d.includes(t.uid)?"bg-blue-50":""}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"* Required fields: Type, Brand, Qty, Purchased Date, Condition, Status, Detachment/Office"})]})]})}const{Option:qe}=A,Ut=["SOD","CID","GAD","HRD","AFD","EOD","BDO"],bs=["AVR","Battery","Biometrics","Camera","CCTV","Charger","Guard Tour Chips","Guard Tour System","Headset","Keyboard","Laptop","Megaphone","WIFI-Mesh","Metal Detector","Microphone","Modem","Monitor","Mouse","Others","Pedestal","Podium","Printer","Radio","Router","Search Stick","Searchlight","Smartphone","Speaker","Switch","System Unit","Under Chassis","UPS"],Lt=["Brand New","Good Condition","Defective"],Gt=["On Stock","For Repair","Deployed"];function js({visible:u,onClose:p,onBatchEdit:r,loading:o,selectedItems:h}){const{message:l}=We.useApp(),[n,f]=s.useState([]),[k,m]=s.useState([]),[S,q]=s.useState(!1),[B,R]=s.useState(null),[z,N]=s.useState(!1),[w,d]=s.useState([]),[b,j]=s.useState({condition:"",status:"",locationType:"Head Office",department:"SOD",location:"",purchaseDate:"",issuedDate:""}),{logUserActivity:U}=Se(),{logUserNotification:G}=Ce();s.useEffect(()=>{if(u){const i=h.map(D=>{let a="",t="",c="";return D.location&&D.location.startsWith("Head Office - ")?(a="Head Office",t=D.location.replace("Head Office - ",""),c=""):(a="Other",t="",c=D.location||""),{...D,locationType:a,department:t,location:c,showQuantityWithSerial:!!D.serialNumber,lastSerialModalValue:"",serialModalShownForCurrentInput:!1}});f(i),m(JSON.parse(JSON.stringify(i)))}},[u,h]);const H=(i,D)=>{const a=["type","brand","serialNumber","quantity","remarks","issuedDate","purchaseDate","condition","status","locationType","department","location"];for(const t of a){const c=i[t],g=D[t];if(t==="issuedDate"||t==="purchaseDate"){if((c&&c!=="0000-00-00"?c:"")!==(g&&g!=="0000-00-00"?g:""))return!0}else if(c!==g)return!0}return!1},M=()=>n.filter((i,D)=>H(i,k[D])),C=(i,D,a)=>{f(t=>t.map((c,g)=>g!==i?c:D==="serialNumber"?a&&!c.showQuantityWithSerial&&!c.serialModalShownForCurrentInput?(R(i),{...c,serialNumber:a,lastSerialModalValue:a,serialModalShownForCurrentInput:!0}):a===""?{...c,serialNumber:"",showQuantityWithSerial:!1,quantity:1,lastSerialModalValue:"",serialModalShownForCurrentInput:!1}:{...c,serialNumber:a}:{...c,[D]:a}))},Q=()=>{B!==null&&(f(i=>i.map((D,a)=>a===B?{...D,showQuantityWithSerial:!0}:D)),R(null))},x=()=>{B!==null&&(f(i=>i.map((D,a)=>a===B?{...D,showQuantityWithSerial:!1,quantity:1}:D)),R(null))},y=(i,D,a)=>{f(t=>t.map((c,g)=>g===i?{...c,[D]:a?te(a).format("YYYY-MM-DD"):""}:c))},E=i=>!(!i.type||!i.brand||i.quantity<=0||!i.condition||!i.status||!i.locationType||i.locationType==="Head Office"&&!i.department||i.locationType==="Other"&&!i.location),ue=i=>i.locationType==="Head Office"?`Head Office - ${i.department}`:i.locationType==="Other"?i.location:"",P=async()=>{q(!0);const i=M(),D=n.length-i.length;if(i.length===0){l.warning("No changes detected. All items remain unchanged."),q(!1);return}D>0&&l.info(`${D} item(s) had no changes and were not updated.`);let a=!0;for(const c of i)if(!E(c)){a=!1;break}if(!a){l.error("Please fill all required fields for each changed item."),q(!1);return}const t=i.map(c=>{const g={...c,location:ue(c),quantity:c.serialNumber&&!c.showQuantityWithSerial?1:c.quantity};return delete g.locationType,delete g.department,delete g.showQuantityWithSerial,g});try{await r(t),l.success(`${t.length} item(s) updated successfully!`),U("Batch Edit",`Edited ${t.length} item(s) in inventory.`),G("Batch Edit",`Edited ${t.length} item(s) in inventory.`),p()}catch{l.error("Failed to update some items.")}finally{q(!1)}},ce=[{title:"ID",dataIndex:"id",width:120,className:"text-xs",render:(i,D,a)=>e.jsxs("div",{children:[e.jsx("div",{children:i}),H(D,k[a])&&e.jsx(He,{color:"blue",size:"small",children:"Modified"})]})},{title:"Type",dataIndex:"type",className:"text-xs",render:(i,D,a)=>e.jsx(A,{value:i,onChange:t=>C(a,"type",t),style:{minWidth:170},size:"small",className:"text-xs",children:bs.map(t=>e.jsx(qe,{value:t,children:e.jsx("span",{className:"text-xs",children:t})},t))})},{title:"Brand",dataIndex:"brand",className:"text-xs",render:(i,D,a)=>e.jsx(_,{value:i,className:"text-xs",onChange:t=>C(a,"brand",t.target.value),size:"small",placeholder:"Enter brand name"})},{title:"Serial Number",dataIndex:"serialNumber",className:"text-xs",render:(i,D,a)=>e.jsx(_,{value:i,className:"text-xs",onChange:t=>C(a,"serialNumber",t.target.value),size:"small",placeholder:"Enter serial number"})},{title:"Qty",dataIndex:"quantity",className:"text-xs",render:(i,D,a)=>e.jsx(_,{type:"number",min:1,value:D.quantity,onChange:t=>C(a,"quantity",Number(t.target.value)),size:"small",style:{width:60},className:"text-xs",disabled:D.serialNumber&&!D.showQuantityWithSerial})},{title:"Remarks",dataIndex:"remarks",className:"text-xs",render:(i,D,a)=>e.jsx(_.TextArea,{value:i,onChange:t=>C(a,"remarks",t.target.value),size:"small",rows:3,className:"text-xs",placeholder:"Enter any additional remarks"})},{title:"Issued Date",dataIndex:"issuedDate",className:"text-xs",render:(i,D,a)=>e.jsx(ge,{value:i&&i!=="0000-00-00"&&i!==""?te(i,"YYYY-MM-DD"):null,onChange:t=>y(a,"issuedDate",t),format:"YYYY-MM-DD",size:"small",className:"text-xs",style:{width:120},allowClear:!0})},{title:"Purchased Date",dataIndex:"purchaseDate",className:"text-xs",render:(i,D,a)=>e.jsx(ge,{value:i&&i!=="0000-00-00"&&i!==""?te(i,"YYYY-MM-DD"):null,onChange:t=>y(a,"purchaseDate",t),format:"YYYY-MM-DD",size:"small",style:{width:120},allowClear:!0,className:"text-xs"})},{title:"Condition",dataIndex:"condition",className:"text-xs",render:(i,D,a)=>e.jsx(A,{value:i,onChange:t=>C(a,"condition",t),style:{minWidth:150},size:"small",className:"text-xs",children:Lt.map(t=>e.jsx(qe,{value:t,children:e.jsx("span",{className:"text-xs",children:t})},t))})},{title:"Detachment/Office",dataIndex:"locationType",className:"text-xs",render:(i,D,a)=>e.jsxs("div",{style:{minWidth:200},children:[e.jsxs(A,{value:i,onChange:t=>C(a,"locationType",t),size:"small",placeholder:"Select location type",className:"text-xs",style:{width:150,marginBottom:4},children:[e.jsx(qe,{value:"Head Office",children:e.jsx("span",{className:"text-xs",children:"Head Office"})}),e.jsx(qe,{value:"Other",children:e.jsx("span",{className:"text-xs",children:"Other (Specify Below)"})})]}),D.locationType==="Head Office"&&e.jsx(A,{value:D.department,onChange:t=>C(a,"department",t),size:"small",placeholder:"Select department",style:{width:150,marginTop:4},children:Ut.map(t=>e.jsx(qe,{value:t,children:e.jsx("span",{className:"text-xs",children:t})},t))}),D.locationType==="Other"&&e.jsx(_,{value:D.location,onChange:t=>C(a,"location",t.target.value),size:"small",placeholder:"Enter specific location",style:{width:140,marginTop:4},className:"text-xs"})]})},{title:"Status",dataIndex:"status",render:(i,D,a)=>e.jsx(A,{value:i,onChange:t=>C(a,"status",t),style:{minWidth:100},size:"small",children:Gt.map(t=>e.jsx(qe,{value:t,children:e.jsx("span",{className:"text-xs",children:t})},t))})}],me=()=>{if(w.length===0){l.warning("Please select at least one row to apply batch operations.");return}N(!0)},de=()=>{const i=n.map(D=>{if(w.includes(D.id)){const a={...D};return b.condition&&(a.condition=b.condition),b.status&&(a.status=b.status),b.locationType&&(a.locationType=b.locationType,b.locationType==="Head Office"&&b.department?a.department=b.department:b.locationType==="Other"&&b.location&&(a.location=b.location)),b.purchaseDate&&(a.purchaseDate=b.purchaseDate),b.issuedDate&&(a.issuedDate=b.issuedDate),a}return D});f(i),N(!1),d([]),l.success(`Applied batch values to ${w.length} item(s)`)},he=()=>{w.length===n.length?d([]):d(n.map(i=>i.id))},Ne={selectedRowKeys:w,onChange:i=>d(i),getCheckboxProps:i=>({disabled:!1})},fe=M().length,xe=n.length;return e.jsxs(e.Fragment,{children:[e.jsx(ve,{open:B!==null,onOk:Q,onCancel:x,title:"Serial Number Quantity",okText:"Yes",cancelText:"No",centered:!0,children:"Does the item you want to edit have only 1 serial number but has many quantities?"}),e.jsx(ve,{open:z,title:"Batch Apply Values",onCancel:()=>N(!1),onOk:de,okText:"Apply to Selected",width:600,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:["Apply the following values to ",w.length," selected item(s):"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Condition"}),e.jsx(A,{value:b.condition,onChange:i=>j(D=>({...D,condition:i})),placeholder:"Select condition",allowClear:!0,style:{width:"100%"},children:Lt.map(i=>e.jsx(qe,{value:i,children:i},i))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsx(A,{value:b.status,onChange:i=>j(D=>({...D,status:i})),placeholder:"Select status",allowClear:!0,style:{width:"100%"},children:Gt.map(i=>e.jsx(qe,{value:i,children:i},i))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Location Type"}),e.jsxs(A,{value:b.locationType,onChange:i=>j(D=>({...D,locationType:i})),placeholder:"Select location type",style:{width:"100%"},children:[e.jsx(qe,{value:"Head Office",children:"Head Office"}),e.jsx(qe,{value:"Other",children:"Other (Specify Below)"})]})]}),b.locationType==="Head Office"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Department"}),e.jsx(A,{value:b.department,onChange:i=>j(D=>({...D,department:i})),placeholder:"Select department",style:{width:"100%"},children:Ut.map(i=>e.jsx(qe,{value:i,children:i},i))})]}),b.locationType==="Other"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Location"}),e.jsx(_,{value:b.location,onChange:i=>j(D=>({...D,location:i.target.value})),placeholder:"Enter specific location"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Purchase Date"}),e.jsx(ge,{value:b.purchaseDate?te(b.purchaseDate):null,onChange:i=>j(D=>({...D,purchaseDate:i?te(i).format("YYYY-MM-DD"):""})),format:"YYYY-MM-DD",style:{width:"100%"},allowClear:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Issued Date"}),e.jsx(ge,{value:b.issuedDate?te(b.issuedDate):null,onChange:i=>j(D=>({...D,issuedDate:i?te(i).format("YYYY-MM-DD"):""})),format:"YYYY-MM-DD",style:{width:"100%"},allowClear:!0})]})]})]})}),e.jsxs(ve,{open:u,title:"Batch Edit Items",onCancel:p,onOk:P,okText:"Submit All",confirmLoading:S||o,width:1500,footer:[e.jsxs(J,{size:"small",onClick:me,className:"custom-button text-xs",disabled:S||o||w.length===0,children:["Batch Apply (",w.length,")"]},"batch"),e.jsx(J,{size:"small",onClick:p,className:"custom-button-cancel text-xs",disabled:S||o,children:"Cancel"},"cancel"),e.jsxs(J,{size:"small",type:"primary",className:"custom-button text-xs",onClick:P,loading:S||o,children:["Submit ",fe>0?`(${fe}/${xe})`:""]},"submit")],children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Change Detection:"})," ",fe," of ",xe," items have changes.",fe===0&&" No changes detected - only modified items will be submitted."]}),e.jsxs(ea,{checked:w.length===n.length&&n.length>0,indeterminate:w.length>0&&w.length<n.length,onChange:he,className:"text-xs",children:["Select All (",w.length,"/",n.length,")"]})]})}),e.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded",children:e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("strong",{children:"Smart Batch Operations:"}),' Select rows and use "Batch Apply" to set common values for multiple items at once.']})}),e.jsx(Le,{bordered:!0,dataSource:n,columns:ce,rowKey:i=>i.id,pagination:!1,size:"small",scroll:{x:"max-content",y:600},responsive:["sm","md","lg","xl","xxl"],rowSelection:Ne,rowClassName:(i,D)=>{const a=H(i,k[D])?"bg-blue-50":"",t=w.includes(i.id)?"bg-green-50":"";return`${a} ${t}`.trim()}}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"* Required fields: Type, Brand, Qty, Purchased Date, Condition, Status, Detachment/Office"})]})]})}const{Text:gs}=Fe;function Ds({visible:u,onClose:p,onConfirm:r,loading:o,status:h}){const[l,n]=s.useState([]),[f,k]=s.useState(""),[m,S]=s.useState([]),[q,B]=s.useState([]),[R,z]=s.useState(1),[N,w]=s.useState(10),[d,b]=s.useState(!1),{logUserActivity:j}=Se(),{logUserNotification:U}=Ce();s.useEffect(()=>{u&&(b(!0),Ee().then(y=>{n(y),b(!1)}),k(""),S([]),B([]),z(1))},[u]);const G=s.useMemo(()=>f?l.filter(y=>Object.values(y).some(E=>String(E).toLowerCase().includes(f.toLowerCase()))):l,[l,f]),H=s.useMemo(()=>{const y=(R-1)*N;return G.slice(y,y+N)},[G,R,N]);s.useEffect(()=>{B(l.filter(y=>m.includes(y.id)))},[m,l]);const M=[{title:"ID",dataIndex:"id",key:"id",width:80,className:"text-xs"},{title:"Type",dataIndex:"type",key:"type",className:"text-xs",width:120},{title:"Brand",dataIndex:"brand",key:"brand",className:"text-xs",width:120},{title:"Qty",dataIndex:"quantity",key:"quantity",className:"text-xs",width:70},{title:"Serial Number",dataIndex:"serialNumber",key:"serialNumber",className:"text-xs",width:150},{title:"Remarks",dataIndex:"remarks",key:"remarks",className:"text-xs",width:150},{title:"Location",dataIndex:"location",key:"location",className:"text-xs",width:150},{title:"Status",dataIndex:"status",key:"status",width:100,className:"text-xs",render:y=>{let E;switch(y){case"On Stock":E="green";break;case"For Repair":E="volcano";break;case"Deployed":E="blue";break;default:E="gray"}return e.jsx(He,{color:E,children:y})}}],C=[{title:"ID",dataIndex:"id",key:"id",className:"text-xs",width:80},{title:"Type",dataIndex:"type",key:"type",className:"text-xs",width:120},{title:"Brand",dataIndex:"brand",key:"brand",className:"text-xs",width:120},{title:"Qty",dataIndex:"quantity",key:"quantity",className:"text-xs",width:70},{title:"Remarks",dataIndex:"remarks",key:"remarks",className:"text-xs",width:150},{title:"Serial Number",dataIndex:"serialNumber",key:"serialNumber",className:"text-xs",width:150},{title:"Location",dataIndex:"location",key:"location",className:"text-xs",width:150},{title:"Status",dataIndex:"status",key:"status",width:100,className:"text-xs",render:y=>{let E;switch(y){case"On Stock":E="green";break;case"For Repair":E="volcano";break;case"Deployed":E="blue";break;default:E="gray"}return e.jsx(He,{color:E,children:y})}},{title:"Remove",key:"remove",width:80,className:"text-xs",render:(y,E)=>e.jsx(J,{size:"small",danger:!0,onClick:()=>Q(E.id),className:"text-xs",children:"Remove"})}],Q=y=>{S(E=>E.filter(ue=>ue!==y))},x=()=>{q.length>=2&&(r(q),j("Batch Item Pick",`Picked ${q.length} item(s) for batch edit.`),U("Batch Item Pick",`Picked ${q.length} item(s) for batch edit.`))};return e.jsx(ve,{open:u,title:"Advanced Batch Item Selection",onCancel:p,width:1200,footer:[e.jsx(J,{size:"small",className:"custom-button-cancel text-xs",onClick:p,disabled:o||d,children:"Cancel"},"cancel"),e.jsxs(J,{size:"small",className:"custom-button text-xs",type:"primary",onClick:x,disabled:q.length<2||o||d,loading:o,children:["Proceed to Batch Edit (",q.length,")"]},"confirm")],children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx(_.Search,{placeholder:"Search items...",value:f,onChange:y=>k(y.target.value),allowClear:!0,style:{width:300},size:"small"}),e.jsx(gs,{type:"secondary",className:"text-xs",children:"Select at least 2 items for batch edit."})]}),e.jsx(Le,{bordered:!0,dataSource:H,columns:M,rowKey:"id",size:"small",loading:d,pagination:{current:R,pageSize:N,total:G.length,showSizeChanger:!0,pageSizeOptions:["10","20","30","50","100"],onChange:(y,E)=>{z(y),w(E)},className:"text-xs"},rowSelection:{selectedRowKeys:m,onChange:S,preserveSelectedRowKeys:!0},scroll:{x:"max-content",y:400},className:"text-xs"})]}),e.jsxs("div",{className:"w-full md:w-1/3 bg-gray-50 border border-gray-200 rounded p-3 overflow-auto",style:{maxHeight:500},children:[e.jsxs("div",{className:"mb-2 font-semibold text-base",children:["Selected Items Preview (",q.length,")"]}),e.jsx(Le,{bordered:!0,dataSource:q,columns:C,rowKey:"id",size:"small",pagination:!1,scroll:{y:350},className:"text-xs",locale:{emptyText:"No items selected."}})]})]})})}const{Text:vs}=Fe;function ws({visible:u,onClose:p,onConfirm:r,loading:o}){const[h,l]=s.useState([]),[n,f]=s.useState(""),[k,m]=s.useState([]),[S,q]=s.useState([]),[B,R]=s.useState(1),[z,N]=s.useState(10),[w,d]=s.useState(!1),{logUserActivity:b}=Se(),{logUserNotification:j}=Ce();s.useEffect(()=>{u&&(d(!0),Ee().then(x=>{l(x),d(!1)}),f(""),m([]),q([]),R(1))},[u]);const U=s.useMemo(()=>n?h.filter(x=>Object.values(x).some(y=>String(y).toLowerCase().includes(n.toLowerCase()))):h,[h,n]),G=s.useMemo(()=>{const x=(B-1)*z;return U.slice(x,x+z)},[U,B,z]);s.useEffect(()=>{q(h.filter(x=>k.includes(x.id)))},[k,h]);const H=[{title:"ID",dataIndex:"id",key:"id",width:80,className:"text-xs"},{title:"Type",dataIndex:"type",key:"type",width:120,className:"text-xs"},{title:"Brand",dataIndex:"brand",key:"brand",width:120,className:"text-xs"},{title:"Qty",dataIndex:"quantity",key:"quantity",width:70,className:"text-xs"},{title:"Serial Number",dataIndex:"serialNumber",key:"serialNumber",width:150,className:"text-xs"},{title:"Remarks",dataIndex:"remarks",key:"remarks",width:150,className:"text-xs"},{title:"Location",dataIndex:"location",key:"location",width:150,className:"text-xs"},{title:"Status",dataIndex:"status",key:"status",width:100,className:"text-xs",render:x=>{let y;switch(x){case"On Stock":y="green";break;case"For Repair":y="volcano";break;case"Deployed":y="blue";break;default:y="gray"}return e.jsx(He,{color:y,children:x})}}],M=[{title:"ID",dataIndex:"id",key:"id",width:80,className:"text-xs"},{title:"Type",dataIndex:"type",key:"type",width:120,className:"text-xs"},{title:"Brand",dataIndex:"brand",key:"brand",width:120,className:"text-xs"},{title:"Qty",dataIndex:"quantity",key:"quantity",width:70,className:"text-xs"},{title:"Serial Number",dataIndex:"serialNumber",key:"serialNumber",width:150,className:"text-xs"},{title:"Remarks",dataIndex:"remarks",key:"remarks",width:150,className:"text-xs"},{title:"Location",dataIndex:"location",key:"location",width:150,className:"text-xs"},{title:"Status",dataIndex:"status",key:"status",width:100,className:"text-xs",render:x=>{let y;switch(x){case"On Stock":y="green";break;case"For Repair":y="volcano";break;case"Deployed":y="blue";break;default:y="gray"}return e.jsx(He,{color:y,children:x})}},{title:"Remove",key:"remove",width:80,className:"text-xs",render:(x,y)=>e.jsx(J,{size:"small",danger:!0,onClick:()=>C(y.id),className:"text-xs",children:"Remove"})}],C=x=>{m(y=>y.filter(E=>E!==x))},Q=()=>{S.length>=1&&(r(S),b("Batch Delete",`Deleted ${S.length} item(s) from inventory.`),j("Batch Delete",`Deleted ${S.length} item(s) from inventory.`))};return e.jsx(ve,{open:u,title:"Batch Delete Items",onCancel:p,width:1200,footer:[e.jsx(J,{size:"small",className:"custom-button-cancel text-xs",onClick:p,disabled:o||w,children:"Cancel"},"cancel"),e.jsxs(J,{size:"small",className:"custom-button text-xs",type:"primary",onClick:Q,disabled:S.length<1||o||w,loading:o,danger:!0,children:["Delete Selected (",S.length,")"]},"confirm")],children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx(_.Search,{placeholder:"Search items...",value:n,onChange:x=>f(x.target.value),allowClear:!0,style:{width:300},size:"small"}),e.jsx(vs,{type:"secondary",className:"text-xs",children:"Select at least 1 item to delete."})]}),e.jsx(Le,{bordered:!0,dataSource:G,columns:H,rowKey:"id",size:"small",loading:w,pagination:{current:B,pageSize:z,total:U.length,showSizeChanger:!0,pageSizeOptions:["10","20","30","50","100"],onChange:(x,y)=>{R(x),N(y)},className:"text-xs"},rowSelection:{selectedRowKeys:k,onChange:m,preserveSelectedRowKeys:!0},scroll:{x:"max-content",y:400},className:"text-xs"})]}),e.jsxs("div",{className:"w-full md:w-1/3 bg-gray-50 border border-gray-200 rounded p-3 overflow-auto",style:{maxHeight:500},children:[e.jsxs("div",{className:"mb-2 font-semibold text-base",children:["Selected Items Preview (",S.length,")"]}),e.jsx(Le,{bordered:!0,dataSource:S,columns:M,rowKey:"id",size:"small",pagination:!1,scroll:{y:350},className:"text-xs",locale:{emptyText:"No items selected."}})]})]})})}const Ns=u=>{let p;switch(u){case"On Stock":p="green";break;case"For Repair":p="volcano";break;case"Deployed":p="blue";break;default:p="gray"}return e.jsx(He,{color:p,className:"text-wrap text-center",children:e.jsx(Te,{text:u})})},Ss=u=>{let p;switch(u){case"Brand New":p="gold";break;case"Good Condition":p="green";break;case"Defective":p="red";break;default:p="gray"}return e.jsx(He,{color:p,className:"text-wrap text-center",children:e.jsx(Te,{text:u})})},Cs=(u,p,r,o,h)=>{const l=[{title:"ID",dataIndex:"id",key:"id",align:"center",width:"120px",fixed:"left",className:"text-xs",sorter:(n,f)=>n.id.localeCompare(f.id),render:n=>e.jsx(Te,{text:n})},{title:"Type",dataIndex:"type",key:"type",align:"center",width:"100px",className:"text-xs overflow-auto",responsive:["sm"],render:n=>e.jsx(Te,{text:n}),filters:[{text:"AVR",value:"AVR"},{text:"Battery",value:"Battery"},{text:"Biometrics",value:"Biometrics"},{text:"Camera",value:"Camera"},{text:"CCTV",value:"CCTV"},{text:"Charger",value:"Charger"},{text:"Guard Tour Chips",value:"Guard Tour Chips"},{text:"Guard Tour System",value:"Guard Tour System"},{text:"Headset",value:"Headset"},{text:"Keyboard",value:"Keyboard"},{text:"Laptop",value:"Laptop"},{text:"Megaphone",value:"Megaphone"},{text:"WIFI-Mesh",value:"WIFI-Mesh"},{text:"Metal Detector",value:"Metal Detector"},{text:"Microphone",value:"Microphone"},{text:"Modem",value:"Modem"},{text:"Monitor",value:"Monitor"},{text:"Mouse",value:"Mouse"},{text:"Others",value:"Others"},{text:"Pedestal",value:"Pedestal"},{text:"Podium",value:"Podium"},{text:"Printer",value:"Printer"},{text:"Radio",value:"Radio"},{text:"Router",value:"Router"},{text:"Search Stick",value:"Search Stick"},{text:"Searchlight",value:"Searchlight"},{text:"Smartphone",value:"Smartphone"},{text:"Speaker",value:"Speaker"},{text:"Switch",value:"Switch"},{text:"System Unit",value:"System Unit"},{text:"Under Chassis",value:"Under Chassis"},{text:"UPS",value:"UPS"}],onFilter:(n,f)=>f.type.includes(n)},{title:"Brand",dataIndex:"brand",key:"brand",align:"center",width:"100px",className:"text-xs overflow-auto",responsive:["sm"],sorter:(n,f)=>n.brand.localeCompare(f.brand),render:n=>e.jsx(Te,{text:n})},{title:"Qty",dataIndex:"quantity",key:"quantity",align:"center",width:"80px",className:"text-xs overflow-auto text-wrap",responsive:["sm"],sorter:(n,f)=>n.quantity-f.quantity,render:n=>e.jsx(Te,{text:n})},{title:"Remarks",dataIndex:"remarks",key:"remarks",align:"center",width:"200px",className:"text-xs overflow-auto text-wrap",responsive:["sm"],render:n=>e.jsx(Te,{text:n&&n.trim()!==""?n:"-"})},{title:"Serial Number",dataIndex:"serialNumber",key:"serialNumber",align:"center",width:"150px",className:"text-xs overflow-auto text-wrap",responsive:["sm"],sorter:(n,f)=>{var k;return(k=n.serialNumber)==null?void 0:k.localeCompare(f.serialNumber||"")},render:n=>e.jsx(Te,{text:n&&n.trim()!==""?n:"-"})},...h==="default"?[{title:"Issued Date",dataIndex:"issuedDate",key:"issuedDate",align:"center",width:"120px",className:"text-xs overflow-auto",responsive:["sm"],sorter:(n,f)=>{const k=new Date(n.issuedDate),m=new Date(f.issuedDate);return r==="Newest"?m-k:k-m},render:n=>e.jsx(Te,{text:!n||n==="0000-00-00"?"NO DATE":n})},{title:"Purchased Date",dataIndex:"purchaseDate",key:"purchaseDate",align:"center",width:"120px",className:"text-xs overflow-auto",responsive:["sm"],sorter:(n,f)=>{const k=new Date(n.purchaseDate),m=new Date(f.purchaseDate);return r==="Newest"?m-k:k-m},render:n=>e.jsx(Te,{text:n})}]:h==="issuedDate"?[{title:"Issued Date",dataIndex:"issuedDate",key:"issuedDate",align:"center",width:"120px",className:"text-xs overflow-auto",responsive:["sm"],sorter:(n,f)=>{const k=new Date(n.issuedDate),m=new Date(f.issuedDate);return r==="Newest"?m-k:k-m},render:n=>e.jsx(Te,{text:!n||n==="0000-00-00"?"NO DATE":n})}]:[{title:"Purchased Date",dataIndex:"purchaseDate",key:"purchaseDate",align:"center",width:"120px",className:"text-xs overflow-auto",responsive:["sm"],sorter:(n,f)=>{const k=new Date(n.purchaseDate),m=new Date(f.purchaseDate);return r==="Newest"?m-k:k-m},render:n=>e.jsx(Te,{text:n})}],{title:"Condition",dataIndex:"condition",key:"condition",align:"center",width:"120px",className:"text-xs overflow-auto",responsive:["sm"],render:n=>Ss(n),filters:[{text:"Brand New",value:"Brand New"},{text:"Good Condition",value:"Good Condition"},{text:"Defective",value:"Defective"}],onFilter:(n,f)=>f.condition.includes(n)},{title:"Detachment/Office",dataIndex:"location",key:"location",align:"center",width:"150px",className:"text-xs overflow-auto",responsive:["sm"],render:n=>e.jsx(Te,{text:n})},{title:"Status",dataIndex:"status",key:"status",align:"center",width:"110px",className:"text-xs overflow-auto",responsive:["sm"],render:n=>Ns(n),filters:[{text:"On Stock",value:"On Stock"},{text:"For Repair",value:"For Repair"},{text:"Deployed",value:"Deployed"}],onFilter:(n,f)=>f.status.includes(n)}];return o!=="guest"&&l.push({title:"Action",key:"action",align:"center",width:"80px",className:"text-xs overflow-auto",render:n=>e.jsxs(e.Fragment,{children:[e.jsx(Ye,{title:"Edit",children:e.jsx(J,{type:"text",icon:e.jsx(aa,{}),onClick:()=>u(n),size:"small"})}),n.quantity>1&&e.jsx(Ye,{title:"Redistribute",children:e.jsx(J,{type:"text",icon:e.jsx(ct,{}),onClick:()=>p(n),size:"small"})})]})}),l},Os=async u=>{var p;try{return(await St.post("/batch_edit_items.php",{items:u})).data}catch(r){throw((p=r.response)==null?void 0:p.data)||r}},ks=async u=>{var p;try{return(await St.post("/batch_add_items.php",{items:u})).data}catch(r){throw((p=r.response)==null?void 0:p.data)||r}},Ts=async u=>{var p;try{return(await St.post("/batch_delete_items.php",{itemIds:u})).data}catch(r){throw((p=r.response)==null?void 0:p.data)||r}},ze=typeof window<"u"&&window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1"&&window.location.hostname!==""&&!window.location.hostname.startsWith("192.168.")&&!0,{Option:_t}=A,Is=Sa.memo(({isMobile:u,searchColumn:p,isAdmin:r,userRole:o,setIsModalVisible:h,batchMenuItems:l,handleBatchMenuClick:n,commonButtonProps:f,selectedRowKeys:k,handleDeleteItems:m,sortOrder:S,handleSortOrderChange:q,handleFullRefresh:B,handlePrint:R,handleExportOpen:z,searchableColumnsForTab:N,getColumnMenu:w,tableKey:d,rowSelection:b,filteredData:j,tableColumns:U,handleTableChange:G,loading:H,isRefreshing:M,mobileExpandableConfig:C,searchInputProps:Q,onRefresh:x})=>{var y;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-4",children:e.jsxs("div",{className:u?"flex flex-row flex-wrap gap-1 mb-2":"flex items-center gap-2",children:[e.jsx(Et,{menu:w,trigger:["click"],className:u?"border-black text-xs block theme-aware-dropdown-btn":"border-black text-xs sm:block hidden theme-aware-dropdown-btn",children:e.jsxs(J,{type:"text",className:u?"flex items-center p-1 h-7 text-xs w-full":"flex items-center",size:"small",children:[e.jsx(Ma,{className:"text-xs"}),e.jsx(lt,{children:((y=N.find(E=>E.key===p))==null?void 0:y.label)||"All Columns"}),e.jsx(Ca,{className:"align-middle ml-1"})]})}),e.jsx(_,{...Q,prefix:e.jsx(Nt,{})}),e.jsx(Ye,{title:"Actions",children:(r||o==="user")&&e.jsx(J,{type:"text",icon:e.jsx(qa,{}),onClick:()=>h(!0),...f})}),e.jsx(Et,{menu:{items:l,onClick:n},trigger:["click"],children:(r||o==="user")&&e.jsx(Ye,{title:"Batch Actions",children:e.jsx(J,{type:"text",icon:e.jsx(Oa,{}),...f})})}),r&&e.jsx(Ye,{title:"Delete",children:e.jsx(J,{type:"link",icon:e.jsx(Kt,{}),danger:!0,disabled:k.length===0,onClick:m,...f})}),e.jsxs(A,{value:S,className:u?"w-auto text-xs transparent-select h-7":"w-auto text-xs transparent-select",onChange:q,size:"small",children:[e.jsx(_t,{value:"Newest",children:e.jsx("span",{className:"text-xs",children:"Newest"})}),e.jsx(_t,{value:"Oldest",children:e.jsx("span",{className:"text-xs",children:"Oldest"})})]}),e.jsx(J,{onClick:x,className:u?"w-auto custom-button text-xs":"custom-button w-auto text-xs",type:"default",size:"small",icon:e.jsx(Jt,{}),loading:M,children:e.jsx("span",{className:"text-xs",children:M?"Refreshing...":"Refresh"})}),e.jsx(J,{onClick:R,icon:e.jsx(Ra,{}),size:"small",className:"custom-button w-auto text-xs",disabled:!k||k.length===0,children:e.jsx("span",{className:"text-xs",children:"Print"})}),e.jsx(J,{onClick:z,icon:e.jsx(ka,{}),size:"small",className:"custom-button w-auto text-xs",children:e.jsx("span",{className:"text-xs",children:"Export"})})]})}),e.jsx("div",{className:"w-auto overflow-x-auto",children:e.jsx(Le,{rowSelection:b,rowKey:"id",dataSource:j,columns:U,pagination:!1,bordered:!0,onChange:G,scroll:{x:"max-content",y:600},loading:H,responsive:["sm","md","lg","xl","xxl"],expandable:C,className:"text-xs"},`table-${d}`)})]})}),Es=({inventoryData:u,setInventoryData:p,loading:r,lastSyncTime:o,onRefresh:h})=>{const{message:l}=We.useApp(),{isOffline:n}=Da(),[f,k]=s.useState(0),[m,S]=s.useState("all"),[q,B]=s.useState([]),[R,z]=s.useState(!1),[N]=s.useState("default"),w=ta({maxWidth:639}),[d,b]=s.useState(!1),[j,U]=s.useState(!1),[G,H]=s.useState(!1),[M,C]=s.useState(!1),[Q,x]=s.useState([]),[y,E]=s.useState(!1),[ue,P]=s.useState(!1),[ce,me]=s.useState(!1),[de,he]=s.useState(!1),[Ne,fe]=s.useState(!1),{logUserActivity:xe}=Se(),{logUserNotification:i}=Ce(),[D,a]=s.useState(u||[]),t=s.useRef(new Map),c=s.useRef(new Map);s.useEffect(()=>{a(u||[])},[u]);const g=p||a,I=p?u:D,{searchText:K,setSearchText:Y,sortOrder:je,currentPage:Ie,pageSize:$e,isModalVisible:ut,setIsModalVisible:st,isEditModalVisible:ht,setIsEditModalVisible:mt,redistributeItemData:xt,setRedistributeItemData:pt,isRedistributeModalVisible:ft,setIsRedistributeModalVisible:yt,editingItem:bt,isRefreshing:jt,activeTab:Ge,isAdmin:O,userRole:Z,totalEntries:X,handleRedistribute:ne,handleRedistributeItem:re,handlePageChange:W,handleSortOrderChange:ae,handleTableChange:le,handleAddItem:Ae,handleEdit:nt,handleEditItem:Ct,handleTabChange:na,rowSelection:Ot,selectedRowKeys:Me,setSelectedRowKeys:Ve,handleRefresh:kt}=Wa(I,r,p,a),ia=s.useCallback(async()=>{var T,ee,ie;if(!O){l.error("You do not have permission to delete items.");return}if(Me.length===0){l.warning("Please select items to delete.");return}try{if(ze&&await Pe()){l.warning("Cannot delete items while offline");return}const{deleteItems:se}=await va(async()=>{const{deleteItems:be}=await import("./index-Cq9w5H2m.js").then(Oe=>Oe.bF);return{deleteItems:be}},__vite__mapDeps([0,1])),pe=await se(Me);pe.message==="Items deleted successfully"?(g(be=>be.filter(Oe=>!Me.includes(Oe.id))),Ve([]),l.success("Items deleted successfully!"),xe("Inventory",`Deleted item(s) with ID(s): ${Me.join(", ")}`),i("Inventory Update",`You deleted item(s) with ID(s): ${Me.join(", ")}`)):l.error(pe.message||"Error deleting items.")}catch(se){ze&&(se.isOffline||(T=se.message)!=null&&T.includes("Offline"))?l.warning("Cannot delete items while offline"):((ie=(ee=se==null?void 0:se.response)==null?void 0:ee.data)!=null&&ie.message?l.error(`Failed to delete items: ${se.response.data.message}`):se!=null&&se.message?l.error(`Failed to delete items: ${se.message}`):l.error("Failed to delete items. Please try again."),console.error("Error deleting items:",se))}},[O,Me,l,g,Ve,xe,i]),ye=s.useMemo(()=>I||[],[I]);s.useEffect(()=>{if(!ye||ye.length===0){c.current.clear();return}setTimeout(()=>{const ee=new Map;ye.slice(0,2e3).forEach((se,pe)=>{if(!se)return;Object.values(se).filter(De=>De!=null&&De!==void 0).map(De=>String(De).toLowerCase()).join(" ").split(/\s+/).filter(De=>De.length>0).slice(0,10).forEach(De=>{ee.has(De)||ee.set(De,new Set),ee.get(De).add(pe)})}),c.current=ee},0)},[ye]);const Tt=s.useMemo(()=>{if(!ye||ye.length===0)return[];let T=ye;return K&&!R&&(T=ye.slice(0,1e3).filter(se=>Object.values(se).join(" ").toLowerCase().includes(K.toLowerCase()))),[...T].sort((ie,se)=>{const pe="id",be=je==="Newest"?"descend":"ascend";return be==="ascend"?ie[pe]>se[pe]?1:-1:be==="descend"?ie[pe]<se[pe]?1:-1:0}).slice((Ie-1)*$e,Ie*$e)},[ye,K,je,Ie,$e,R]);s.useEffect(()=>{j||Ve([])},[j,Ve]),s.useEffect(()=>{t.current.clear(),c.current.clear()},[ye]);const ra=s.useCallback(()=>{const T=ye.filter(ee=>Me.includes(ee.id));T.length>0?(Yt(T),xe("Printed inventory items",`Printed ${T.length} item(s)`),i("Print Action",`Printed ${T.length} inventory item(s)`),Ve([])):l.info("Please select items to print.")},[Me,ye,xe,i,Ve,l]),It=s.useMemo(()=>R?q:Tt,[R,q,Tt]),Mt=s.useMemo(()=>wa(T=>{if(T===""){z(!1);return}z(!0);const ee=`${T}-${m}`;if(t.current.has(ee)){B(t.current.get(ee));return}const ie=T.toLowerCase().trim();let se;if(m==="all"&&c.current.size>0){const be=c.current.get(ie);be?se=Array.from(be).map(Oe=>ye[Oe]):se=ye.filter(Oe=>Oe?Object.values(Oe).filter(it=>it!=null&&it!==void 0).map(it=>String(it).toLowerCase()).join(" ").includes(ie):!1)}else se=ye.filter(be=>{if(!be)return!1;if(m==="all")return Object.values(be).filter(De=>De!=null&&De!==void 0).map(De=>String(De).toLowerCase()).join(" ").includes(ie);{const Oe=be[m];return Oe&&String(Oe).toLowerCase().includes(ie)}});const pe=se.slice(0,1e3);if(t.current.set(ee,pe),t.current.size>50){const be=t.current.keys().next().value;t.current.delete(be)}B(pe)},250),[ye,m]),gt=s.useCallback(T=>{const ee=T.target.value;if(Y(ee),ee===""){z(!1),B([]),t.current.clear();return}Mt(ee)},[Mt,Y]),tt=s.useMemo(()=>{const T=[{key:"all",label:"All Columns"},{key:"id",label:"ID"},{key:"type",label:"Type"},{key:"brand",label:"Brand"},{key:"serialNumber",label:"Serial Number"},{key:"remarks",label:"Remarks"},{key:"quantity",label:"Quantity"},{key:"location",label:"Location"},{key:"status",label:"Status"},{key:"condition",label:"Condition"},{key:"issuedDate",label:"Issued Date"},{key:"purchaseDate",label:"Purchased Date"}],ee=w?N:Ge;return T.filter(ie=>ee==="issuedDate"?ie.key!=="purchaseDate":ee==="purchaseDate"?ie.key!=="issuedDate":!0)},[Ge,N,w]),la=s.useMemo(()=>({items:tt.map(T=>({key:T.key,label:e.jsx("span",{className:"break-words whitespace-normal text-xs",children:T.label})})),onClick:({key:T})=>S(T),selectedKeys:[m]}),[tt,m]),_e=s.useCallback(()=>{S("all"),z(!1),B([]),t.current.clear(),k(T=>T+1),ae("Newest"),kt(!0)},[ae,kt]),oa=s.useCallback(async T=>{var ee;H(!0);try{if(ze&&await Pe()){l.warning("Cannot perform batch edit while offline");return}await Os(T),U(!1),x([]),_e()}catch(ie){ze&&(ie.isOffline||(ee=ie.message)!=null&&ee.includes("Offline"))?l.warning("Cannot perform batch edit while offline"):l.error("Batch edit failed")}finally{H(!1)}},[_e,l]),ca=s.useCallback(async T=>{var ee;try{if(ze&&await Pe()){l.warning("Cannot perform batch add while offline");return}const ie=await ks(T);ie&&ie.results&&ie.results.filter(pe=>pe.success).length>0?l.success("Batch add completed successfully!"):l.error("Batch add failed."),b(!1),_e()}catch(ie){ze&&(ie.isOffline||(ee=ie.message)!=null&&ee.includes("Offline"))?l.warning("Cannot perform batch add while offline"):l.error("Batch add failed.")}},[_e,l]),Rt=s.useCallback(async T=>{var ee;P(!0);try{if(ze&&await Pe()){l.warning("Cannot perform batch delete while offline");return}const ie=T.map(pe=>pe.id),se=await Ts(ie);if(se&&se.results){const pe=se.results.filter(be=>be.success).length;pe>0?l.success(`${pe} item(s) deleted successfully!`):l.error("Batch delete failed.")}else l.error("Batch delete failed.");E(!1),_e()}catch(ie){ze&&(ie.isOffline||(ee=ie.message)!=null&&ee.includes("Offline"))?l.warning("Cannot perform batch delete while offline"):l.error("Batch delete failed.")}finally{P(!1)}},[_e,l]),da=s.useCallback(async T=>{he(!0);try{Yt(T),xe("Batch Print",`Batch printed ${T.length} inventory item(s)`),i("Batch Print",`Batch printed ${T.length} inventory item(s)`),me(!1),Ve([])}catch{l.error("Batch print failed.")}finally{he(!1)}},[xe,i,Ve,l]),ua=s.useCallback(({key:T})=>{T==="batchAdd"?b(!0):T==="batchEdit"?C(!0):T==="batchDelete"?E(!0):T==="batchPrint"&&me(!0)},[]),ha=s.useMemo(()=>[{key:"batchAdd",label:"Batch Add"},{key:"batchEdit",label:e.jsx("span",{style:{color:"blue"},children:"Batch Edit"})},...O?[{key:"batchDelete",label:e.jsx("span",{style:{color:"red"},children:"Batch Delete"}),danger:!0}]:[],{key:"batchPrint",label:e.jsx("span",{style:{color:"green"},children:"Batch Print"})}],[O]),ma=s.useCallback(()=>{fe(!0),xe("Export","Opened export modal for Inventory"),i("Export Action","Opened export modal for Inventory")},[xe,i]),xa=s.useMemo(()=>({size:"small",className:w?"text-xs p-1 h-7":"text-xs"}),[w]),Bt=s.useMemo(()=>w?{expandedRowRender:T=>e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:[e.jsx("b",{children:"ID:"})," ",T.id]}),e.jsxs("div",{children:[e.jsx("b",{children:"Type:"})," ",T.type]}),e.jsxs("div",{children:[e.jsx("b",{children:"Brand:"})," ",T.brand]}),e.jsxs("div",{children:[e.jsx("b",{children:"Quantity:"})," ",T.quantity]}),e.jsxs("div",{children:[e.jsx("b",{children:"Remarks:"})," ",T.remarks]}),e.jsxs("div",{children:[e.jsx("b",{children:"Serial Number:"})," ",T.serialNumber]}),e.jsxs("div",{children:[e.jsx("b",{children:"Issued Date:"})," ",T.issuedDate||"NO DATE"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Purchased Date:"})," ",T.purchaseDate||"NO DATE"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Condition:"})," ",T.condition]}),e.jsxs("div",{children:[e.jsx("b",{children:"Detachment/Office:"})," ",T.location]}),e.jsxs("div",{children:[e.jsx("b",{children:"Status:"})," ",T.status]})]}),rowExpandable:()=>!0}:void 0,[w]),Dt=s.useMemo(()=>Cs(nt,ne,je,Z,Ge),[nt,ne,je,Z,Ge]),Qe=s.useMemo(()=>({filteredData:It,tableColumns:Dt,loading:r,rowSelection:Ot,selectedRowKeys:Me,handleTableChange:le,mobileExpandableConfig:Bt}),[It,Dt,r,Ot,Me,le,Bt]),pa=s.useMemo(()=>{var T;return{placeholder:`Search in ${m==="all"?"all columns":(T=tt.find(ee=>ee.key===m))==null?void 0:T.label}`,value:K,onChange:gt,className:w?"w-auto border-black text-xs h-7":"ml-1 w-auto sm:w-auto border-black text-xs h-6",size:"small",allowClear:!0,maxLength:100,showCount:!1,autoComplete:"off",spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",onCompositionStart:()=>{},onCompositionEnd:()=>{}}},[m,tt,K,gt,w]);return e.jsxs(at,{variant:"borderless",title:e.jsx("span",{className:"font-bold flex justify-center text-lgi md:text-base lg:text-lgi xl:text-xl",children:"INVENTORY"}),children:[ze&&n&&e.jsx(Wt,{message:"You are currently offline",description:"Some features may be limited. Please check your internet connection.",type:"warning",showIcon:!0,icon:e.jsx(_a,{}),style:{marginBottom:"16px"}}),e.jsxs("div",{className:"overflow-auto",children:[e.jsx(Xt,{className:"custom-tabs",defaultActiveKey:"default",activeKey:Ge,onChange:na,type:"card",tabBarGutter:1,items:[{key:"default",label:e.jsx("span",{className:"text-xs",children:"Default"})},{key:"issuedDate",label:e.jsx("span",{className:"text-xs",children:"Issued Date"})},{key:"purchaseDate",label:e.jsx("span",{className:"text-xs",children:"Purchased Date"})}]}),e.jsx(Na.Provider,{value:K,children:e.jsx(Is,{isMobile:w,searchColumn:m,searchText:K,setSearchText:Y,handleSearch:gt,setFilterActive:z,isAdmin:O,userRole:Z,setIsModalVisible:st,batchMenuItems:ha,handleBatchMenuClick:ua,commonButtonProps:xa,selectedRowKeys:Qe.selectedRowKeys,handleBatchDelete:Rt,handleDeleteItems:ia,sortOrder:je,handleSortOrderChange:ae,handleFullRefresh:_e,handlePrint:ra,handleExportOpen:ma,searchableColumnsForTab:tt,getColumnMenu:la,tableKey:f,rowSelection:Qe.rowSelection,filteredData:Qe.filteredData,tableColumns:Qe.tableColumns,handleTableChange:Qe.handleTableChange,loading:Qe.loading,isRefreshing:jt,mobileExpandableConfig:Qe.mobileExpandableConfig,searchInputProps:pa,onRefresh:h})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mt-5 space-y-2 sm:space-y-0",children:[e.jsxs("div",{className:"w-full flex flex-col items-center sm:items-start",children:[e.jsxs(Fe.Text,{className:"w-full text-xs text-nowrap text-center sm:text-left overflow-auto",style:{color:"#072C1C"},children:["Showing data of ",X>0?(Ie-1)*$e+1:0," to ",Math.min(Ie*$e,X)," of ",X," entries"]}),o&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1 text-center sm:text-left",children:["Last synced: ",new Date(o).toLocaleTimeString()]})]}),e.jsx("div",{className:"w-full flex justify-center sm:justify-end",children:e.jsx(Zt,{current:Ie,pageSize:$e,total:X,showSizeChanger:!0,pageSizeOptions:["10","20","30","50","100","200","500","1000","2000"],onChange:W,className:"text-xs",responsive:!0})})]}),e.jsx(us,{visible:ut,onClose:()=>st(!1),onAdd:Ae,onRedistribute:re,handleEditItem:Ct,loading:r}),e.jsx(ms,{visible:ht,onClose:()=>mt(!1),onEdit:Ct,item:bt,loading:r}),e.jsx(ps,{visible:ft,onClose:()=>{yt(!1),pt(null)},onEdit:re,item:xt,loading:r}),e.jsx(ys,{visible:d,onClose:()=>b(!1),onBatchAdd:ca,loading:r}),e.jsx(Ds,{visible:M,onClose:()=>C(!1),onConfirm:T=>{x(T),C(!1),U(!0)},loading:G}),e.jsx(js,{visible:j,onClose:()=>{U(!1),x([])},onBatchEdit:oa,loading:G,selectedItems:Q}),O&&e.jsx(ws,{visible:y,onClose:()=>E(!1),onConfirm:Rt,loading:ue}),e.jsx(Ta,{visible:ce,onClose:()=>me(!1),onConfirm:da,loading:de}),e.jsx(Ia,{visible:Ne,onClose:()=>fe(!1),data:ye,filteredData:R?q:null,selectedData:Me.length>0?ye.filter(T=>Me.includes(T.id)):null,dataType:"inventory",title:"Export Inventory Data",columns:Dt.map(T=>({key:T.dataIndex||T.key,label:T.title}))})]})};export{Es as default};
