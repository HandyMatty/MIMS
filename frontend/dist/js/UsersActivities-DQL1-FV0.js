import{A as M,r as a,j as t,B as N,a4 as U}from"./index-CoTjVTXu.js";import{H as u}from"./HighlightText-2pS5ok3g.js";import{l as $}from"./lodash-c2diFTiz.js";import{u as V,F as B}from"./index-cS6mKtwe.js";import{C as K}from"./index-Ch4o3jr1.js";import{D as O,S as Q}from"./index-Bd7YzGv1.js";import{R as W}from"./FilterOutlined-Cy75TwN2.js";import{R as _}from"./index-FFLaIl49.js";import{I as q}from"./index-GjVEIOir.js";import{R as G}from"./SearchOutlined-oi5dMXdq.js";import{T as J}from"./index-r6vKt3ij.js";import{P as X}from"./Pagination-BTBkJFo1.js";import"./addEventListener-C2_QGBxY.js";import"./index-DS9BMYTm.js";import"./useBreakpoint-BTN1QGJk.js";import"./useForceUpdate-qFMU9LT5.js";import"./responsiveObserver-B_NheYvK.js";import"./PlusOutlined-DXG9lXkJ.js";import"./Dropdown-IxbQZqzH.js";import"./move-CeDiqiSl.js";import"./TextArea-C-Yc_kQs.js";import"./CheckOutlined-7lQp5xtI.js";import"./EyeOutlined-CY0v74EL.js";const A=async()=>{try{return(await M.get("/fetch_activities.php")).data}catch(i){throw console.error("Fetch Activities API Error:",i),i}},{Text:Y}=J,Se=()=>{var D,k;const[i,w]=a.useState([]),[I,h]=a.useState(!0),[Z,f]=a.useState(null),[o,g]=a.useState(""),[n,v]=a.useState(1),[c,j]=a.useState(5),[r,b]=a.useState("all"),[L,C]=a.useState([]),[T,p]=a.useState(!1),E=V({maxWidth:639});a.useEffect(()=>{(async()=>{try{const s=await A();w(s)}catch(s){console.error("Error fetching activities:",s),f("Failed to load activities.")}finally{h(!1)}})()},[]);const y=[{key:"all",label:"All Columns"},{key:"id",label:"ID"},{key:"username",label:"Username"},{key:"activity",label:"Activity"},{key:"details",label:"Details"},{key:"date",label:"Date"}],S=a.useCallback($.debounce(e=>{if(e===""){p(!1);return}p(!0);const s=i.filter(d=>{if(!d)return!1;if(r==="all"){for(const l in d){let x=d[l];if(l==="date"&&x&&new Date(x).toLocaleString("en-PH",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}).toLowerCase().includes(e.toLowerCase())||x&&String(x).toLowerCase().includes(e.toLowerCase()))return!0}return!1}else{if(r==="date")return new Date(d.date).toLocaleString("en-PH",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}).toLowerCase().includes(e.toLowerCase());{const l=d[r];return l&&String(l).toLowerCase().includes(e.toLowerCase())}}});C(s)},300),[i,r]),R=a.useCallback(e=>{const s=e.target.value;g(s),S(s)},[S]),P=e=>{b(e)},F=async()=>{h(!0),g(""),v(1),j(5),b("all"),p(!1),C([]),f(null);try{const e=await A();w(e)}catch(e){console.error("Error fetching activities:",e),f("Failed to load activities.")}finally{h(!1)}},m=T?L:i,H=m.slice((n-1)*c,n*c),z=[{title:"ID",dataIndex:"id",key:"id",width:"120px",className:"text-xs overflow-auto",sorter:(e,s)=>String(e.id).localeCompare(String(s.id)),render:e=>t.jsx(u,{text:e||"N/A",searchTerm:o})},{title:"Username",dataIndex:"username",key:"username",width:"150px",className:"text-xs overflow-auto",sorter:(e,s)=>e.username.localeCompare(s.username),render:e=>t.jsx(u,{text:e,searchTerm:o})},{title:"Activity",dataIndex:"activity",key:"activity",width:"150px",className:"text-xs overflow-auto",responsive:["sm"],render:e=>t.jsx(u,{text:e,searchTerm:o})},{title:"Details",dataIndex:"details",key:"details",width:"200px",className:"text-xs whitespace-normal break-words",responsive:["sm"],render:e=>t.jsx(u,{text:e,searchTerm:o})},{title:"Date",dataIndex:"date",key:"date",width:"200px",className:"text-xs overflow-auto",responsive:["sm"],sorter:(e,s)=>new Date(e.date)-new Date(s.date),render:e=>{const s=new Date(e).toLocaleString("en-PH",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0});return t.jsx(u,{text:s,searchTerm:o})}}];return t.jsxs(K,{title:t.jsx("span",{className:"text-lgi sm:text-sm md:text-md lg:text-lgi xl:text-xl font-bold flex justify-center",children:"ACTIVITIES"}),className:"flex flex-col w-full mx-auto bg-[#A8E1C5] rounded-xl shadow border-none",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 mb-4 space-y-2 sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-2 sm:mb-0",children:[t.jsx(O,{className:"w-auto hidden sm:block border-black theme-aware-dropdown-btn text-xs",menu:{items:y.map(e=>({key:e.key,label:e.label})),onClick:({key:e})=>P(e),selectedKeys:[r]},trigger:["click"],children:t.jsxs(N,{type:"text",className:"flex items-center",children:[t.jsx(W,{className:"text-xs"}),t.jsx(Q,{children:((D=y.find(e=>e.key===r))==null?void 0:D.label)||"All Columns"}),t.jsx(_,{className:"align-middle ml-1"})]})}),t.jsx(q,{placeholder:`Search in ${r==="all"?"all columns":(k=y.find(e=>e.key===r))==null?void 0:k.label}`,prefix:t.jsx(G,{}),value:o,onChange:R,className:"w-auto text-xs border-black ml-2"})]}),t.jsx("div",{className:"flex gap-2 w-auto justify-center",children:t.jsx(N,{onClick:F,className:"custom-button w-auto text-xs",type:"default",size:"small",icon:t.jsx(U,{}),children:"Refresh"})})]}),t.jsx("div",{className:"w-auto overflow-x-auto",children:t.jsx(B,{columns:z,dataSource:H,pagination:!1,bordered:!0,rowKey:"id",loading:I,scroll:{x:"max-content",y:280},className:"w-auto text-xs overflow-auto",responsive:["xs","sm","md","lg","xl"],expandable:E?{expandedRowRender:e=>t.jsxs("div",{className:"text-xs space-y-1 text-wrap",children:[t.jsxs("div",{children:[t.jsx("b",{children:"ID:"})," ",e.id]}),t.jsxs("div",{children:[t.jsx("b",{children:"Username:"})," ",e.username]}),t.jsxs("div",{children:[t.jsx("b",{children:"Activity:"})," ",e.activity]}),t.jsxs("div",{children:[t.jsx("b",{children:"Details:"})," ",e.details]}),t.jsxs("div",{children:[t.jsx("b",{children:"Date:"})," ",new Date(e.date).toLocaleString("en-PH",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0})]})]}),rowExpandable:()=>!0}:void 0})}),t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mt-5 space-y-2 sm:space-y-0",children:[t.jsxs(Y,{style:{color:"#072C1C"},className:"w-full text-xs text-wrap text-center sm:text-left",children:["Showing ",Math.min((n-1)*c+1,m.length)," to"," ",Math.min(n*c,m.length)," of ",m.length," entries"]}),t.jsx("div",{className:"w-full flex justify-center sm:justify-end",children:t.jsx(X,{current:n,pageSize:c,total:m.length,showSizeChanger:!0,className:"text-xs",responsive:!0,pageSizeOptions:["5","10","15"],onChange:(e,s)=>{v(e),j(s)}})})]})]})};export{Se as default};
