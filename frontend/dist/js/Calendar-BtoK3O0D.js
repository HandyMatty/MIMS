import{r as h,u as W,j as n,M as J,B as Q,T as U}from"./index-D5m7brAQ.js";import{r as X,d as i,a as ee}from"./index-6vJYtfpc.js";import{C as te,A as B,f as ne}from"./eventService-f8P19ra1.js";import{S as D}from"./index-DfjrVpKX.js";import{T as N}from"./index-BPHHOxml.js";import{R as re,C}from"./row-DMTX2L-Q.js";import{R as L}from"./index-DX2UjZVA.js";import{L as y}from"./index-Cqg0HATC.js";import"./TextArea-D-DXIv-d.js";import"./move-DlPCvRIF.js";import"./responsiveObserver-DoXGIqhg.js";import"./useBreakpoint-ChVOYjk2.js";import"./useForceUpdate-BMu-K6_i.js";import"./CheckOutlined-BfY46oHH.js";import"./SearchOutlined-l8LOIuY9.js";import"./Pagination-Dz9KGlxF.js";var g={exports:{}},ae=g.exports,z;function se(){return z||(z=1,function(E,_){(function(S,x){E.exports=x(X())})(ae,function(S){function x(l){return l&&typeof l=="object"&&"default"in l?l:{default:l}}var M=x(S),u={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(l,f){return f==="W"?l+"周":l+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(l,f){var c=100*l+f;return c<600?"凌晨":c<900?"早上":c<1100?"上午":c<1300?"中午":c<1800?"下午":"晚上"}};return M.default.locale(u,null,!0),u})}(g)),g.exports}se();i.extend(ee);const je=()=>{const[E,_]=h.useState(!1),[S,x]=h.useState(null),[M,u]=h.useState([]),[l,f]=h.useState({}),[c,H]=h.useState([]),[b,j]=h.useState(null),[k,v]=h.useState(null),[p,R]=h.useState("month"),{theme:s,currentTheme:T}=W();h.useEffect(()=>{(async()=>{try{const t=await ne();H(t)}catch(t){console.error("Error fetching events:",t)}})()},[]);const I=e=>{const t=c.filter(a=>a.event_date===e.format("YYYY-MM-DD"));u(t)},w=(e,t)=>{const a=c.filter(r=>{const o=i(r.event_date);return o.month()===e&&o.year()===t});u(a)},O=e=>{const t=c.filter(a=>i(a.event_date).year()===e);u(t)},$=e=>{const t=c.filter(r=>i(r.event_date).year()===e),a=t.reduce((r,o)=>{const Y=i(o.event_date).month();return r[Y]||(r[Y]=[]),r[Y].push(o),r},{});f(a),u(t)},q=e=>{I(e),x(e);const t=e.year(),a=e.month();v(t),j(a);const r=c.some(o=>o.event_date===e.format("YYYY-MM-DD"));_(r)},F=(e,t)=>{j(e),v(t),w(e,t);const a=c.some(r=>{const o=i(r.event_date);return o.month()===e&&o.year()===t});_(a)},G=e=>{v(e),j(null),$(e),_(!0)},A=()=>{_(!1),u([]),f({})},V=e=>{const t=e.format("YYYY-MM-DD"),a=c.filter(r=>r.event_date===t);if(a.length>0){const r=a.map(o=>o.content).join(", ");return n.jsx(U,{title:r,placement:"top",children:n.jsx("div",{className:"w-1.5 h-1.5 rounded-full mx-auto my-1",style:{backgroundColor:T!=="default"?s.primary||s.text:"#15803d"}})})}return null},Z=(e,t)=>{const a=e.month(),r=e.year();t==="month"&&p==="month"?(j(a),v(r),w(a,r)):t==="year"&&p==="year"&&(v(r),O(r))},K=()=>Object.keys(l).map(e=>n.jsxs("div",{children:[n.jsx(N.Title,{level:5,children:i().month(e).format("MMMM")}),n.jsx(y,{itemLayout:"horizontal",dataSource:l[e],renderItem:t=>n.jsx(y.Item,{children:n.jsx(y.Item.Meta,{avatar:n.jsx(B,{src:t.avatar}),title:t.username,description:n.jsx("span",{style:{color:t.event_type},children:t.content})})},t.id)})]},e));return n.jsxs("div",{className:"max-w-full h-auto rounded-xl bg-[#5fe7a7] shadow-md calendar-container calendar-card-head",style:{...T!=="default"&&{"--calendar-bg":s.componentBackground,"--calendar-text":s.text,"--calendar-border":s.border,"--calendar-radio-checked-bg":s.primary||s.text,"--calendar-cell-hover-bg":s.primary?`${s.primary}33`:`${s.text}33`,"--calendar-selected-bg":s.primary||s.text,"--calendar-selected-text":s.componentBackground,"--calendar-today-bg":s.primary?s.primary:s.text,"--calendar-today-text":s.componentBackground,background:s.componentBackground}},children:[n.jsx(te,{fullscreen:!1,className:"bg-transparent",onSelect:q,cellRender:V,headerRender:({value:e,onChange:t})=>{const a=e.year(),r=e.month(),o=e.localeData(),Y=Array.from({length:12},(m,d)=>n.jsx(D.Option,{value:d,children:o.monthsShort(i().month(d))},d)),P=Array.from({length:20},(m,d)=>n.jsx(D.Option,{value:a-10+d,children:a-10+d},a-10+d));return n.jsxs("div",{className:"p-1",children:[n.jsx(N.Title,{level:4,children:"Calendar"}),n.jsxs(re,{gutter:8,children:[n.jsx(C,{children:n.jsxs(L.Group,{size:"small",onChange:m=>R(m.target.value),value:p,children:[n.jsx(L.Button,{className:"text-black",value:"month",children:"Month"}),n.jsx(L.Button,{className:"text-black",value:"year",children:"Year"})]})}),n.jsx(C,{children:n.jsx(D,{size:"small",value:a,onChange:m=>{const d=e.clone().year(m);t(d),p==="year"&&G(m)},className:"w-20",children:P})}),p==="month"&&n.jsx(C,{children:n.jsx(D,{size:"small",value:r,onChange:m=>{const d=e.clone().month(m);t(d),F(m,a)},className:"w-auto ",children:Y})})]})]})},onPanelChange:Z}),n.jsx(J,{title:p==="year"?`Events in ${k||i().year()}`:`Events in ${b!==null?i().month(b).year(k).format("MMMM YYYY"):"Select Month"}`,open:E,onCancel:A,footer:[n.jsx(Q,{onClick:A,className:"custom-button-cancel",children:"Close"},"close")],children:p==="year"?K():M.length>0&&n.jsx(y,{itemLayout:"horizontal",dataSource:M,renderItem:e=>n.jsx(y.Item,{children:n.jsx(y.Item.Meta,{avatar:n.jsx(B,{src:e.avatar}),title:e.username,description:n.jsx("span",{style:{color:e.event_type},children:e.content})})},e.id)})})]})};export{je as default};
