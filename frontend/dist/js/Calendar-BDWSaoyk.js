import{r as d,j as s,M as K,B as P,T as W}from"./index-1bUjThPI.js";import{r as J,d as i,a as Q}from"./index-B3CrsbZy.js";import{C as U,A as T,f as X}from"./eventService-CaLfCiHq.js";import{S as j}from"./index-qPlGQ91r.js";import{T as k}from"./index-0WLxIj05.js";import{R as ee,C}from"./row-AIHCUI2m.js";import{R as g}from"./index-CIDkA5ML.js";import{L as p}from"./index-B0UM-bpe.js";import"./TextArea-DpRMIGjb.js";import"./responsiveObserver-D0DgaF8s.js";import"./useBreakpoint-GvLrBt9J.js";import"./useForceUpdate-CHj89O7T.js";import"./CheckOutlined-DLAhGfjk.js";import"./SearchOutlined-CVLzcg_r.js";import"./Pagination-DXStCYex.js";var D={exports:{}},te=D.exports,z;function se(){return z||(z=1,function(E,f){(function(S,_){E.exports=_(J())})(te,function(S){function _(a){return a&&typeof a=="object"&&"default"in a?a:{default:a}}var y=_(S),h={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(a,x){return x==="W"?a+"周":a+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(a,x){var l=100*a+x;return l<600?"凌晨":l<900?"早上":l<1100?"上午":l<1300?"中午":l<1800?"下午":"晚上"}};return y.default.locale(h,null,!0),h})}(D)),D.exports}se();i.extend(Q);const ve=()=>{const[E,f]=d.useState(!1),[S,_]=d.useState(null),[y,h]=d.useState([]),[a,x]=d.useState({}),[l,H]=d.useState([]),[L,M]=d.useState(null),[w,v]=d.useState(null),[u,R]=d.useState("month");d.useEffect(()=>{(async()=>{try{const t=await X();H(t)}catch(t){console.error("Error fetching events:",t)}})()},[]);const b=e=>{const t=l.filter(r=>r.event_date===e.format("YYYY-MM-DD"));h(t)},A=(e,t)=>{const r=l.filter(n=>{const o=i(n.event_date);return o.month()===e&&o.year()===t});h(r)},I=e=>{const t=l.filter(r=>i(r.event_date).year()===e);h(t)},O=e=>{const t=l.filter(n=>i(n.event_date).year()===e),r=t.reduce((n,o)=>{const Y=i(o.event_date).month();return n[Y]||(n[Y]=[]),n[Y].push(o),n},{});x(r),h(t)},B=e=>{b(e),_(e);const t=e.year(),r=e.month();v(t),M(r);const n=l.some(o=>o.event_date===e.format("YYYY-MM-DD"));f(n)},q=(e,t)=>{M(e),v(t),A(e,t);const r=l.some(n=>{const o=i(n.event_date);return o.month()===e&&o.year()===t});f(r)},F=e=>{v(e),M(null),O(e),f(!0)},N=()=>{f(!1),h([]),x({})},G=e=>{const t=e.format("YYYY-MM-DD"),r=l.filter(n=>n.event_date===t);if(r.length>0){const n=r.map(o=>o.content).join(", ");return s.jsx(W,{title:n,placement:"top",children:s.jsx("div",{className:"w-1.5 h-1.5 bg-green-700 rounded-full mx-auto my-1 xs:text-xs"})})}return null},$=(e,t)=>{const r=e.month(),n=e.year();t==="month"&&u==="month"?(M(r),v(n),A(r,n)):t==="year"&&u==="year"&&(v(n),I(n))},V=()=>Object.keys(a).map(e=>s.jsxs("div",{children:[s.jsx(k.Title,{level:5,className:"xs:text-xs",children:i().month(e).format("MMMM")}),s.jsx(p,{itemLayout:"horizontal",dataSource:a[e],renderItem:t=>s.jsx(p.Item,{children:s.jsx(p.Item.Meta,{className:"xs:text-xs",avatar:s.jsx(T,{src:t.avatar}),title:t.username,description:s.jsx("span",{style:{color:t.event_type},className:"xs:text-xs",children:t.content})})},t.id)})]},e));return s.jsxs("div",{className:"w-auto h-full rounded-xl bg-[#A8E1C5] shadow-md",children:[s.jsx(U,{fullscreen:!1,className:"bg-transparent xs:text-xs",onSelect:B,cellRender:G,headerRender:({value:e,onChange:t})=>{const r=e.year(),n=e.month(),o=e.localeData(),Y=Array.from({length:12},(m,c)=>s.jsx(j.Option,{value:c,children:o.monthsShort(i().month(c))},c)),Z=Array.from({length:20},(m,c)=>s.jsx(j.Option,{value:r-10+c,children:r-10+c},r-10+c));return s.jsxs("div",{className:"p-2",children:[s.jsx(k.Title,{level:4,className:"m-0",children:"Calendar"}),s.jsxs(ee,{gutter:8,children:[s.jsx(C,{children:s.jsxs(g.Group,{size:"small",onChange:m=>R(m.target.value),value:u,children:[s.jsx(g.Button,{className:"custom-radio text-black w-auto text-xs sm:text-sm",value:"month",children:"Month"}),s.jsx(g.Button,{className:"custom-radio text-black w-auto text-xs sm:text-sm",value:"year",children:"Year"})]})}),s.jsx(C,{children:s.jsx(j,{size:"small",value:r,onChange:m=>{const c=e.clone().year(m);t(c),u==="year"&&F(m)},className:"w-auto",children:Z})}),u==="month"&&s.jsx(C,{children:s.jsx(j,{size:"small",value:n,onChange:m=>{const c=e.clone().month(m);t(c),q(m,r)},className:"w-auto",children:Y})})]})]})},onPanelChange:$}),s.jsx(K,{title:u==="year"?`Events in ${w||i().year()}`:`Events in ${L!==null?i().month(L).year(w).format("MMMM YYYY"):"Select Month"}`,open:E,onCancel:N,centered:!0,footer:[s.jsx(P,{onClick:N,children:"Close"},"close")],children:u==="year"?V():y.length>0&&s.jsx(p,{itemLayout:"horizontal",dataSource:y,renderItem:e=>s.jsx(p.Item,{children:s.jsx(p.Item.Meta,{avatar:s.jsx(T,{src:e.avatar}),title:e.username,description:s.jsx("span",{style:{color:e.event_type},children:e.content})})},e.id)})})]})};export{ve as default};
