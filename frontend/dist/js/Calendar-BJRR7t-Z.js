import{b as C,c as B,j as e,T as N,B as S,s as y,M as A,r as v,p as w,d as I,e as R,u as P,L as T,S as k,a as z}from"./index-D5m7brAQ.js";import{A as L,d as $,a as O,f as G,C as _}from"./eventService-f8P19ra1.js";import{B as q}from"./index-PbHcsmXZ.js";import{R as K}from"./DeleteOutlined-CbjJdnfi.js";import{R as H}from"./PlusOutlined-CVr93bVs.js";import{F as b}from"./index-CFeAJxR5.js";import{I as J}from"./index-DLyYD9CR.js";import{S as Y}from"./index-DfjrVpKX.js";import{D as Q}from"./index-DisltTFr.js";import{T as V}from"./index-BPHHOxml.js";import{R as W,C as x}from"./row-DMTX2L-Q.js";import{T as u}from"./index-C-aXWOWo.js";import"./responsiveObserver-DoXGIqhg.js";import"./useBreakpoint-ChVOYjk2.js";import"./useForceUpdate-BMu-K6_i.js";import"./index-6vJYtfpc.js";import"./TextArea-D-DXIv-d.js";import"./move-DlPCvRIF.js";import"./index-DX2UjZVA.js";import"./EyeOutlined-DKNTmCKm.js";import"./SearchOutlined-l8LOIuY9.js";import"./CheckOutlined-BfY46oHH.js";const X=({currentDate:i,info:d,events:r,showModal:p,isAdmin:m,currentUser:o,setEvents:g,isGuest:j})=>{const{logUserActivity:n}=C(),{logUserNotification:f}=B();if(d.type==="date"){const t=i.format("YYYY-MM-DD"),E=r[t]||[],D=s=>{$(s.id).then(l=>{l.success?(g(c=>{const a={...c},F=a[t].filter(M=>M.id!==s.id);return a[t]=F,a}),y.success("Event deleted successfully!"),n((o==null?void 0:o.username)||"Unknown User","Event",`Deleted an event: "${s.content}"`),f("Event Deleted",`Deleted an event: "${s.content}"`)):y.error(l.message||"Failed to delete event")}).catch(l=>{console.error("Failed to delete event:",l),y.error("Error deleting event. Please try again.")})};return e.jsxs("ul",{className:"events",children:[E.map(s=>e.jsxs("li",{children:[e.jsx(N,{title:s.username,className:"size-3 sm:size-5",children:e.jsx(L,{src:s.avatar})}),e.jsx(q,{color:s.type,text:e.jsx("span",{style:{color:s.type},className:"text-xxs sm:text-xs",children:s.content})}),(m||s.username===(o==null?void 0:o.username))&&e.jsx(N,{title:"Delete Event",children:e.jsx(S,{className:"size-1",size:"small",type:"link",danger:!0,icon:e.jsx(K,{}),style:{padding:0},onClick:()=>D(s)})})]},s.id)),!j&&e.jsx(N,{title:"Add Event",children:e.jsx(S,{className:"size-1",size:"small",type:"link",icon:e.jsx(H,{}),onClick:()=>p(i),style:{padding:0}})})]})}return null},{Option:h}=Y,Z=({isOpen:i,onClose:d,selectedDate:r,loadEvents:p})=>{const[m]=b.useForm(),{logUserActivity:o}=C(),{logUserNotification:g}=B(),j=()=>{m.validateFields().then(n=>{const f={date:r.format("YYYY-MM-DD"),content:n.event,event_type:n.color};O(f).then(t=>{t.success?(y.success("Event added successfully!"),m.resetFields(),p(),d(),o(t.username,"Event",`Added an event: "${n.event}"`),g("New event scheduled!",`Your upcoming event "${n.event}" is scheduled for ${r.format("YYYY-MM-DD")}.`)):y.error(t.message||"Failed to add event.")}).catch(t=>{y.error("Failed to add event."),console.error("Failed to add event:",t)})})};return e.jsx(A,{title:`Add Event on ${r?r.format("YYYY-MM-DD"):""}`,open:i,onOk:j,onCancel:d,okButtonProps:{className:"custom-button"},cancelButtonProps:{className:"custom-button-cancel"},centered:!0,children:e.jsxs(b,{form:m,layout:"vertical",children:[e.jsx(b.Item,{name:"event",label:"Event Description",rules:[{required:!0,message:"Please input the event description!"}],children:e.jsx(J,{})}),e.jsx(b.Item,{name:"color",label:"Event Color",rules:[{required:!0,message:"Please select a color for the event!"}],children:e.jsxs(Y,{placeholder:"Select a category",allowClear:!0,children:[e.jsx(h,{value:"#4169E1",children:"Important (Royal Blue)"}),e.jsx(h,{value:"#FFD700",children:"Celebration (Gold)"}),e.jsx(h,{value:"#228B22",children:"Task (Forest Green)"}),e.jsx(h,{value:"#4682B4",children:"Meeting (Steel Blue)"}),e.jsx(h,{value:"#FFC0CB",children:"Personal (Soft Pink)"}),e.jsx(h,{value:"#B22222",children:"Deadline (Firebrick Red)"}),e.jsx(h,{value:"#FFFFE0",children:"Idea (Pale Yellow)"})]})})]})})},{Title:U}=V,Fe=()=>{v.useEffect(()=>{w([k])},[]);const[i,d]=v.useState({}),[r,p]=v.useState(!1),[m,o]=v.useState(null),{userData:g}=I(),{userData:j}=R(),n=!!j,f=g||j,{theme:t,currentTheme:E}=P();v.useEffect(()=>{D()},[]);const D=()=>{G().then(l=>{const c={};l.forEach(a=>{const F=a.event_date;c[F]||(c[F]=[]),c[F].push({id:a.id,type:a.event_type,content:a.content,avatar:a.avatar||"",username:a.username||""})}),d(c)}).catch(l=>{console.error("Failed to fetch events:",l)})},s=l=>{o(l),p(!0)};return e.jsx(v.Suspense,{fallback:e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-honeydew",children:[e.jsx(T,{className:"h-[183px] w-[171px] object-cover mb-4 logo-bounce",src:k,alt:"SINSSI Logo",width:171,height:183}),e.jsx(z,{size:"large"}),e.jsx("p",{className:"mt-4 text-darkslategray-200",children:"Loading..."})]}),children:e.jsxs("div",{className:"container max-w-full",children:[e.jsx("div",{className:"mt-5",children:e.jsx(Q,{style:E!=="default"?{borderColor:t.text}:{borderColor:"#072C1C"},children:e.jsx(U,{level:3,style:E!=="default"?{color:t.text}:{},children:"CALENDAR"})})}),e.jsxs(W,{gutter:[16,8],className:"mb-2 justify-center",children:[e.jsxs(x,{xs:12,sm:6,md:3,children:[e.jsx(u,{color:"#4169E1",children:"Important"}),e.jsx("span",{children:"Royal Blue"})]}),e.jsxs(x,{xs:12,sm:6,md:3,children:[e.jsx(u,{color:"#FFD700",style:{color:"black"},children:"Celebration"}),e.jsx("span",{children:"Gold"})]}),e.jsxs(x,{xs:12,sm:6,md:3,children:[e.jsx(u,{color:"#228B22",children:"Task"}),e.jsx("span",{children:"Forest Green"})]}),e.jsxs(x,{xs:12,sm:6,md:3,children:[e.jsx(u,{color:"#4682B4",children:"Meeting"}),e.jsx("span",{children:"Steel Blue"})]}),e.jsxs(x,{xs:12,sm:6,md:3,children:[e.jsx(u,{color:"#FFC0CB",style:{color:"black"},children:"Personal"}),e.jsx("span",{children:"Soft Pink"})]}),e.jsxs(x,{xs:12,sm:6,md:3,children:[e.jsx(u,{color:"#B22222",children:"Deadline"}),e.jsx("span",{children:"Firebrick Red"})]}),e.jsxs(x,{xs:12,sm:6,md:3,children:[e.jsx(u,{color:"#FFFFE0",style:{color:"black"},children:"Idea"}),e.jsx("span",{children:"Pale Yellow"})]})]}),e.jsxs("div",{className:"flex flex-col w-full h-auto mx-auto bg-[#a7f3d0] rounded-xl shadow p-2",style:E!=="default"?{background:t.componentBackground,color:t.text}:{},children:[e.jsx(_,{className:"text-xs w-full",cellRender:(l,c)=>e.jsx(X,{currentDate:l,info:c,events:i,showModal:s,isAdmin:n,currentUser:f,setEvents:d,isGuest:!n&&!f})}),e.jsx(Z,{isOpen:r,onClose:()=>p(!1),selectedDate:m,loadEvents:D,events:i})]})]})})};export{Fe as default};
