import{r as h,u as W,j as n,h as D,l as B,b as J,C,M as Q,B as U,T as X}from"./index-DN6_br7R.js";import{r as ee,d as i,a as te}from"./index-Ckd-DAtu.js";import{C as ne,A as N,f as ae}from"./eventService-OxzkTeeM.js";import{R as b}from"./index-Cze-HWbO.js";import{L as f}from"./index-BXiLnCHs.js";import"./Pagination-DPpzciQD.js";var g={exports:{}},se=g.exports,z;function re(){return z||(z=1,function(E,_){(function(S,x){E.exports=x(ee())})(se,function(S){function x(l){return l&&typeof l=="object"&&"default"in l?l:{default:l}}var M=x(S),u={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(l,y){return y==="W"?l+"周":l+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(l,y){var c=100*l+y;return c<600?"凌晨":c<900?"早上":c<1100?"上午":c<1300?"中午":c<1800?"下午":"晚上"}};return M.default.locale(u,null,!0),u})}(g)),g.exports}re();i.extend(te);const he=()=>{const[E,_]=h.useState(!1),[S,x]=h.useState(null),[M,u]=h.useState([]),[l,y]=h.useState({}),[c,H]=h.useState([]),[L,j]=h.useState(null),[k,v]=h.useState(null),[p,I]=h.useState("month"),{theme:r,currentTheme:T}=W();h.useEffect(()=>{(async()=>{try{const t=await ae();H(t)}catch(t){console.error("Error fetching events:",t)}})()},[]);const O=e=>{const t=c.filter(s=>s.event_date===e.format("YYYY-MM-DD"));u(t)},w=(e,t)=>{const s=c.filter(a=>{const o=i(a.event_date);return o.month()===e&&o.year()===t});u(s)},R=e=>{const t=c.filter(s=>i(s.event_date).year()===e);u(t)},$=e=>{const t=c.filter(a=>i(a.event_date).year()===e),s=t.reduce((a,o)=>{const Y=i(o.event_date).month();return a[Y]||(a[Y]=[]),a[Y].push(o),a},{});y(s),u(t)},q=e=>{O(e),x(e);const t=e.year(),s=e.month();v(t),j(s);const a=c.some(o=>o.event_date===e.format("YYYY-MM-DD"));_(a)},F=(e,t)=>{j(e),v(t),w(e,t);const s=c.some(a=>{const o=i(a.event_date);return o.month()===e&&o.year()===t});_(s)},G=e=>{v(e),j(null),$(e),_(!0)},A=()=>{_(!1),u([]),y({})},V=e=>{const t=e.format("YYYY-MM-DD"),s=c.filter(a=>a.event_date===t);if(s.length>0){const a=s.map(o=>o.content).join(", ");return n.jsx(X,{title:a,placement:"top",children:n.jsx("div",{className:"w-1.5 h-1.5 rounded-full mx-auto my-1",style:{backgroundColor:T!=="default"?r.primary||r.text:"#15803d"}})})}return null},Z=(e,t)=>{const s=e.month(),a=e.year();t==="month"&&p==="month"?(j(s),v(a),w(s,a)):t==="year"&&p==="year"&&(v(a),R(a))},K=()=>Object.keys(l).map(e=>n.jsxs("div",{children:[n.jsx(B.Title,{level:5,children:i().month(e).format("MMMM")}),n.jsx(f,{itemLayout:"horizontal",dataSource:l[e],renderItem:t=>n.jsx(f.Item,{children:n.jsx(f.Item.Meta,{avatar:n.jsx(N,{src:t.avatar}),title:t.username,description:n.jsx("span",{style:{color:t.event_type},children:t.content})})},t.id)})]},e));return n.jsxs("div",{className:"max-w-full h-auto rounded-xl bg-[#5fe7a7] shadow-md calendar-container calendar-card-head",style:{...T!=="default"&&{"--calendar-bg":r.componentBackground,"--calendar-text":r.text,"--calendar-border":r.border,"--calendar-radio-checked-bg":r.primary||r.text,"--calendar-cell-hover-bg":r.primary?`${r.primary}33`:`${r.text}33`,"--calendar-selected-bg":r.primary||r.text,"--calendar-selected-text":r.componentBackground,"--calendar-today-bg":r.primary?r.primary:r.text,"--calendar-today-text":r.componentBackground,background:r.componentBackground}},children:[n.jsx(ne,{fullscreen:!1,className:"bg-transparent",onSelect:q,cellRender:V,headerRender:({value:e,onChange:t})=>{const s=e.year(),a=e.month(),o=e.localeData(),Y=Array.from({length:12},(m,d)=>n.jsx(D.Option,{value:d,children:o.monthsShort(i().month(d))},d)),P=Array.from({length:20},(m,d)=>n.jsx(D.Option,{value:s-10+d,children:s-10+d},s-10+d));return n.jsxs("div",{className:"p-1",children:[n.jsx(B.Title,{level:4,children:"Calendar"}),n.jsxs(J,{gutter:8,children:[n.jsx(C,{children:n.jsxs(b.Group,{size:"small",onChange:m=>I(m.target.value),value:p,children:[n.jsx(b.Button,{className:"text-black",value:"month",children:"Month"}),n.jsx(b.Button,{className:"text-black",value:"year",children:"Year"})]})}),n.jsx(C,{children:n.jsx(D,{size:"small",value:s,onChange:m=>{const d=e.clone().year(m);t(d),p==="year"&&G(m)},className:"w-20",children:P})}),p==="month"&&n.jsx(C,{children:n.jsx(D,{size:"small",value:a,onChange:m=>{const d=e.clone().month(m);t(d),F(m,s)},className:"w-auto ",children:Y})})]})]})},onPanelChange:Z}),n.jsx(Q,{title:p==="year"?`Events in ${k||i().year()}`:`Events in ${L!==null?i().month(L).year(k).format("MMMM YYYY"):"Select Month"}`,open:E,onCancel:A,footer:[n.jsx(U,{onClick:A,className:"custom-button-cancel",children:"Close"},"close")],children:p==="year"?K():M.length>0&&n.jsx(f,{itemLayout:"horizontal",dataSource:M,renderItem:e=>n.jsx(f.Item,{children:n.jsx(f.Item.Meta,{avatar:n.jsx(N,{src:e.avatar}),title:e.username,description:n.jsx("span",{style:{color:e.event_type},children:e.content})})},e.id)})})]})};export{he as default};
